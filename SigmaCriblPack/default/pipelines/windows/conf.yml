output: default
groups: {}
asyncFuncTimeout: 1000
functions:
- id: comment
  filter: 'true'
  disabled: false
  conf:
    comment: This is a Pipeline Comment
- id: eval
  filter: (EventID=="8" && (SourceImage.endsWith("\System32\cscript.exe") || SourceImage.endsWith("\System32\wscript.exe")
    || SourceImage.endsWith("\System32\mshta.exe") || SourceImage.endsWith("\winword.exe")
    || SourceImage.endsWith("\excel.exe")) && TargetImage.includes("\SysWOW64\\")
    && StartModule ===null )
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2e4e488a-6164-4811-9ea1-f960c7359c40_sysmon_ot"'
  description: CACTUSTORCH Remote Thread Creation
- id: eval
  filter: (EventID=="8" && (StartAddress.endsWith("0B80") || StartAddress.endsWith("0C7C")
    || StartAddress.endsWith("0C88")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6309645e-122d-4c5b-bb2b-22e4f9c2fa42_sysmon_ot"'
  description: CobaltStrike Process Injection
- id: eval
  filter: (EventID=="8" && StartModule.endsWith("\kernel32.dll") && StartFunction=="LoadLibraryA")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"052ec6f6-1adc-41e6-907a-f1c813478bee_sysmon_ot"'
  description: CreateRemoteThread API and LoadLibrary
- id: eval
  filter: (EventID=="8" && TargetImage.endsWith("\lsass.exe") && StartModule=="")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f239b326-2f41-4d6b-9dfa-c846a60ef505_sysmon_ot"'
  description: Password Dumper Remote Thread in LSASS
- id: eval
  filter: (EventID=="8" && SourceImage.endsWith("\powershell.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"eeb2e3dc-c1f4-40dd-9bd5-149ee465ad50_sysmon_ot"'
  description: Accessing WinAPI in PowerShell. Code Injection.
- id: eval
  filter: (EventID=="8" && (SourceImage.endsWith("\bash.exe") || SourceImage.endsWith("\cvtres.exe")
    || SourceImage.endsWith("\defrag.exe") || SourceImage.endsWith("\dnx.exe") ||
    SourceImage.endsWith("\esentutl.exe") || SourceImage.endsWith("\excel.exe") ||
    SourceImage.endsWith("\expand.exe") || SourceImage.endsWith("\explorer.exe") ||
    SourceImage.endsWith("\find.exe") || SourceImage.endsWith("\findstr.exe") || SourceImage.endsWith("\forfiles.exe")
    || SourceImage.endsWith("\git.exe") || SourceImage.endsWith("\gpupdate.exe") ||
    SourceImage.endsWith("\hh.exe") || SourceImage.endsWith("\iexplore.exe") || SourceImage.endsWith("\installutil.exe")
    || SourceImage.endsWith("\lync.exe") || SourceImage.endsWith("\makecab.exe") ||
    SourceImage.endsWith("\mDNSResponder.exe") || SourceImage.endsWith("\monitoringhost.exe")
    || SourceImage.endsWith("\msbuild.exe") || SourceImage.endsWith("\mshta.exe")
    || SourceImage.endsWith("\msiexec.exe") || SourceImage.endsWith("\mspaint.exe")
    || SourceImage.endsWith("\outlook.exe") || SourceImage.endsWith("\ping.exe") ||
    SourceImage.endsWith("\powerpnt.exe") || SourceImage.endsWith("\powershell.exe")
    || SourceImage.endsWith("\provtool.exe") || SourceImage.endsWith("\python.exe")
    || SourceImage.endsWith("\regsvr32.exe") || SourceImage.endsWith("\robocopy.exe")
    || SourceImage.endsWith("\runonce.exe") || SourceImage.endsWith("\sapcimc.exe")
    || SourceImage.endsWith("\schtasks.exe") || SourceImage.endsWith("\smartscreen.exe")
    || SourceImage.endsWith("\spoolsv.exe") || SourceImage.endsWith("\tstheme.exe")
    || SourceImage.endsWith("\userinit.exe") || SourceImage.endsWith("\vssadmin.exe")
    || SourceImage.endsWith("\vssvc.exe") || SourceImage.endsWith("\w3wp.exe") ||
    SourceImage.endsWith("\winlogon.exe") || SourceImage.endsWith("\winscp.exe") ||
    SourceImage.endsWith("\wmic.exe") || SourceImage.endsWith("\word.exe") || SourceImage.endsWith("\wscript.exe"))
    &&  ! (SourceImage.includes("Visual Studio")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"66d31e5f-52d6-40a4-9615-002d3789a119_sysmon_ot"'
  description: Suspicious Remote Thread Created
- id: eval
  filter: (EventID=="8" && SourceImage.endsWith("\powershell.exe") && TargetImage.endsWith("\rundll32.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"99b97608-3e21-4bfe-8217-2a127c396a0e_sysmon_ot"'
  description: PowerShell Rundll32 Remote Thread Creation
- id: eval
  filter: (EventID=="15" && Hashes.includes("IMPHASH=") &&  ! (Hashes.includes("IMPHASH=00000000000000000000000000000000")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b69888d4-380c-45ce-9cf9-d9ce46e67821_sysmon_ot"'
  description: Executable in ADS
- id: eval
  filter: (EventID=="15" && Image.endsWith("\regedit.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0d7a9363-af70-4e7b-a3b7-1a176b7fbe84_sysmon_ot"'
  description: Exports Registry Key To an Alternate Data Stream
- id: eval
  filter: (EventID=="22" && ((QueryName.startsWith("aaa.stage.") || QueryName.startsWith("post.1"))
    || QueryName.includes(".stage.123456.")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f356a9c4-effd-4608-bbf8-408afd5cd006_sysmon_ot"'
  description: Suspicious Cobalt Strike DNS Beaconing
- id: eval
  filter: (EventID=="22" && (QueryName=="canireachthe.net" || QueryName=="ipv4.icanhazip.com"
    || QueryName=="ip.anysrc.net" || QueryName=="edns.ip-api.com" || QueryName=="wtfismyip.com"
    || QueryName=="checkip.dyndns.org" || QueryName=="api.2ip.ua" || QueryName=="icanhazip.com"
    || QueryName=="api.ipify.org" || QueryName=="ip-api.com" || QueryName=="checkip.amazonaws.com"
    || QueryName=="ipecho.net" || QueryName=="ipinfo.io" || QueryName=="ipv4bot.whatismyipaddress.com"
    || QueryName=="freegeoip.app") &&  ! ((Image.endsWith("\chrome.exe") || Image.endsWith("\iexplore.exe")
    || Image.endsWith("\firefox.exe") || Image.endsWith("\brave.exe") || Image.endsWith("\opera.exe")
    || Image.endsWith("\msedge.exe") || Image.endsWith("\vivaldi.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ec82e2a5-81ea-4211-a1f8-37a0286df2c2_sysmon_ot"'
  description: Suspicious DNS Query for IP Lookup Service APIs
- id: eval
  filter: (EventID=="22" && QueryName.includes("servicebus.windows.net") && Image.includes("HybridConnectionManager"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7bd3902d-8b8b-4dd4-838a-c6862d40150d_sysmon_ot"'
  description: DNS HybridConnectionManager Service Bus
- id: eval
  filter: (EventID=="22" && QueryName.includes("userstorage.mega.co.nz"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"613c03ba-0779-4a53-8a1f-47f914a4ded3_sysmon_ot"'
  description: DNS Query for MEGA.io Upload Domain
- id: eval
  filter: (EventID=="22" && Image.endsWith("\regsvr32.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"36e037c4-c228-4866-b6a3-48eb292b9955_sysmon_ot"'
  description: Regsvr32 Network Activity
- id: eval
  filter: (EventID=="22" && Image.startsWith("C:\Program Files\WindowsApps\Microsoft.DesktopAppInstaller_")
    && Image.endsWith("\AppInstaller.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7cff77e1-9663-46a3-8260-17f2e1aa9d0a_sysmon_ot"'
  description: AppInstaller Attempts From URL by DNS
- id: eval
  filter: (EventID=="6" && (ImageLoaded.includes("fgexec") || ImageLoaded.includes("dumpsvc")
    || ImageLoaded.includes("cachedump") || ImageLoaded.includes("mimidrv") || ImageLoaded.includes("gsecdump")
    || ImageLoaded.includes("servpw") || ImageLoaded.includes("pwdump")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"df5ff0a5-f83f-4a5b-bba1-3e6a3f6f6ea2_sysmon_ot"'
  description: Credential Dumping Tools Service Execution
- id: eval
  filter: (EventID=="6" && ((ImagePath.includes("cmd") && ImagePath.includes("/c")
    && ImagePath.includes("echo") && ImagePath.includes("\pipe\\")) || (ImagePath.includes("%COMSPEC%")
    && ImagePath.includes("/c") && ImagePath.includes("echo") && ImagePath.includes("\pipe\\"))
    || (ImagePath.includes("cmd.exe") && ImagePath.includes("/c") && ImagePath.includes("echo")
    && ImagePath.includes("\pipe\\")) || (ImagePath.includes("rundll32") && ImagePath.includes(".dll,a")
    && ImagePath.includes("/p:"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d585ab5a-6a69-49a8-96e8-4a726a54de46_sysmon_ot"'
  description: Meterpreter or Cobalt Strike Getsystem Service Installation
- id: eval
  filter: (EventID=="6" && (ImageLoaded.includes("powershell") || ImageLoaded.includes("pwsh")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"46deb5e1-28c9-4905-b2df-51cdcc9e6073_sysmon_ot"'
  description: PowerShell Scripts Run by a Services
- id: eval
  filter: (EventID=="6" && ImageLoaded.includes("\Temp\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2c4523d5-d481-4ed0-8ec3-7fbf0cb41a75_sysmon_ot"'
  description: Suspicious Driver Load from Temp
- id: eval
  filter: (EventID=="6" && (ImageLoaded.includes("\DBUtil_2_3.Sys") || (Hashes.includes("0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5")
    || Hashes.includes("c948ae14761095e4d76b55d9de86412258be7afd") || Hashes.includes("c996d7971c49252c582171d9380360f2")
    || Hashes.includes("ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1")
    || Hashes.includes("10b30bdee43b3a2ec4aa63375577ade650269d25") || Hashes.includes("d2fd132ab7bbc6bbb87a84f026fa0244"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"21b23707-60d6-41bb-96e3-0f0481b0fed9_sysmon_ot"'
  description: Vulnerable Dell BIOS Update Driver Load
- id: eval
  filter: (EventID=="6" && (ImageLoaded.includes("\WinDivert.sys") || ImageLoaded.includes("\WinDivert64.sys")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"679085d5-f427-4484-9f58-1dc30a7c426d_sysmon_ot"'
  description: WinDivert Driver Load
- id: eval
  filter: (EventID=="23" && (TargetFilename.startsWith("C:\Windows\Prefetch\\") &&
    TargetFilename.endsWith(".pf")) &&  ! (Image=="C:\windows\system32\svchost.exe"
    && (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE NT\Sys"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0a1f9d29-6465-4776-b091-7f43b26e4c89_sysmon_ot"'
  description: Prefetch File Deletion
- id: eval
  filter: (EventID=="23" && (TargetFilename.endsWith(".AAA") || TargetFilename.endsWith(".ZZZ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6ddab845-b1b8-49c2-bbf7-1a11967f64bc_sysmon_ot"'
  description: Sysinternals SDelete File Deletion
- id: eval
  filter: (EventID=="23" && Image.endsWith("spoolsv.exe") && TargetFilename.includes("C:\Windows\System32\spool\drivers\x64\3\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5b2bbc47-dead-4ef7-8908-0cf73fcbecbf_sysmon_ot"'
  description: Windows Spooler Service Suspicious File Deletion
- id: eval
  filter: (EventID=="23" && (TargetFilename.endsWith(".log") && TargetFilename.includes("\TeamViewer_"))
    &&  ! (Image=="C:\Windows\system32\svchost.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b1decb61-ed83-4339-8e95-53ea51901720_sysmon_ot"'
  description: Delete Log from Application
- id: eval
  filter: (EventID=="23" && Image.endsWith("cmd.exe") && (TargetFilename.endsWith(".VHD")
    || TargetFilename.endsWith(".bac") || TargetFilename.endsWith(".bak") || TargetFilename.endsWith(".wbcat")
    || TargetFilename.endsWith(".bkf") || TargetFilename.endsWith(".set") || TargetFilename.endsWith(".win")
    || TargetFilename.endsWith(".dsk")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"06125661-3814-4e03-bfa2-1e4411c60ac3_sysmon_ot"'
  description: Deletes Backup Files
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("\AppData\Local\Temp\Advanced
    IP Scanner 2"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fed85bf9-e075-4280-9159-fbe8a023d6fa_sysmon_ot"'
  description: Advanced IP Scanner
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("ds7002.lnk"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3a3f81ca-652c-482b-adeb-b1c804727f74_sysmon_ot"'
  description: Unidentified Attacker November 2018
- id: eval
  filter: (EventID=="11" && (TargetFilename.includes("C:\Windows\system32\physmem.sys")
    || TargetFilename.includes("C:\Windows\System32\IME\IMEJP\imjpueact.dll") || TargetFilename.includes("C:\Windows\system32\ime\IMETC\IMTCPROT.DLL")
    || TargetFilename.includes("C:\Windows\system32\ime\SHARED\imecpmeid.dll") ||
    TargetFilename.includes("C:\Windows\system32\config\spp\ServiceState\Recovery\pac.dat")
    || TargetFilename.includes("C:\Windows\system32\config\cy-GB\Setup\SKB\InputMethod\TupTask.dat")
    || TargetFilename.includes("C:\Windows\system32\config\config\startwus.dat") ||
    TargetFilename.includes("C:\Windows\system32\ime\SHARED\WimBootConfigurations.ini")
    || TargetFilename.includes("C:\Windows\system32\ime\IMEJP\WimBootConfigurations.ini")
    || TargetFilename.includes("C:\Windows\system32\ime\IMETC\WimBootConfigurations.ini")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ad7085ac-92e4-4b76-8ce2-276d2c0e68ef_sysmon_ot"'
  description: CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum
- id: eval
  filter: (EventID=="11" && Image.endsWith("\msiexec.exe") && TargetFilename.startsWith("C:\Program
    Files (x86)\Microsoft\Edge\Application") && TargetFilename.endsWith("\elevation_service.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3be82d5d-09fe-4d6a-a275-0d40d234d324_sysmon_ot"'
  description: InstallerFileTakeOver LPE CVE-2021-41379 File Create Event
- id: eval
  filter: (EventID=="11" && TargetFilename=="C:\Windows\Temp\dumpert.dmp")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"93d94efc-d7ad-4161-ad7d-1638c4f908d8_sysmon_ot"'
  description: Dumpert Process Dumper
- id: eval
  filter: (EventID=="11" && (TargetFilename.endsWith("\NPPSpy.txt") || TargetFilename.endsWith("\NPPSpy.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cad1fe90-2406-44dc-bd03-59d0b58fe722_sysmon_ot"'
  description: NPPSpy Hacktool Usage
- id: eval
  filter: (EventID=="11" && ((TargetFilename.endsWith("\lsass.dmp") || TargetFilename.endsWith("\lsass.zip")
    || TargetFilename.endsWith("\lsass.rar") || TargetFilename.endsWith("\Temp\dumpert.dmp"))
    || (TargetFilename.includes("\lsass_2") || TargetFilename.includes("\lsassdump")
    || TargetFilename.includes("\lsassdmp"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a5a2d357-1ab8-4675-a967-ef9990a59391_sysmon_ot"'
  description: LSASS Process Memory Dump Files
- id: eval
  filter: (EventID=="11" && ((TargetFilename.includes("\AppData\Roaming\Oracle\bin\java")
    && TargetFilename.includes(".exe")) || (TargetFilename.includes("\Retrive") &&
    TargetFilename.includes(".vbs"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0bcfabcb-7929-47f4-93d6-b33fb67d34d1_sysmon_ot"'
  description: Adwind RAT / JRAT
- id: eval
  filter: (EventID=="11" && (TargetFilename.endsWith("\AppData\Local\Microsoft\Cache134.dat")
    || TargetFilename.endsWith("\AppData\Local\Microsoft\ExplorerSync.db")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"805c55d9-31e6-4846-9878-c34c75054fe9_sysmon_ot"'
  description: Octopus Scanner Malware
- id: eval
  filter: (EventID=="11" && (Image.endsWith("chrome.exe") || Image.endsWith("firefox.exe")
    || Image.endsWith("microsoftedge.exe") || Image.endsWith("microsoftedgecp.exe")
    || Image.endsWith("msedge.exe") || Image.endsWith("iexplorer.exe") || Image.endsWith("brave.exe")
    || Image.endsWith("opera.exe")) && TargetFilename.includes(".vhd"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8468111a-ef07-4654-903b-b863a80bbc95_sysmon_ot"'
  description: Suspicious VHD Image Download From Browser
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith(".kirbi"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9e099d99-44c2-42b6-a6d8-54c3545cab29_sysmon_ot"'
  description: Mimikatz Kirbi File Creation
- id: eval
  filter: (EventID=="11" && (TargetFilename.endsWith("mimilsa.log")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"034affe8-6170-11ec-844f-0f78aa0c4d66_sysmon_ot"'
  description: Mimikatz MemSSP Default Log File Creation
- id: eval
  filter: (EventID=="11" && TargetFilename=="C:\Windows\System32\drivers\MoriyaStreamWatchmen.sys")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a1507d71-0b60-44f6-b17c-bf53220fdd88_sysmon_ot"'
  description: Moriya Rootkit
- id: eval
  filter: (EventID=="11" && Image.endsWith("updata.exe") && TargetFilename=="C:\Windows\oci.dll")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2bd63d53-84d4-4210-80ff-bf0658f1bf78_sysmon_ot"'
  description: Pingback Backdoor
- id: eval
  filter: (EventID=="11" && (Image.endsWith("winword.exe") || Image.endsWith("excel.exe")
    || Image.endsWith("powerpnt.exe")) && (TargetFilename.endsWith(".exe") || TargetFilename.endsWith(".dll")
    || TargetFilename.endsWith(".ocx") || TargetFilename.endsWith(".com") || TargetFilename.endsWith(".ps1")
    || TargetFilename.endsWith(".vbs") || TargetFilename.endsWith(".sys") || TargetFilename.endsWith(".bat")
    || TargetFilename.endsWith(".scr") || TargetFilename.endsWith(".proj")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c7a74c80-ba5a-486e-9974-ab9e682bc5e4_sysmon_ot"'
  description: Created Files by Office Applications
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith("\ntds.dit") && (Image.endsWith("\powershell.exe")
    || Image.endsWith("\cmd.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"11b1ed55-154d-4e82-8ad7-83739298f720_sysmon_ot"'
  description: Suspicious Process Writes Ntds.dit
- id: eval
  filter: (EventID=="11" && (TargetFilename=="C:\Windows\System32\config\systemprofile\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt"
    || TargetFilename=="C:\Windows\System32\config\systemprofile\AppData\\Local\Microsoft\Windows\PowerShell\StartupProfileData-Interactive"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5b40a734-99b6-4b98-a1d0-1cea51a08ab2_sysmon_ot"'
  description: Suspicious Interactive PowerShell as SYSTEM
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("\Windows\System32\Tasks") &&
    (Image.includes("\AppData\\") || Image.includes("C:\PerfLogs") || Image.includes("\Windows\System32\config\systemprofile")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"80e1f67a-4596-4351-98f5-a9c3efabac95_sysmon_ot"'
  description: Suspicious Scheduled Task Write to System32 Tasks
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith("\PSEXESVC.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"259e5a6a-b8d2-4c38-86e2-26c5e651361d_sysmon_ot"'
  description: PsExec Tool Execution
- id: eval
  filter: (EventID=="11" && TargetFilename.startsWith("C:\Users\\") && (TargetFilename.endsWith("\AppData\Local\Temp\system32\winsat.exe")
    || TargetFilename.endsWith("\AppData\Local\Temp\system32\winmm.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"155dbf56-e0a4-4dd0-8905-8a98705045e8_sysmon_ot"'
  description: UAC Bypass Abusing Winsat Path Parsing - File
- id: eval
  filter: (EventID=="11" && ((TargetFilename.startsWith("C:\Users\\") && TargetFilename.endsWith("\AppData\Local\Temp\OskSupport.dll"))
    || (Image=="C:\Windows\system32\DllHost.exe" && TargetFilename=="C:\Program Files\Windows
    Media Player\osk.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"68578b43-65df-4f81-9a9b-92f32711a951_sysmon_ot"'
  description: UAC Bypass Using Windows Media Player - File
- id: eval
  filter: (EventID=="11" && (TargetFilename.endsWith("WsmPty.xsl") || TargetFilename.endsWith("WsmTxt.xsl"))
    &&  ! ((TargetFilename.startsWith("C:\Windows\System32\\") || TargetFilename.startsWith("C:\Windows\SysWOW64\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d353dac0-1b41-46c2-820c-d7d2561fc6ed_sysmon_ot"'
  description: AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl
- id: eval
  filter: (EventID=="11" && (Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe"))
    && (TargetFilename.startsWith("C:\Users\\") || TargetFilename.startsWith("C:\ProgramData"))
    && (TargetFilename.endsWith(".jse") || TargetFilename.endsWith(".vbe") || TargetFilename.endsWith(".js")
    || TargetFilename.endsWith(".vba") || TargetFilename.endsWith(".vbs")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"002bdb95-0cf1-46a6-9e08-d38c128a6127_sysmon_ot"'
  description: WScript or CScript Dropper
- id: eval
  filter: (EventID=="11" && (((Image.endsWith("\cmd.exe") || Image.endsWith("\powershell.exe")
    || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe") || Image.endsWith("\sh.exe")
    || Image.endsWith("\bash.exe") || Image.endsWith("\msbuild.exe") || Image.endsWith("\certutil.exe"))
    && (TargetFilename.includes("C:\Users\Public") || TargetFilename.includes("C:\PerfLogs")))
    || ((Image.endsWith("\schtasks.exe") || Image.endsWith("\wmic.exe") || Image.endsWith("\mshta.exe")
    || Image.endsWith("\forfiles.exe") || Image.endsWith("\scriptrunner.exe") || Image.endsWith("\certutil.exe"))
    && (TargetFilename.includes("C:\Users\Public") || TargetFilename.includes("C:\PerfLogs")
    || TargetFilename.includes("\AppData\\") || TargetFilename.includes("C:\Windows\Temp")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1277f594-a7d1-4f28-a2d3-73af5cbeab43_sysmon_ot"'
  description: Windows Shell File Write to Suspicious Folder
- id: eval
  filter: (EventID=="11" && Image=="System" && TargetFilename.endsWith("\wbem\wbemcomn.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"614a7e17-5643-4d89-b6fe-f9df1a79641c_sysmon_ot"'
  description: Wmiprvse Wbemcomn DLL Hijack
- id: eval
  filter: (EventID=="11" && ((TargetFilename.endsWith("\svchost.exe") || TargetFilename.endsWith("\rundll32.exe")
    || TargetFilename.endsWith("\services.exe") || TargetFilename.endsWith("\powershell.exe")
    || TargetFilename.endsWith("\regsvr32.exe") || TargetFilename.endsWith("\spoolsv.exe")
    || TargetFilename.endsWith("\lsass.exe") || TargetFilename.endsWith("\smss.exe")
    || TargetFilename.endsWith("\csrss.exe") || TargetFilename.endsWith("\conhost.exe")
    || TargetFilename.endsWith("\wininit.exe") || TargetFilename.endsWith("\lsm.exe")
    || TargetFilename.endsWith("\winlogon.exe") || TargetFilename.endsWith("\explorer.exe")
    || TargetFilename.endsWith("\taskhost.exe") || TargetFilename.endsWith("\Taskmgr.exe")
    || TargetFilename.endsWith("\taskmgr.exe") || TargetFilename.endsWith("\sihost.exe")
    || TargetFilename.endsWith("\RuntimeBroker.exe") || TargetFilename.endsWith("\runtimebroker.exe")
    || TargetFilename.endsWith("\smartscreen.exe") || TargetFilename.endsWith("\dllhost.exe")
    || TargetFilename.endsWith("\audiodg.exe") || TargetFilename.endsWith("\wlanext.exe"))
    &&  ! ((TargetFilename.startsWith("C:\Windows\System32\\") || TargetFilename.startsWith("C:\Windows\system32\\")
    || TargetFilename.startsWith("C:\Windows\SysWow64\\") || TargetFilename.startsWith("C:\Windows\SysWOW64\\")
    || TargetFilename.startsWith("C:\Windows\winsxs\\") || TargetFilename.startsWith("C:\Windows\WinSxS\\")
    || TargetFilename.startsWith("\SystemRoot\System32\\")) && Image.endsWith("\Windows\System32\dism.exe")))
    &&  ! (TargetFilename.startsWith("C:\$WINDOWS.~BT\\") && Image=="C:\$WINDOWS.~BT\Sources\SetupHost.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d5866ddf-ce8f-4aea-b28e-d96485a20d3d_sysmon_ot"'
  description: File Created with System Process Name
- id: eval
  filter: (EventID=="11" && ((TargetFilename.includes("\pwdump") || TargetFilename.includes("\kirbi")
    || TargetFilename.includes("\pwhashes") || TargetFilename.includes("\wce_ccache")
    || TargetFilename.includes("\wce_krbtkts") || TargetFilename.includes("\fgdump-log"))
    || (TargetFilename.endsWith("\test.pwd") || TargetFilename.endsWith("\lsremora64.dll")
    || TargetFilename.endsWith("\lsremora.dll") || TargetFilename.endsWith("\fgexec.exe")
    || TargetFilename.endsWith("\wceaux.dll") || TargetFilename.endsWith("\SAM.out")
    || TargetFilename.endsWith("\SECURITY.out") || TargetFilename.endsWith("\SYSTEM.out")
    || TargetFilename.endsWith("\NTDS.out") || TargetFilename.endsWith("\DumpExt.dll")
    || TargetFilename.endsWith("\DumpSvc.exe") || TargetFilename.endsWith("\cachedump64.exe")
    || TargetFilename.endsWith("\cachedump.exe") || TargetFilename.endsWith("\pstgdump.exe")
    || TargetFilename.endsWith("\servpw.exe") || TargetFilename.endsWith("\servpw64.exe")
    || TargetFilename.endsWith("\pwdump.exe") || TargetFilename.endsWith("\procdump64.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8fbf3271-1ef6-4e94-8210-03c2317947f6_sysmon_ot"'
  description: Cred Dump Tools Dropped Files
- id: eval
  filter: (EventID=="11" && Image.endsWith("UMWorkerProcess.exe") &&  ! ((TargetFilename.endsWith("CacheCleanup.bin")
    || TargetFilename.endsWith(".txt") || TargetFilename.endsWith(".LOG") || TargetFilename.endsWith(".cfg")
    || TargetFilename.endsWith("cleanup.bin"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b06335b3-55ac-4b41-937e-16b7f5d57dfd_sysmon_ot"'
  description: CVE-2021-26858 Exchange Exploitation
- id: eval
  filter: (EventID=="11" && Image.endsWith("\powershell.exe") && TargetFilename.endsWith(".bat"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"602a1f13-c640-4d73-b053-be9a2fa58b96_sysmon_ot"'
  description: Powerup Write Hijack DLL
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith("\Temp\debug.bin"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e074832a-eada-4fd7-94a1-10642b130e16_sysmon_ot"'
  description: Detection of SafetyKatz
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("lsass") && TargetFilename.endsWith("dmp"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5e3d3601-0662-4af0-b1d2-36a05e90c40a_sysmon_ot"'
  description: LSASS Memory Dump File Creation
- id: eval
  filter: (EventID=="11" && (((TargetFilename.includes("\Microsoft\Word\Startup\\")
    && TargetFilename.endsWith(".wll")) || (TargetFilename.includes("\Microsoft\Excel\Startup\\")
    && TargetFilename.endsWith(".xll"))) || (TargetFilename.includes("\Microsoft\Addins\\")
    && (TargetFilename.endsWith(".xlam") || TargetFilename.endsWith(".xla")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8e1cb247-6cf6-42fa-b440-3f27d57e9936_sysmon_ot"'
  description: Microsoft Office Add-In Loading
- id: eval
  filter: (EventID=="11" && Image=="\outlook.exe" && TargetFilename.includes("\appdata\local\microsoft\FORMS\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c3edc6a5-d9d4-48d8-930e-aab518390917_sysmon_ot"'
  description: Outlook Form Installation
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("\AppData\Local\Temp\ba9ea7344a4a5f591d6e5dc32a13494b\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6e90ae7a-7cd3-473f-a035-4ebb72d961da_sysmon_ot"'
  description: PCRE.NET Package Temp Files
- id: eval
  filter: (EventID=="11" && (TargetFilename.endsWith("\Invoke-DllInjection.ps1") ||
    TargetFilename.endsWith("\Invoke-WmiCommand.ps1") || TargetFilename.endsWith("\Get-GPPPassword.ps1")
    || TargetFilename.endsWith("\Get-Keystrokes.ps1") || TargetFilename.endsWith("\Get-VaultCredential.ps1")
    || TargetFilename.endsWith("\Invoke-CredentialInjection.ps1") || TargetFilename.endsWith("\Invoke-Mimikatz.ps1")
    || TargetFilename.endsWith("\Invoke-NinjaCopy.ps1") || TargetFilename.endsWith("\Invoke-TokenManipulation.ps1")
    || TargetFilename.endsWith("\Out-Minidump.ps1") || TargetFilename.endsWith("\VolumeShadowCopyTools.ps1")
    || TargetFilename.endsWith("\Invoke-ReflectivePEInjection.ps1") || TargetFilename.endsWith("\Get-TimedScreenshot.ps1")
    || TargetFilename.endsWith("\Invoke-UserHunter.ps1") || TargetFilename.endsWith("\Find-GPOLocation.ps1")
    || TargetFilename.endsWith("\Invoke-ACLScanner.ps1") || TargetFilename.endsWith("\Invoke-DowngradeAccount.ps1")
    || TargetFilename.endsWith("\Get-ServiceUnquoted.ps1") || TargetFilename.endsWith("\Get-ServiceFilePermission.ps1")
    || TargetFilename.endsWith("\Get-ServicePermission.ps1") || TargetFilename.endsWith("\Invoke-ServiceAbuse.ps1")
    || TargetFilename.endsWith("\Install-ServiceBinary.ps1") || TargetFilename.endsWith("\Get-RegAutoLogon.ps1")
    || TargetFilename.endsWith("\Get-VulnAutoRun.ps1") || TargetFilename.endsWith("\Get-VulnSchTask.ps1")
    || TargetFilename.endsWith("\Get-UnattendedInstallFile.ps1") || TargetFilename.endsWith("\Get-WebConfig.ps1")
    || TargetFilename.endsWith("\Get-ApplicationHost.ps1") || TargetFilename.endsWith("\Get-RegAlwaysInstallElevated.ps1")
    || TargetFilename.endsWith("\Get-Unconstrained.ps1") || TargetFilename.endsWith("\Add-RegBackdoor.ps1")
    || TargetFilename.endsWith("\Add-ScrnSaveBackdoor.ps1") || TargetFilename.endsWith("\Gupt-Backdoor.ps1")
    || TargetFilename.endsWith("\Invoke-ADSBackdoor.ps1") || TargetFilename.endsWith("\Enabled-DuplicateToken.ps1")
    || TargetFilename.endsWith("\Invoke-PsUaCme.ps1") || TargetFilename.endsWith("\Remove-Update.ps1")
    || TargetFilename.endsWith("\Check-VM.ps1") || TargetFilename.endsWith("\Get-LSASecret.ps1")
    || TargetFilename.endsWith("\Get-PassHashes.ps1") || TargetFilename.endsWith("\Show-TargetScreen.ps1")
    || TargetFilename.endsWith("\Port-Scan.ps1") || TargetFilename.endsWith("\Invoke-PoshRatHttp.ps1")
    || TargetFilename.endsWith("\Invoke-PowerShellTCP.ps1") || TargetFilename.endsWith("\Invoke-PowerShellWMI.ps1")
    || TargetFilename.endsWith("\Add-Exfiltration.ps1") || TargetFilename.endsWith("\Add-Persistence.ps1")
    || TargetFilename.endsWith("\Do-Exfiltration.ps1") || TargetFilename.endsWith("\Start-CaptureServer.ps1")
    || TargetFilename.endsWith("\Invoke-ShellCode.ps1") || TargetFilename.endsWith("\Get-ChromeDump.ps1")
    || TargetFilename.endsWith("\Get-ClipboardContents.ps1") || TargetFilename.endsWith("\Get-FoxDump.ps1")
    || TargetFilename.endsWith("\Get-IndexedItem.ps1") || TargetFilename.endsWith("\Get-Screenshot.ps1")
    || TargetFilename.endsWith("\Invoke-Inveigh.ps1") || TargetFilename.endsWith("\Invoke-NetRipper.ps1")
    || TargetFilename.endsWith("\Invoke-EgressCheck.ps1") || TargetFilename.endsWith("\Invoke-PostExfil.ps1")
    || TargetFilename.endsWith("\Invoke-PSInject.ps1") || TargetFilename.endsWith("\Invoke-RunAs.ps1")
    || TargetFilename.endsWith("\MailRaider.ps1") || TargetFilename.endsWith("\New-HoneyHash.ps1")
    || TargetFilename.endsWith("\Set-MacAttribute.ps1") || TargetFilename.endsWith("\Invoke-DCSync.ps1")
    || TargetFilename.endsWith("\Invoke-PowerDump.ps1") || TargetFilename.endsWith("\Exploit-Jboss.ps1")
    || TargetFilename.endsWith("\Invoke-ThunderStruck.ps1") || TargetFilename.endsWith("\Invoke-VoiceTroll.ps1")
    || TargetFilename.endsWith("\Set-Wallpaper.ps1") || TargetFilename.endsWith("\Invoke-InveighRelay.ps1")
    || TargetFilename.endsWith("\Invoke-PsExec.ps1") || TargetFilename.endsWith("\Invoke-SSHCommand.ps1")
    || TargetFilename.endsWith("\Get-SecurityPackages.ps1") || TargetFilename.endsWith("\Install-SSP.ps1")
    || TargetFilename.endsWith("\Invoke-BackdoorLNK.ps1") || TargetFilename.endsWith("\PowerBreach.ps1")
    || TargetFilename.endsWith("\Get-SiteListPassword.ps1") || TargetFilename.endsWith("\Get-System.ps1")
    || TargetFilename.endsWith("\Invoke-BypassUAC.ps1") || TargetFilename.endsWith("\Invoke-Tater.ps1")
    || TargetFilename.endsWith("\Invoke-WScriptBypassUAC.ps1") || TargetFilename.endsWith("\PowerUp.ps1")
    || TargetFilename.endsWith("\PowerView.ps1") || TargetFilename.endsWith("\Get-RickAstley.ps1")
    || TargetFilename.endsWith("\Find-Fruit.ps1") || TargetFilename.endsWith("\HTTP-Login.ps1")
    || TargetFilename.endsWith("\Find-TrustedDocuments.ps1") || TargetFilename.endsWith("\Invoke-Paranoia.ps1")
    || TargetFilename.endsWith("\Invoke-WinEnum.ps1") || TargetFilename.endsWith("\Invoke-ARPScan.ps1")
    || TargetFilename.endsWith("\Invoke-PortScan.ps1") || TargetFilename.endsWith("\Invoke-ReverseDNSLookup.ps1")
    || TargetFilename.endsWith("\Invoke-SMBScanner.ps1") || TargetFilename.endsWith("\Invoke-Mimikittenz.ps1")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f331aa1f-8c53-4fc3-b083-cc159bc971cb_sysmon_ot"'
  description: Malicious PowerShell Commandlet Names
- id: eval
  filter: (EventID=="11" && Image.endsWith("\powershell.exe") && TargetFilename.includes("\start
    menu\programs\startup\\") && TargetFilename.endsWith(".lnk"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"92fa78e7-4d39-45f1-91a3-8b23f3f1088d_sysmon_ot"'
  description: PowerShell Writing Startup Shortcuts
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("\AppData\Local\Temp\SAM-") &&
    TargetFilename.includes(".dmp"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"847def9e-924d-4e90-b7c4-5f581395a2b4_sysmon_ot"'
  description: QuarksPwDump Dump File
- id: eval
  filter: (EventID=="11" && (TargetFilename.includes("gthread-3.6.dll") || TargetFilename.includes("sigcmm-2.4.dll")
    || TargetFilename.includes("\Windows\Temp\tmp.bat")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"130c9e58-28ac-4f83-8574-0a4cc913b97e_sysmon_ot"'
  description: RedMimicry Winnti Playbook Dropped File
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("ProgramData\Microsoft\Windows\Start
    Menu\Programs\StartUp"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2aa0a6b4-a865-495b-ab51-c28249537b75_sysmon_ot"'
  description: Startup Folder File Write
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("\profile.ps1") && (TargetFilename.includes("\My
    Documents\PowerShell\\") || TargetFilename.includes("C:\Windows\System32\WindowsPowerShell\v1.0\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b5b78988-486d-4a80-b991-930eff3ff8bf_sysmon_ot"'
  description: Powershell Profile.ps1 Modification
- id: eval
  filter: (EventID=="11" && (TargetFilename.includes("\Local\Microsoft\Windows\SchCache\\")
    && TargetFilename.endsWith(".sch")) &&  ! ((Image=="C:\windows\system32\svchost.exe"
    || Image=="C:\windows\system32\dllhost.exe" || Image=="C:\windows\system32\mmc.exe"
    || Image=="C:\windows\system32\WindowsPowerShell\v1.0\powershell.exe" || Image=="C:\Windows\CCM\CcmExec.exe"
    || Image=="C:\Program Files\Cylance\Desktop\CylanceSvc.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"75bf09fa-1dd7-4d18-9af9-dd9e492562eb_sysmon_ot"'
  description: Suspicious ADSI-Cache Usage By Unknown Tool
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("\AppData\Local\Microsoft\CLR")
    && TargetFilename.includes("\UsageLogs\\") && (TargetFilename.includes("mshta")
    || TargetFilename.includes("cscript") || TargetFilename.includes("wscript") ||
    TargetFilename.includes("regsvr32") || TargetFilename.includes("wmic") || TargetFilename.includes("rundll32")
    || TargetFilename.includes("svchost")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e4b63079-6198-405c-abd7-3fe8b0ce3263_sysmon_ot"'
  description: Suspcious CLR Logs Creation
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith("\desktop.ini") &&  ! ((Image.startsWith("C:\Windows\\")
    || Image.startsWith("C:\Program Files\\") || Image.startsWith("C:\Program Files
    (x86)\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"81315b50-6b60-4d8f-9928-3466e1022515_sysmon_ot"'
  description: Suspicious desktop.ini Action
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith(".pfx"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dca1b3e8-e043-4ec8-85d7-867f334b5724_sysmon_ot"'
  description: Suspicious PFX File Creation
- id: eval
  filter: (EventID=="11" && (TargetFilename.includes("\AppData\Local\Temp\\") && TargetFilename.endsWith("PROCEXP152.sys"))
    &&  ! ((Image.includes("\procexp64.exe") || Image.includes("\procexp.exe") ||
    Image.includes("\procmon64.exe") || Image.includes("\procmon.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3da70954-0f2c-4103-adff-b7440368f50e_sysmon_ot"'
  description: Suspicious PROCEXP152.sys File Created In TMP
- id: eval
  filter: (EventID=="11" && Image.endsWith("\mstsc.exe") && TargetFilename.includes("\Microsoft\Windows\Start
    Menu\Programs\Startup\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"52753ea4-b3a0-4365-910d-36cff487b789_sysmon_ot"'
  description: Hijack Legit RDP Session to Move Laterally
- id: eval
  filter: (EventID=="11" && TargetFilename.startsWith("C:\Windows\System32\consent.exe.@")
    && TargetFilename.endsWith("\comctl32.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"62ed5b55-f991-406a-85d9-e8e8fdf18789_sysmon_ot"'
  description: UAC Bypass Using Consent and Comctl32 - File
- id: eval
  filter: (EventID=="11" && TargetFilename.startsWith("C:\Users\\") && TargetFilename.endsWith("\AppData\Local\Temp\pe386.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"93a19907-d4f9-4deb-9f91-aac4692776a6_sysmon_ot"'
  description: UAC Bypass Using .NET Code Profiler on MMC
- id: eval
  filter: (EventID=="11" && Image=="C:\Program Files\Internet Explorer\IEInstal.exe"
    && TargetFilename.startsWith("C:\Users\\") && TargetFilename.includes("\AppData\Local\Temp\\")
    && TargetFilename.endsWith("consent.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bdd8157d-8e85-4397-bb82-f06cc9c71dbb_sysmon_ot"'
  description: UAC Bypass Using IEInstal - File
- id: eval
  filter: (EventID=="11" && TargetFilename.startsWith("C:\Users\\") && TargetFilename.endsWith("\AppData\Local\Temp\pkgmgr.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"41bb431f-56d8-4691-bb56-ed34e390906f_sysmon_ot"'
  description: UAC Bypass Using MSConfig Token Modification - File
- id: eval
  filter: (EventID=="11" && TargetFilename.startsWith("C:\Users\\") && TargetFilename.endsWith("\AppData\Local\Temp\api-ms-win-core-kernel32-legacy-l1.DLL"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7fff6773-2baa-46de-a24a-b6eec1aba2d1_sysmon_ot"'
  description: UAC Bypass Using NTFS Reparse Point - File
- id: eval
  filter: (EventID=="11" && ((((TargetFilename.includes("\inetpub\wwwroot\\") && (TargetFilename.includes(".asp")
    || TargetFilename.includes(".ashx") || TargetFilename.includes(".ph"))) &&  !
    ((TargetFilename.includes("\AppData\Local\Temp\\") || TargetFilename.includes("\Windows\Temp\\"))))
    || (((TargetFilename.includes("\www\\") || TargetFilename.includes("\htdocs\\")
    || TargetFilename.includes("\html\\")) && TargetFilename.includes(".ph")) &&  !
    ((TargetFilename.includes("\AppData\Local\Temp\\") || TargetFilename.includes("\Windows\Temp\\")))))
    || ((TargetFilename.endsWith(".jsp") || (TargetFilename.includes("\cgi-bin\\")
    && TargetFilename.includes(".pl"))) &&  ! ((TargetFilename.includes("\AppData\Local\Temp\\")
    || TargetFilename.includes("\Windows\Temp\\"))))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"39f1f9f2-9636-45de-98f6-a4046aa8e4b9_sysmon_ot"'
  description: Windows Webshell Creation
- id: eval
  filter: (EventID=="11" && Image=="C:\WINDOWS\system32\wbem\scrcons.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"33f41cdd-35ac-4ba8-814b-c6a4244a1ad4_sysmon_ot"'
  description: WMI Persistence - Script Event Consumer File Write
- id: eval
  filter: (EventID=="11" && (TargetFilename.includes("C:\Windows\System32\spool\drivers\x64\3\old\1\123")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2131cfb3-8c12-45e8-8fa0-31f5924e9f07_sysmon_ot"'
  description: CVE-2021-1675 Print Spooler Exploitation Filename Pattern
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith("\unattend.xml"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1a3d42dd-3763-46b9-8025-b5f17f340dfb_sysmon_ot"'
  description: Suspicious Unattend.xml File Access
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith(".sdb") && TargetFilename.includes("\Windows\apppatch\Custom\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ee63c85c-6d51-4d12-ad09-04e25877a947_sysmon_ot"'
  description: New Shim Database Created in the Default Directory
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith(".scr") &&  ! (((Image.endsWith("\Kindle.exe")
    || Image.endsWith("\Bin\ccSvcHst.exe")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"97aa2e88-555c-450d-85a6-229bcd87efb8_sysmon_ot"'
  description: Suspicious Screensaver Binary File Creation
- id: eval
  filter: (EventID=="11" && TargetFilename=="C:\program.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8c3c76ca-8f8b-4b1d-aaf3-81aebcd367c9_sysmon_ot"'
  description: Creation Exe for Service with Unquoted Path
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith(".cmdline"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e4a74e34-ecde-4aab-b2fb-9112dd01aed0_sysmon_ot"'
  description: Dynamic C Sharp Compile Artefact
- id: eval
  filter: (EventID=="11" && (TargetFilename.endsWith(".docm") || TargetFilename.endsWith(".dotm")
    || TargetFilename.endsWith(".xlsm") || TargetFilename.endsWith(".xltm") || TargetFilename.endsWith(".potm")
    || TargetFilename.endsWith(".pptm") || TargetFilename.endsWith(".pptx")) && ((Image.endsWith("\cmd.exe")
    || Image.endsWith("\powershell.exe")) || (ParentImage.endsWith("\cmd.exe") ||
    ParentImage.endsWith("\powershell.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b1c50487-1967-4315-a026-6491686d860e_sysmon_ot"'
  description: Dump Office Macro Files from Commandline
- id: eval
  filter: (EventID=="11" && Image.endsWith("\colorcpl.exe") &&  ! ((TargetFilename.endsWith(".icm")
    || TargetFilename.endsWith(".gmmp") || TargetFilename.endsWith(".cdmp") || TargetFilename.endsWith(".camp"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e15b518d-b4ce-4410-a9cd-501f23ce4a18_sysmon_ot"'
  description: Suspicious Creation with Colorcpl
- id: eval
  filter: (EventID=="11" && Image.endsWith("\cmd.exe") && TargetFilename.includes("\Users\\")
    && TargetFilename.includes("\Desktop\\") && TargetFilename.endsWith(".txt"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"caf02a0a-1e1c-4552-9b48-5e070bd88d11_sysmon_ot"'
  description: Suspicious Creation TXT File in User Desktop
- id: eval
  filter: (EventID=="11" && TargetFilename.includes("\\127.0.0") && TargetFilename.includes("\ADMIN$\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4aafb0fa-bff5-4b9d-b99e-8093e659c65f_sysmon_ot"'
  description: Writing Local Admin Share
- id: eval
  filter: (EventID=="11" && Image=="\winword.exe" && ((TargetFilename.endsWith(".cab")
    && TargetFilename.includes("\Windows\INetCache")) || (TargetFilename.includes("\AppData\Local\Temp\\")
    && TargetFilename.includes(".inf"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"60c0a111-787a-4e8a-9262-ee485f3ef9d5_sysmon_ot"'
  description: Suspicious Word Cab File Write CVE-2021-40444
- id: eval
  filter: (EventID=="11" && ((TargetFilename.includes("\hive_sam_") || TargetFilename.includes("\SAM-2021-")
    || TargetFilename.includes("\SAM-2022-") || TargetFilename.includes("\SAM-haxx")
    || TargetFilename.includes("\Sam.save")) || (TargetFilename=="C:\windows\temp\sam")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6ea858a8-ba71-4a12-b2cc-5d83312404c7_sysmon_ot"'
  description: Typical HiveNightmare SAM File Export
- id: eval
  filter: (EventID=="11" && TargetFilename.endsWith("\Microsoft\Outlook\VbaProject.OTM"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8c31f563-f9a7-450c-bfa8-35f8f32f1f61_sysmon_ot"'
  description: Outlook C2 Macro Creation
- id: eval
  filter: (EventID=="11" && TargetFilename.includes(":\Users\\") && TargetFilename.includes("\.config\rclone\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"34986307-b7f4-49be-92f3-e7a4d01ac5db_sysmon_ot"'
  description: Rclone Config File Creation
- id: eval
  filter: (EventID=="11" && ((Image.endsWith("svchost.exe") && TargetFilename.includes("\Personalization\LockScreenImage\\"))
    &&  ! (TargetFilename.includes("C:\Windows\\"))) &&  ! ((TargetFilename.includes(".jpg")
    || TargetFilename.includes(".jpeg") || TargetFilename.includes(".png"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fc4f4817-0c53-4683-a4ee-b17a64bc1039_sysmon_ot"'
  description: Suspicious Desktopimgdownldr Target File
- id: eval
  filter: (EventID=="7" && Image.endsWith("msdtc.exe") && ImageLoaded=="C:\Windows\oci.dll")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"35a7dc42-bc6f-46e0-9f83-81f8e56c8d4b_sysmon_ot"'
  description: Pingback Backdoor
- id: eval
  filter: (EventID=="7" && Description.includes("st2stager"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"75c505b1-711d-4f68-a357-8c3fe37dbf2d_sysmon_ot"'
  description: SILENTTRINITY Stager Execution
- id: eval
  filter: (EventID=="7" && Image.endsWith("\wmiprvse.exe") && ImageLoaded.endsWith("\wbem\wbemcomn.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7707a579-e0d8-4886-a853-ce47e4575aaa_sysmon_ot"'
  description: Wmiprvse Wbemcomn DLL Hijack
- id: eval
  filter: (EventID=="7" && (((ImageLoaded.endsWith("\WsmSvc.dll") || ImageLoaded.endsWith("\WsmAuto.dll")
    || ImageLoaded.endsWith("\Microsoft.WSMan.Management.ni.dll")) || (OriginalFileName=="WsmSvc.dll"
    || OriginalFileName=="WSMANAUTOMATION.DLL" || OriginalFileName=="Microsoft.WSMan.Management.dll"))
    || (Image.endsWith("\svchost.exe") && OriginalFileName=="WsmWmiPl.dll")) &&  !
    (((Image.endsWith("\powershell.exe") || Image.endsWith("C:\Windows\System32\sdiagnhost.exe")))
    || ((CommandLine.includes("svchost.exe -k netsvcs -p -s BITS") || CommandLine.includes("svchost.exe
    -k GraphicsPerfSvcGroup -s GraphicsPerfSvc") || CommandLine.includes("svchost.exe
    -k NetworkService -p -s Wecsvc"))) || ((Image.startsWith("C:\Windows\Microsoft.NET\Framework64\v")
    || Image.startsWith("C:\Windows\Microsoft.NET\Framework\v")) && Image.endsWith("\mscorsvw.exe"))
    || ((Image=="C:\Windows\System32\Configure-SMRemoting.exe" || Image=="C:\Windows\System32\ServerManager.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ad1f4bb9-8dfb-4765-adb6-2a7cfb6c0f94_sysmon_ot"'
  description: Suspicious WSMAN Provider Image Loads
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\tttracer.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0b4ae027-2a2d-4b93-8c7e-962caaba5b2a_sysmon_ot"'
  description: Time Travel Debugging Utility Usage
- id: eval
  filter: (EventID=="7" && ImageLoaded.endsWith("MicrosoftAccountTokenProvider.dll")
    &&  ! ((Image.endsWith("\BackgroundTaskHost.exe") || Image.endsWith("\devenv.exe")
    || Image.endsWith("\iexplore.exe") || Image.endsWith("\MicrosoftEdge.exe") ||
    Image.endsWith("\Microsoft\Edge\Application\msedge.exe") || Image.endsWith("\AppData\Local\Microsoft\OneDrive\OneDrive.exe")
    || Image.endsWith("\msedgewebview2.exe")) || (Image.startsWith("C:\Program Files
    (x86)\Microsoft\EdgeWebView\Application\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"50f852e6-af22-4c78-9ede-42ef36aa3453_sysmon_ot"'
  description: Abusing Azure Browser SSO
- id: eval
  filter: (EventID=="7" && (Description=="System.Management.Automation" && ImageLoaded.includes("System.Management.Automation"))
    &&  ! ((Image.endsWith("\powershell.exe") || Image.endsWith("\mscorsvw.exe"))
    || (Image.startsWith("C:\Program Files (x86)\Microsoft Visual Studio\\") || Image.startsWith("C:\Program
    Files\Microsoft Visual Studio\\") || Image.startsWith("C:\Windows\System32\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fe6e002f-f244-4278-9263-20e4b593827f_sysmon_ot"'
  description: Alternate PowerShell Hosts
- id: eval
  filter: (EventID=="7" && Image=="C:\Windows\ADFS\version.dll")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"640dc51c-7713-4faa-8a0e-e7c0d9d4654c_sysmon_ot"'
  description: FoggyWeb Backdoor DLL Loading
- id: eval
  filter: (EventID=="7" && (ImageLoaded.endsWith("\System.Management.Automation.Dll")
    || ImageLoaded.endsWith("\System.Management.Automation.ni.Dll")) &&  ! ((Image.endsWith("\powershell.exe")
    || Image.endsWith("\powershell_ise.exe") || Image.endsWith("\WINDOWS\System32\sdiagnhost.exe")
    || Image.endsWith("\mscorsvw.exe") || Image.endsWith("\WINDOWS\System32\RemoteFXvGPUDisablement.exe")
    || Image.endsWith("\sqlps.exe") || Image.endsWith("\wsmprovhost.exe") || Image.endsWith("\winrshost.exe")
    || Image.endsWith("\syncappvpublishingserver.exe") || Image.endsWith("\runscripthelper.exe")
    || Image.endsWith("\ServerManager.exe") || Image.endsWith("\Microsoft SQL Server
    Management Studio *\Common*\IDE\Ssms.exe") || Image.endsWith("\IDE\devenv.exe")
    || Image.endsWith("\ServiceHub.VSDetouredHost.exe") || Image.endsWith("\ServiceHub.SettingsHost.exe")
    || Image.endsWith("\ServiceHub.Host.CLR.x86.exe")) || (Image.startsWith("C:\Program
    Files (x86)\Microsoft Visual Studio\\") || Image.startsWith("C:\Program Files\Microsoft
    Visual Studio\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"092bc4b9-3d1d-43b4-a6b4-8c8acd83522f_sysmon_ot"'
  description: In-memory PowerShell
- id: eval
  filter: (EventID=="7" && ImageLoaded.includes("\AppData\Local\Temp\ba9ea7344a4a5f591d6e5dc32a13494b\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"84b0a8f3-680b-4096-a45b-e9a89221727c_sysmon_ot"'
  description: PCRE.NET Package Image Load
- id: eval
  filter: (EventID=="7" && Image.endsWith("\scrcons.exe") && (ImageLoaded.endsWith("\vbscript.dll")
    || ImageLoaded.endsWith("\wbemdisp.dll") || ImageLoaded.endsWith("\wshom.ocx")
    || ImageLoaded.endsWith("\scrrun.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b439f47d-ef52-4b29-9a2f-57d8a96cb6b8_sysmon_ot"'
  description: WMI Script Host Process Image Loaded
- id: eval
  filter: (EventID=="7" && Image.endsWith("spoolsv.exe") && ImageLoaded.includes("\Windows\System32\spool\drivers\x64\3\\")
    && ImageLoaded.endsWith(".dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"02fb90de-c321-4e63-a6b9-25f4b03dfd14_sysmon_ot"'
  description: Windows Spooler Service Suspicious Binary Load
- id: eval
  filter: (EventID=="7" && (((ImageLoaded.endsWith("\dbghelp.dll") || ImageLoaded.endsWith("\dbgcore.dll"))
    && ((Image.endsWith("\msbuild.exe") || Image.endsWith("\cmd.exe") || Image.endsWith("\svchost.exe")
    || Image.endsWith("\rundll32.exe") || Image.endsWith("\powershell.exe") || Image.endsWith("\word.exe")
    || Image.endsWith("\excel.exe") || Image.endsWith("\powerpnt.exe") || Image.endsWith("\outlook.exe")
    || Image.endsWith("\monitoringhost.exe") || Image.endsWith("\wmic.exe") || Image.endsWith("\bash.exe")
    || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe") || Image.endsWith("\mshta.exe")
    || Image.endsWith("\regsvr32.exe") || Image.endsWith("\schtasks.exe") || Image.endsWith("\dnx.exe")
    || Image.endsWith("\regsvcs.exe") || Image.endsWith("\sc.exe") || Image.endsWith("\scriptrunner.exe"))
    || Signed=="FALSE")) &&  ! (Image.includes("Visual Studio") || (CommandLine.includes("-k
    LocalSystemNetworkRestricted") || CommandLine.includes("-k UnistackSvcGroup -s
    WpnUserService")))) &&  ! ((CommandLine=="C:\WINDOWS\winsxs\*\TiWorker.exe -Embedding"
    || CommandLine=="C:\Windows\system32\svchost.exe -k netsvcs -p -s wuauserv")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0e277796-5f23-4e49-a490-483131d4f6e1_sysmon_ot"'
  description: Load of dbghelp/dbgcore DLL from Suspicious Process
- id: eval
  filter: (EventID=="7" && ((Image.endsWith("fxssvc.exe")) && (ImageLoaded.endsWith("ualapi.dll")))
    &&  ! ((ImageLoaded.startsWith("C:\Windows\WinSxS\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"828af599-4c53-4ed2-ba4a-a9f835c434ea_sysmon_ot"'
  description: Fax Service DLL Search Order Hijack
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\notepad.exe")) && (ImageLoaded.endsWith("\samlib.dll")
    || ImageLoaded.endsWith("\WinSCard.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e32ce4f5-46c6-4c47-ba69-5de3c9193cd7_sysmon_ot"'
  description: Possible Process Hollowing Image Loading
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\winword.exe") || Image.endsWith("\powerpnt.exe")
    || Image.endsWith("\excel.exe") || Image.endsWith("\outlook.exe")) && (ImageLoaded.startsWith("C:\Windows\assembly\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ff0f2b05-09db-4095-b96d-1b75ca24894a_sysmon_ot"'
  description: dotNET DLL Loaded Via Office Applications
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\winword.exe") || Image.endsWith("\powerpnt.exe")
    || Image.endsWith("\excel.exe") || Image.endsWith("\outlook.exe")) && (ImageLoaded.includes("\clr.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d13c43f0-f66b-4279-8b2c-5912077c1780_sysmon_ot"'
  description: CLR DLL Loaded Via Office Applications
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\winword.exe") || Image.endsWith("\powerpnt.exe")
    || Image.endsWith("\excel.exe") || Image.endsWith("\outlook.exe")) && (ImageLoaded.startsWith("C:\Windows\Microsoft.NET\assembly\GAC_MSIL")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"90217a70-13fc-48e4-b3db-0d836c5824ac_sysmon_ot"'
  description: GAC DLL Loaded Via Office Applications
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\winword.exe") || Image.endsWith("\powerpnt.exe")
    || Image.endsWith("\excel.exe") || Image.endsWith("\outlook.exe")) && (ImageLoaded.includes("\dsparse.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a2a3b925-7bb0-433b-b508-db9003263cc4_sysmon_ot"'
  description: Active Directory Parsing DLL Loaded Via Office Applications
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\winword.exe") || Image.endsWith("\powerpnt.exe")
    || Image.endsWith("\excel.exe") || Image.endsWith("\outlook.exe")) && (ImageLoaded.endsWith("\kerberos.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7417e29e-c2e7-4cf6-a2e8-767228c64837_sysmon_ot"'
  description: Active Directory Kerberos DLL Loaded Via Office Applications
- id: eval
  filter: (EventID=="7" && Description=="Python Core" &&  ! ((Image.includes("Python"))
    || (Image.startsWith("C:\Program Files\\") || Image.startsWith("C:\Program Files
    (x86)\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cbb56d62-4060-40f7-9466-d8aaf3123f83_sysmon_ot"'
  description: Python Py2Exe Image Load
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\mshta.exe")) && (ImageLoaded.endsWith("\clr.dll") || ImageLoaded.endsWith("\mscoree.dll")
    || ImageLoaded.endsWith("\mscorlib.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4508a70e-97ef-4300-b62b-ff27992990ea_sysmon_ot"'
  description: CLR DLL Loaded Via Scripting Applications
- id: eval
  filter: (EventID=="7" && ImageLoaded.endsWith("\System.Drawing.ni.dll") &&  ! (((Image.startsWith("C:\Program
    Files\\") || Image.startsWith("C:\Program Files (x86)\\") || Image.startsWith("C:\Windows\System32\\")
    || Image.startsWith("C:\Windows\Microsoft.NET\\") || Image.startsWith("C:\Windows\ImmersiveControlPanel\\")))
    || ((Image=="C:\Users\\*\AppData\Local\NhNotifSys\nahimic\nahimicNotifSys.exe"
    || Image=="C:\Users\\*\GitHubDesktop\Update.exe" || Image=="C:\Windows\System32\NhNotifSys.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"666ecfc7-229d-42b8-821e-1a8f8cb7057c_sysmon_ot"'
  description: Suspicious System.Drawing Load
- id: eval
  filter: (EventID=="7" && (Image.endsWith("\winword.exe") || Image.endsWith("\powerpnt.exe")
    || Image.endsWith("\excel.exe") || Image.endsWith("\outlook.exe")) && (ImageLoaded.endsWith("\VBE7.DLL")
    || ImageLoaded.endsWith("\VBEUI.DLL") || ImageLoaded.endsWith("\VBE7INTL.DLL")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e6ce8457-68b1-485b-9bdd-3c2b5d679aa9_sysmon_ot"'
  description: VBA DLL Loaded Via Microsoft Word
- id: eval
  filter: (EventID=="7" && ((Image.endsWith("\svchost.exe")) && (ImageLoaded.endsWith("\tsmsisrv.dll")
    || ImageLoaded.endsWith("\tsvipsrv.dll") || ImageLoaded.endsWith("\wlbsctrl.dll")))
    &&  ! ((ImageLoaded.startsWith("C:\Windows\WinSxS\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"602a1f13-c640-4d73-b053-be9a2fa58b77_sysmon_ot"'
  description: Svchost DLL Search Order Hijack
- id: eval
  filter: (EventID=="7" && (ImageLoaded.endsWith("\ttdrecord.dll") || ImageLoaded.endsWith("\ttdwriter.dll")
    || ImageLoaded.endsWith("\ttdloader.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e76c8240-d68f-4773-8880-5c6f63595aaf_sysmon_ot"'
  description: Time Travel Debugging Utility Usage
- id: eval
  filter: (EventID=="7" && ((Image.endsWith("\dism.exe")) && (ImageLoaded.endsWith("\dismcore.dll")))
    &&  ! ((ImageLoaded=="C:\Windows\System32\Dism\dismcore.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a5ea83a7-05a5-44c1-be2e-addccbbd8c03_sysmon_ot"'
  description: UAC Bypass With Fake DLL
- id: eval
  filter: (EventID=="7" && ((ImageLoaded.endsWith("\credui.dll") || ImageLoaded.endsWith("\wincredui.dll"))
    || (OriginalFileName=="credui.dll" || OriginalFileName=="wincredui.dll")) &&  !
    ((Image.startsWith("C:\Windows\System32\\") || Image.startsWith("C:\Windows\explorer.exe")
    || Image.startsWith("C:\Program Files\\") || Image.startsWith("C:\Users\\*\AppData\Local\Microsoft\OneDrive\\*\Microsoft.SharePoint.exe")
    || Image.startsWith("C:\Program Files (x86)\\") || Image.startsWith("C:\Windows\ImmersiveControlPanel\SystemSettings.exe")
    || Image.startsWith("C:\Users\\*\AppData\Local\Microsoft\OneDrive\OneDrive.exe"))
    || Image.endsWith("\opera_autoupdate.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9ae01559-cf7e-4f8e-8e14-4c290a1b4784_sysmon_ot"'
  description: UIPromptForCredentials DLLs
- id: eval
  filter: (EventID=="7" && Image.endsWith("\lsass.exe") && Signed=="false")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"857c8db3-c89b-42fb-882b-f681c7cf4da2_sysmon_ot"'
  description: Unsigned Image Loaded Into LSASS Process
- id: eval
  filter: (EventID=="7" && Image.endsWith("\wmic.exe") && (ImageLoaded.endsWith("\jscript.dll")
    || ImageLoaded.endsWith("\vbscript.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"06ce37c2-61ab-4f05-9ff5-b1a96d18ae32_sysmon_ot"'
  description: WMIC Loading Scripting Libraries
- id: eval
  filter: (EventID=="7" && ((ImageLoaded.endsWith("\wmiclnt.dll") || ImageLoaded.endsWith("\WmiApRpl.dll")
    || ImageLoaded.endsWith("\wmiprov.dll") || ImageLoaded.endsWith("\wmiutils.dll")
    || ImageLoaded.endsWith("\wbemcomn.dll") || ImageLoaded.endsWith("\wbemprox.dll")
    || ImageLoaded.endsWith("\WMINet_Utils.dll") || ImageLoaded.endsWith("\wbemsvc.dll")
    || ImageLoaded.endsWith("\fastprox.dll")) &&  ! ((Image.endsWith("\WmiPrvSE.exe")
    || Image.endsWith("\WmiApSrv.exe") || Image.endsWith("\svchost.exe") || Image.endsWith("\DeviceCensus.exe")
    || Image.endsWith("\CompatTelRunner.exe") || Image.endsWith("\sdiagnhost.exe")
    || Image.endsWith("\SIHClient.exe") || Image.endsWith("\ngentask.exe") || Image.endsWith("\windows\system32\taskhostw.exe")
    || Image.endsWith("\windows\system32\MoUsoCoreWorker.exe") || Image.endsWith("\windows\system32\wbem\WMIADAP.exe")
    || Image.endsWith("C:\Windows\Sysmon64.exe") || Image.endsWith("C:\Windows\Sysmon.exe")
    || Image.endsWith("C:\Windows\System32\wbem\unsecapp.exe") || Image.endsWith("\logman.exe")
    || Image.endsWith("\systeminfo.exe") || Image.endsWith("\nvcontainer.exe") ||
    Image.endsWith("C:\Windows\System32\wbem\WMIC.exe") || Image.endsWith("\explorer.exe")
    || Image.endsWith("\opera_autoupdate.exe") || Image.endsWith("\MsMpEng.exe") ||
    Image.endsWith("\thor64.exe") || Image.endsWith("\thor.exe")))) &&  ! ((Image.startsWith("C:\Program
    Files\\") || Image.startsWith("C:\Program Files (x86)\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"671bb7e3-a020-4824-a00e-2ee5b55f385e_sysmon_ot"'
  description: WMI Modules Loaded
- id: eval
  filter: (EventID=="7" && Image=="C:\Windows\System32\wbem\WmiPrvSE.exe" && ImageLoaded.endsWith("\wbemcons.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"05936ce2-ee05-4dae-9d03-9a391cf2d2c6_sysmon_ot"'
  description: WMI Persistence - Command Line Event Consumer
- id: eval
  filter: (EventID=="7" && (ImageLoaded.endsWith("\vss_ps.dll")) &&  ! ((Image.endsWith("\svchost.exe")
    || Image.endsWith("\msiexec.exe") || Image.endsWith("\vssvc.exe") || Image.endsWith("\srtasks.exe")
    || Image.endsWith("\tiworker.exe") || Image.endsWith("\dllhost.exe") || Image.endsWith("\searchindexer.exe")
    || Image.endsWith("dismhost.exe") || Image.endsWith("taskhostw.exe") || Image.endsWith("\clussvc.exe"))
    && Image.includes("c:\windows\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"333cdbe8-27bb-4246-bf82-b41a0dca4b70_sysmon_ot"'
  description: Image Load of VSS_PS.dll by Uncommon Executable
- id: eval
  filter: (EventID=="7" && Image.endsWith("\svchost.exe") && ImageLoaded.endsWith("\clfsw32.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"33a2d1dd-f3b0-40bd-8baf-7974468927cc_sysmon_ot"'
  description: APT PRIVATELOG Image Load Pattern
- id: eval
  filter: (EventID=="3" && Image.endsWith("\msbuild.exe") && (DestinationPort=="80"
    || DestinationPort=="443") && Initiated=="true")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"50e54b8d-ad73-43f8-96a1-5191685b17a4_sysmon_ot"'
  description: Silenttrinity Stager Msbuild Activity
- id: eval
  filter: (EventID=="3" && (Image.endsWith("\dllhost.exe") && Initiated=="true") &&  !
    (((DestinationIp.startsWith("10.") || DestinationIp.startsWith("192.168.") ||
    DestinationIp.startsWith("172.16.") || DestinationIp.startsWith("172.17.") ||
    DestinationIp.startsWith("172.18.") || DestinationIp.startsWith("172.19.") ||
    DestinationIp.startsWith("172.20.") || DestinationIp.startsWith("172.21.") ||
    DestinationIp.startsWith("172.22.") || DestinationIp.startsWith("172.23.") ||
    DestinationIp.startsWith("172.24.") || DestinationIp.startsWith("172.25.") ||
    DestinationIp.startsWith("172.26.") || DestinationIp.startsWith("172.27.") ||
    DestinationIp.startsWith("172.28.") || DestinationIp.startsWith("172.29.") ||
    DestinationIp.startsWith("172.30.") || DestinationIp.startsWith("172.31."))) ||
    ((DestinationIp=="0:0:0:0:0:0:0:1"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cfed2f44-16df-4bf3-833a-79405198b277_sysmon_ot"'
  description: Dllhost Internet Connection
- id: eval
  filter: (EventID=="3" && (Image.endsWith("\excel.exe") && Initiated=="true" && DestinationIsIpv6=="false")
    &&  ! ((DestinationIp.startsWith("10.") || DestinationIp.startsWith("192.168.")
    || DestinationIp.startsWith("172.16.") || DestinationIp.startsWith("172.17.")
    || DestinationIp.startsWith("172.18.") || DestinationIp.startsWith("172.19.")
    || DestinationIp.startsWith("172.20.") || DestinationIp.startsWith("172.21.")
    || DestinationIp.startsWith("172.22.") || DestinationIp.startsWith("172.23.")
    || DestinationIp.startsWith("172.24.") || DestinationIp.startsWith("172.25.")
    || DestinationIp.startsWith("172.26.") || DestinationIp.startsWith("172.27.")
    || DestinationIp.startsWith("172.28.") || DestinationIp.startsWith("172.29.")
    || DestinationIp.startsWith("172.30.") || DestinationIp.startsWith("172.31.")
    || DestinationIp.startsWith("127.0.0.1")) && DestinationIsIpv6=="false"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84_sysmon_ot"'
  description: Excel Network Connections
- id: eval
  filter: (EventID=="3" && (Initiated=="true" && (DestinationPort=="4443" || DestinationPort=="2448"
    || DestinationPort=="8143" || DestinationPort=="1777" || DestinationPort=="1443"
    || DestinationPort=="243" || DestinationPort=="65535" || DestinationPort=="13506"
    || DestinationPort=="3360" || DestinationPort=="200" || DestinationPort=="198"
    || DestinationPort=="49180" || DestinationPort=="13507" || DestinationPort=="6625"
    || DestinationPort=="4444" || DestinationPort=="4438" || DestinationPort=="1904"
    || DestinationPort=="13505" || DestinationPort=="13504" || DestinationPort=="12102"
    || DestinationPort=="9631" || DestinationPort=="5445" || DestinationPort=="2443"
    || DestinationPort=="777" || DestinationPort=="13394" || DestinationPort=="13145"
    || DestinationPort=="12103" || DestinationPort=="5552" || DestinationPort=="3939"
    || DestinationPort=="3675" || DestinationPort=="666" || DestinationPort=="473"
    || DestinationPort=="5649" || DestinationPort=="4455" || DestinationPort=="4433"
    || DestinationPort=="1817" || DestinationPort=="100" || DestinationPort=="65520"
    || DestinationPort=="1960" || DestinationPort=="1515" || DestinationPort=="743"
    || DestinationPort=="700" || DestinationPort=="14154" || DestinationPort=="14103"
    || DestinationPort=="14102" || DestinationPort=="12322" || DestinationPort=="10101"
    || DestinationPort=="7210" || DestinationPort=="4040" || DestinationPort=="9943"))
    &&  ! ((Image.includes("\Program Files") || ((DestinationIp.startsWith("10.")
    || DestinationIp.startsWith("192.168.") || DestinationIp.startsWith("172.16.")
    || DestinationIp.startsWith("172.17.") || DestinationIp.startsWith("172.18.")
    || DestinationIp.startsWith("172.19.") || DestinationIp.startsWith("172.20.")
    || DestinationIp.startsWith("172.21.") || DestinationIp.startsWith("172.22.")
    || DestinationIp.startsWith("172.23.") || DestinationIp.startsWith("172.24.")
    || DestinationIp.startsWith("172.25.") || DestinationIp.startsWith("172.26.")
    || DestinationIp.startsWith("172.27.") || DestinationIp.startsWith("172.28.")
    || DestinationIp.startsWith("172.29.") || DestinationIp.startsWith("172.30.")
    || DestinationIp.startsWith("172.31.") || DestinationIp.startsWith("127.")) &&
    DestinationIsIpv6=="false"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4b89abaa-99fe-4232-afdd-8f9aa4d20382_sysmon_ot"'
  description: Suspicious Typical Malware Back Connect Ports
- id: eval
  filter: (EventID=="3" && Image.endsWith("\notepad.exe") &&  ! (DestinationPort=="9100"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e81528db-fc02-45e8-8e98-4e84aba1f10b_sysmon_ot"'
  description: Notepad Making Network Connection
- id: eval
  filter: (EventID=="3" && (Image.endsWith("\powershell.exe") && Initiated=="true"
    && DestinationIsIpv6=="false") &&  ! ((DestinationIp.startsWith("10.") || DestinationIp.startsWith("192.168.")
    || DestinationIp.startsWith("172.16.") || DestinationIp.startsWith("172.17.")
    || DestinationIp.startsWith("172.18.") || DestinationIp.startsWith("172.19.")
    || DestinationIp.startsWith("172.20.") || DestinationIp.startsWith("172.21.")
    || DestinationIp.startsWith("172.22.") || DestinationIp.startsWith("172.23.")
    || DestinationIp.startsWith("172.24.") || DestinationIp.startsWith("172.25.")
    || DestinationIp.startsWith("172.26.") || DestinationIp.startsWith("172.27.")
    || DestinationIp.startsWith("172.28.") || DestinationIp.startsWith("172.29.")
    || DestinationIp.startsWith("172.30.") || DestinationIp.startsWith("172.31.")
    || DestinationIp.startsWith("127.0.0.1")) && User=="NT AUTHORITY\SYSTEM" && User.includes("AUT")
    && User.includes(" NT")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1f21ec3f-810d-4b0e-8045-322202e22b4b_sysmon_ot"'
  description: PowerShell Network Connections
- id: eval
  filter: (EventID=="3" && (Image.endsWith("\svchost.exe") && Initiated=="true" &&
    SourcePort=="3389") && ((DestinationIp.startsWith("127.")) || (DestinationIp=="::1")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5f699bc5-5446-4a4a-a0b7-5ef2885a3eb4_sysmon_ot"'
  description: RDP Over Reverse SSH Tunnel
- id: eval
  filter: (EventID=="3" && Image.endsWith("\regsvr32.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c7e91a02-d771-4a6d-a700-42587e0b1095_sysmon_ot"'
  description: Regsvr32 Network Activity
- id: eval
  filter: (EventID=="3" && (DestinationPort=="5985" || DestinationPort=="5986") &&  !
    (User=="NT AUTHORITY\NETWORK SERVICE"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c539afac-c12a-46ed-b1bd-5a5567c9f045_sysmon_ot"'
  description: Remote PowerShell Session
- id: eval
  filter: (EventID=="3" && (Image.endsWith("\rundll32.exe") && Initiated=="true")
    &&  ! (((DestinationIp.startsWith("10.") || DestinationIp.startsWith("192.168.")
    || DestinationIp.startsWith("172.16.") || DestinationIp.startsWith("172.17.")
    || DestinationIp.startsWith("172.18.") || DestinationIp.startsWith("172.19.")
    || DestinationIp.startsWith("172.20.") || DestinationIp.startsWith("172.21.")
    || DestinationIp.startsWith("172.22.") || DestinationIp.startsWith("172.23.")
    || DestinationIp.startsWith("172.24.") || DestinationIp.startsWith("172.25.")
    || DestinationIp.startsWith("172.26.") || DestinationIp.startsWith("172.27.")
    || DestinationIp.startsWith("172.28.") || DestinationIp.startsWith("172.29.")
    || DestinationIp.startsWith("172.30.") || DestinationIp.startsWith("172.31.")
    || DestinationIp.startsWith("127.")) || (CommandLine.includes("PcaSvc.dll,PcaPatchSdbTask")))
    || ((DestinationIp.startsWith("51.124.")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cdc8da7d-c303-42f8-b08c-b4ab47230263_sysmon_ot"'
  description: Rundll32 Internet Connection
- id: eval
  filter: (EventID=="3" && (DestinationPort=="88" && Initiated=="true") &&  ! ((Image.endsWith("\lsass.exe")
    || Image.endsWith("\opera.exe") || Image.endsWith("\chrome.exe") || Image.endsWith("\firefox.exe")
    || Image.endsWith("\tomcat\bin\tomcat8.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e54979bd-c5f9-4d6c-967b-a04b19ac4c74_sysmon_ot"'
  description: Suspicious Outbound Kerberos Connection
- id: eval
  filter: (EventID=="3" && ((Image.includes("\Users\All Users\\") || Image.includes("\Users\Default\\")
    || Image.includes("\Users\Public\\") || Image.includes("\Users\Contacts\\") ||
    Image.includes("\Users\Searches\\") || Image.includes("\config\systemprofile\\")
    || Image.includes("\Windows\Fonts\\") || Image.includes("\Windows\IME\\") || Image.includes("\Windows\addins\\"))
    || (Image.endsWith("\$Recycle.bin")) || (Image.startsWith("C:\Perflogs\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7b434893-c57d-4f41-908d-6a17bf1ae98f_sysmon_ot"'
  description: Suspicious Program Location with Network Connections
- id: eval
  filter: (EventID=="3" && (DestinationPort=="3389" && Initiated=="true") &&  ! ((Image.endsWith("\mstsc.exe")
    || Image.endsWith("\RTSApp.exe") || Image.endsWith("\RTS2App.exe") || Image.endsWith("\RDCMan.exe")
    || Image.endsWith("\ws_TunnelService.exe") || Image.endsWith("\RSSensor.exe")
    || Image.endsWith("\RemoteDesktopManagerFree.exe") || Image.endsWith("\RemoteDesktopManager.exe")
    || Image.endsWith("\RemoteDesktopManager64.exe") || Image.endsWith("\mRemoteNG.exe")
    || Image.endsWith("\mRemote.exe") || Image.endsWith("\Terminals.exe") || Image.endsWith("\spiceworks-finder.exe")
    || Image.endsWith("\FSDiscovery.exe") || Image.endsWith("\FSAssessment.exe") ||
    Image.endsWith("\MobaRTE.exe") || Image.endsWith("\chrome.exe") || Image.endsWith("\System32\dns.exe")
    || Image.endsWith("\thor.exe") || Image.endsWith("\thor64.exe") || Image.endsWith("\Passwordstate.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ed74fe75-7594-4b4b-ae38-e38e3fd2eb23_sysmon_ot"'
  description: Suspicious Outbound RDP Connections
- id: eval
  filter: (EventID=="3" && Initiated=="true" && (DestinationHostname.endsWith(".github.com")
    || DestinationHostname.endsWith(".githubusercontent.com")) && Image.startsWith("C:\Windows\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"635dbb88-67b3-4b41-9ea5-a3af2dd88153_sysmon_ot"'
  description: Microsoft Binary Github Communication
- id: eval
  filter: (EventID=="3" && Initiated=="true" && (DestinationHostname.endsWith("dl.dropboxusercontent.com")
    || DestinationHostname.endsWith(".pastebin.com") || DestinationHostname.endsWith(".githubusercontent.com"))
    && Image.startsWith("C:\Windows\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97_sysmon_ot"'
  description: Microsoft Binary Suspicious Communication Endpoint
- id: eval
  filter: (EventID=="3" && Image.includes("wuauclt"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c649a6c7-cd8c-4a78-9c04-000fc76df954_sysmon_ot"'
  description: Wuauclt Network Connection
- id: eval
  filter: (EventID=="3" && Initiated=="true" && Image.endsWith("\IMEWDBLD.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8d7e392e-9b28-49e1-831d-5949c6281228_sysmon_ot"'
  description: Download a File with IMEWDBLD.exe
- id: eval
  filter: (EventID=="3" && Initiated=="true" && Image.endsWith("\msiexec.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8e5e38e4-5350-4c0b-895a-e872ce0dd54f_sysmon_ot"'
  description: Msiexec Initiated Connection
- id: eval
  filter: (EventID=="3" && ((DestinationPort=="25" || DestinationPort=="587" || DestinationPort=="465"
    || DestinationPort=="2525") && Initiated=="true") &&  ! ((Image.endsWith("\thunderbird.exe")
    || Image.endsWith("\outlook.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9976fa64-2804-423c-8a5b-646ade840773_sysmon_ot"'
  description: Suspicious Outbound SMTP Connections
- id: eval
  filter: (EventID=="3" && (DestinationHostname=="pool.minexmr.com" || DestinationHostname=="fr.minexmr.com"
    || DestinationHostname=="de.minexmr.com" || DestinationHostname=="sg.minexmr.com"
    || DestinationHostname=="ca.minexmr.com" || DestinationHostname=="us-west.minexmr.com"
    || DestinationHostname=="pool.supportxmr.com" || DestinationHostname=="mine.c3pool.com"
    || DestinationHostname=="xmr-eu1.nanopool.org" || DestinationHostname=="xmr-eu2.nanopool.org"
    || DestinationHostname=="xmr-us-east1.nanopool.org" || DestinationHostname=="xmr-us-west1.nanopool.org"
    || DestinationHostname=="xmr-asia1.nanopool.org" || DestinationHostname=="xmr-jp1.nanopool.org"
    || DestinationHostname=="xmr-au1.nanopool.org" || DestinationHostname=="xmr.2miners.com"
    || DestinationHostname=="xmr.hashcity.org" || DestinationHostname=="xmr.f2pool.com"
    || DestinationHostname=="xmrpool.eu" || DestinationHostname=="pool.hashvault.pro"
    || DestinationHostname=="moneroocean.stream" || DestinationHostname=="monerocean.stream"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fa5b1358-b040-4403-9868-15f7d9ab6329_sysmon_ot"'
  description: Windows Crypto Mining Pool Connections
- id: eval
  filter: (EventID=="3" && Initiated=="true" && DestinationHostname.endsWith("api.mega.co.nz"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fdeebdf0-9f3f-4d08-84a6-4c4d13e39fe4_sysmon_ot"'
  description: Communication To Mega.nz
- id: eval
  filter: (EventID=="3" && Initiated=="true" && Image.includes("python"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bef0bc5a-b9ae-425d-85c6-7b2d705980c6_sysmon_ot"'
  description: Python Initiated Connection
- id: eval
  filter: ((EventID=="17" || EventID=="18") && PipeName=="\PSEXESVC")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f3f3a972-f982-40ad-b63c-bca6afdfad7c_sysmon_ot"'
  description: PsExec Tool Execution
- id: eval
  filter: ((EventID=="17" || EventID=="18") && PipeName.startsWith("\PSHost") &&  !
    (((Image.endsWith("\powershell.exe") || Image.endsWith("\powershell_ise.exe")
    || Image.endsWith("\WINDOWS\System32\sdiagnhost.exe") || Image.endsWith("\WINDOWS\System32\wsmprovhost.exe")
    || Image.endsWith("\Windows\system32\dsac.exe") || Image.endsWith("\Windows\system32\wbem\wmiprvse.exe")))
    || (Image ===null ) || (Image.includes(":\Program Files") && Image.includes("\Microsoft
    SQL Server\\") && Image.endsWith("\Tools\Binn\SQLPS.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"58cb02d5-78ce-4692-b3e1-dce850aae41a_sysmon_ot"'
  description: Alternate PowerShell Hosts Pipe
- id: eval
  filter: ((EventID=="17" || EventID=="18") && (PipeName=="\atctl" || PipeName=="\userpipe"
    || PipeName=="\iehelper" || PipeName=="\sdlrpc" || PipeName=="\comnap"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"739915e4-1e70-4778-8b8a-17db02f66db1_sysmon_ot"'
  description: Turla Group Named Pipes
- id: eval
  filter: ((EventID=="17" || EventID=="18") && (PipeName.includes("\lsadump") || PipeName.includes("\cachedump")
    || PipeName.includes("\wceservicepipe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"961d0ba2-3eea-4303-a930-2cf78bbfcc5e_sysmon_ot"'
  description: Cred Dump-Tools Named Pipes
- id: eval
  filter: ((EventID=="17" || EventID=="18") && (PipeName.includes("\pipe\\") || PipeName.includes("\pipe\srvsvc")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"637f689e-b4a5-4a86-be0e-0100a0a33ba2_sysmon_ot"'
  description: EfsPotato Named Pipe
- id: eval
  filter: ((EventID=="17" || EventID=="18") && ((PipeName.includes("\MSSE-") && PipeName.includes("-server"))
    || PipeName.startsWith("\postex_") || PipeName.startsWith("\postex_ssh_") || PipeName.startsWith("\status_")
    || PipeName.startsWith("\msagent_")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d5601f8c-b26f-4ab0-9035-69e11a8d4ad2_sysmon_ot"'
  description: CobaltStrike Named Pipe
- id: eval
  filter: ((EventID=="17" || EventID=="18") && (PipeName=="\isapi_http" || PipeName=="\isapi_dg"
    || PipeName=="\isapi_dg2" || PipeName=="\sdlrpc" || PipeName=="\ahexec" || PipeName=="\winsession"
    || PipeName=="\lsassw" || PipeName=="\46a676ab7f179e511e30dd2dc41bd388" || PipeName=="\9f81f59bc58452127884ce513865ed20"
    || PipeName=="\e710f28d59aa529d6792ca6ff0ca1b34" || PipeName=="\rpchlp_3" || PipeName=="\NamePipe_MoreWindows"
    || PipeName=="\pcheap_reuse" || PipeName=="\gruntsvc" || PipeName=="\583da945-62af-10e8-4902-a8f205c72b2e"
    || PipeName=="\bizkaz" || PipeName=="\svcctl" || PipeName.startsWith("\Posh")
    || PipeName=="\jaccdpqnvbrrxlaf" || PipeName=="\csexecsvc" || PipeName=="\6e7645c4-32c5-4fe3-aabf-e94c2f4370e7"
    || PipeName=="\adschemerpc" || PipeName=="\AnonymousPipe" || PipeName=="\bc367"
    || PipeName=="\bc31a7" || PipeName=="\testPipe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fe3ac066-98bb-432a-b1e7-a5229cb39d4a_sysmon_ot"'
  description: Malicious Named Pipe
- id: eval
  filter: ((EventID=="17" || EventID=="18") && PipeName.startsWith("\PSHost"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ac7102b4-9e1e-4802-9b4f-17c5524c015c_sysmon_ot"'
  description: T1086 PowerShell Execution
- id: eval
  filter: ((EventID=="17" || EventID=="18") && (PipeName.startsWith("psexec") || PipeName.startsWith("paexec")
    || PipeName.startsWith("remcom") || PipeName.startsWith("csexec")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9e77ed63-2ecf-4c7b-b09d-640834882028_sysmon_ot"'
  description: PsExec Pipes Artifacts
- id: eval
  filter: ((EventID=="17" || EventID=="18") && PipeName=="\MICROSOFT##WID\tsql\query"
    &&  ! ((Image.endsWith("Microsoft.IdentityServer.ServiceHost.exe") || Image.endsWith("Microsoft.Identity.Health.Adfs.PshSurrogate.exe")
    || Image.endsWith("AzureADConnect.exe") || Image.endsWith("Microsoft.Tri.Sensor.exe")
    || Image.endsWith("wsmprovhost.exe") || Image.endsWith("mmc.exe") || Image.endsWith("sqlservr.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3_sysmon_ot"'
  description: ADFS Database Named Pipe Connection
- id: eval
  filter: ((EventID=="17" || EventID=="18") && (((PipeName.startsWith("\mojo.5688.8052.183894939787088877")
    || PipeName.startsWith("\mojo.5688.8052.35780273329370473") || PipeName.startsWith("\mypipe-f")
    || PipeName.startsWith("\mypipe-h") || PipeName.startsWith("\ntsvcs") || PipeName.startsWith("\scerpc")
    || PipeName.startsWith("\win_svc") || PipeName.startsWith("\spoolss") || PipeName.startsWith("\msrpc_")
    || PipeName.startsWith("\win\msrpc_") || PipeName.startsWith("\wkssvc") || PipeName.startsWith("\f53f")
    || PipeName.startsWith("\windows.update.manager") || PipeName.startsWith("\SearchTextHarvester")
    || PipeName.startsWith("\DserNamePipe") || PipeName.startsWith("\PGMessagePipe")
    || PipeName.startsWith("\MsFteWds") || PipeName.startsWith("\f4c3") || PipeName.startsWith("\fullduplex_")
    || PipeName.startsWith("\rpc_")) || (PipeName=="\demoagent_11" || PipeName=="\demoagent_22"))
    || (PipeName.startsWith("\Winsock2\CatalogChangeListener-") && PipeName.endsWith("-0,")))
    &&  ! ((PipeName=="\wkssvc" || PipeName=="\spoolss" || PipeName=="\scerpc" ||
    PipeName=="\ntsvcs" || PipeName=="\SearchTextHarvester" || PipeName=="\PGMessagePipe"
    || PipeName=="\MsFteWds")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"85adeb13-4fc9-4e68-8a4a-c7cb2c336eb7_sysmon_ot"'
  description: CobaltStrike Named Pipe Patterns
- id: eval
  filter: ((EventID=="17" || EventID=="18") && Image.endsWith("\scrcons.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"493fb4ab-cdcc-4c4f-818c-0e363bd1e4bb_sysmon_ot"'
  description: WMI Event Consumer Created Named Pipe
- id: eval
  filter: (EventID=="10" && CallTrace.includes("cmlua.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3b4b232a-af90-427c-a22f-30b0c0837b95_sysmon_ot"'
  description: CMSTP Execution Process Access
- id: eval
  filter: (EventID=="10" && (TargetImage.endsWith("\lsass.exe") && (GrantedAccess.startsWith("0x40")
    || GrantedAccess.startsWith("0x100000") || GrantedAccess.startsWith("0x1410")
    || GrantedAccess.startsWith("0x1438") || GrantedAccess.startsWith("0x143a") ||
    GrantedAccess.startsWith("0x1418") || GrantedAccess.startsWith("0x1f0fff") ||
    GrantedAccess.startsWith("0x1f1fff") || GrantedAccess.startsWith("0x1f2fff") ||
    GrantedAccess.startsWith("0x1f3fff"))) &&  ! (((SourceImage=="C:\WINDOWS\system32\taskmgr.exe"
    || SourceImage=="C:\Windows\System32\perfmon.exe")) || (SourceImage.startsWith("C:\ProgramData\Microsoft\Windows
    Defender\\") && SourceImage.endsWith("\MsMpEng.exe")) || (SourceImage.startsWith("C:\Program
    Files\WindowsApps\\") && SourceImage.endsWith("\GamingServices.exe") && (GrantedAccess=="0x1410"
    || GrantedAccess=="0x410")) || ((SourceImage.endsWith("\PROCEXP64.EXE") || SourceImage.endsWith("\PROCEXP.EXE")
    || SourceImage.endsWith("C:\WINDOWS\system32\taskhostw.exe")) && (GrantedAccess=="0x1410"
    || GrantedAccess=="0x410")) || (SourceImage.startsWith("C:\ProgramData\VMware\VMware
    Tools\\") && SourceImage.endsWith("\vmtoolsd.exe")) || (SourceImage=="C:\WINDOWS\system32\svchost.exe"
    && GrantedAccess=="0x100000") || ((SourceImage=="C:\WINDOWS\system32\wbem\wmiprvse.exe"
    || SourceImage=="C:\Windows\syswow64\MsiExec.exe" || SourceImage=="C:\Windows\System32\msiexec.exe")
    && (GrantedAccess=="0x1410" || GrantedAccess=="0x410")) || ((SourceImage.endsWith("\thor.exe")
    || SourceImage.endsWith("\thor64.exe")) && (GrantedAccess=="0x40" || GrantedAccess=="0x1010"))
    || (SourceImage.endsWith("\explorer.exe") && GrantedAccess=="0x401") || (SourceImage=="C:\Windows\system32\wininit.exe"
    && GrantedAccess=="0x1000000") || (SourceImage=="C:\Windows\system32\MRT.exe"
    && (GrantedAccess=="0x1410" || GrantedAccess=="0x1418")) || ((SourceImage.startsWith("C:\Program
    Files\\") || SourceImage.startsWith("C:\Program Files (x86)\\")) && (GrantedAccess=="0x1410"
    || GrantedAccess=="0x410")) || (SourceImage.startsWith("C:\Program Files (x86)\Microsoft\Edge\Application\\")
    && SourceImage.endsWith("\Installer\setup.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"32d0d3e2-e58d-4d41-926b-18b520b2b32d_sysmon_ot"'
  description: Credentials Dumping Tools Accessing LSASS Memory
- id: eval
  filter: (EventID=="10" && CallTrace.startsWith("UNKNOWN"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3f3f3506-1895-401b-9cc3-e86b16e630d0_sysmon_ot"'
  description: Direct Syscall of NtOpenProcess
- id: eval
  filter: (EventID=="10" && TargetImage.endsWith("\WINDOWS\System32\svchost.exe")
    && GrantedAccess=="0x1F3FFF" && CallTrace.includes("UNKNOWN"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"166e9c50-8cd9-44af-815d-d1f0c0e90dde_sysmon_ot"'
  description: Suspect Svchost Memory Asccess
- id: eval
  filter: (EventID=="10" && (((CallTrace.includes("C:\WINDOWS\SYSTEM32\ntdll.dll+")
    && CallTrace.includes("|C:\WINDOWS\System32\KERNELBASE.dll+") && CallTrace.includes("|UNKNOWN(")
    && CallTrace.includes(")")) || (CallTrace.includes("UNKNOWN(") && CallTrace.includes(")|UNKNOWN(")
    && CallTrace.endsWith(")"))) || (CallTrace.includes("UNKNOWN") && (GrantedAccess=="0x1F0FFF"
    || GrantedAccess=="0x1F1FFF" || GrantedAccess=="0x143A" || GrantedAccess=="0x1410"
    || GrantedAccess=="0x1010" || GrantedAccess=="0x1F2FFF" || GrantedAccess=="0x1F3FFF"
    || GrantedAccess=="0x1FFFFF"))) &&  ! (((SourceImage.endsWith("\Windows\System32\sdiagnhost.exe")
    || SourceImage.endsWith("\procexp64.exe") || SourceImage.endsWith("\procexp.exe")
    || SourceImage.endsWith("\Microsoft VS Code\Code.exe") || SourceImage.endsWith("\aurora-agent-64.exe")
    || SourceImage.endsWith("\aurora-agent.exe") || SourceImage.endsWith("\git\usr\bin\sh.exe")
    || SourceImage.endsWith("\IDE\devenv.exe") || SourceImage.endsWith("\GitHubDesktop\Update.exe")
    || SourceImage.endsWith("\RuntimeBroker.exe") || SourceImage.endsWith("\backgroundTaskHost.exe")
    || SourceImage.endsWith("\GitHubDesktop.exe")) || (SourceImage.startsWith("C:\Program
    Files (x86)\\") || SourceImage.startsWith("C:\Program Files\\") || SourceImage.startsWith("C:\Windows\Microsoft.NET\Framework\\*\NGenTask.exe")
    || SourceImage.startsWith("C:\Program Files (x86)\Microsoft Visual Studio\\")
    || SourceImage.startsWith("C:\Program Files\Microsoft Visual Studio\\") || SourceImage.startsWith("C:\Windows\Microsoft.NET\Framework")
    || SourceImage.startsWith("C:\WINDOWS\System32\DriverStore\\") || SourceImage.startsWith("C:\Windows\System32\WindowsPowerShell\\"))
    || (SourceImage=="C:\Users\\*\AppData\Local\Programs\Microsoft VS Code\Code.exe"
    || SourceImage=="C:\WINDOWS\system32\taskhostw.exe" || SourceImage=="C:\WINDOWS\system32\ctfmon.exe"
    || SourceImage=="C:\WINDOWS\system32\NhNotifSys.exe") || (TargetImage=="C:\Windows\System32\RuntimeBroker.exe")
    || (TargetImage.endsWith("\Microsoft VS Code\Code.exe")) || (CallTrace.includes("|C:\WINDOWS\System32\RPCRT4.dll+")))
    || ((SourceImage=="C:\WINDOWS\Explorer.EXE") && (TargetImage=="C:\WINDOWS\system32\backgroundTaskHost.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5f113a8f-8b61-41ca-b90f-d374fa7e4a39_sysmon_ot"'
  description: Suspicious In-Memory Module Execution
- id: eval
  filter: (EventID=="10" && TargetImage.endsWith("\lsass.exe") && CallTrace.includes("C:\\Windows\\SYSTEM32\\ntdll.dll+")
    && CallTrace.includes("|C:\\Windows\\System32\\KERNELBASE.dll+") && CallTrace.includes("_ctypes.pyd+")
    && CallTrace.includes("python27.dll+") && GrantedAccess=="0x1FFFFF")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4b9a8556-99c4-470b-a40c-9c8d02c77ed0_sysmon_ot"'
  description: Credential Dumping by LaZagne
- id: eval
  filter: (EventID=="10" && SourceImage.endsWith("winword.exe") && CallTrace.includes(":\Windows\Microsoft.NET\Framework64\v2.")
    && CallTrace.includes("UNKNOWN"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7bdde3bf-2a42-4c39-aa31-a92b3e17afac_sysmon_ot"'
  description: LittleCorporal Generated Maldoc Injection
- id: eval
  filter: (EventID=="10" && CallTrace.includes("editionupgrademanagerobj.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fb3722e4-1a06-46b6-b772-253e2e7db933_sysmon_ot"'
  description: Load Undocumented Autoelevated COM Interface
- id: eval
  filter: (EventID=="10" && TargetImage.endsWith("\lsass.exe") && SourceImage=="C:\Windows\System32\rundll32.exe"
    && CallTrace.includes("comsvcs.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a49fa4d5-11db-418c-8473-1e014a8dd462_sysmon_ot"'
  description: Lsass Memory Dump via Comsvcs DLL
- id: eval
  filter: (EventID=="10" && TargetImage.endsWith("\lsass.exe") && GrantedAccess=="0x1fffff"
    && (CallTrace.includes("dbghelp.dll") || CallTrace.includes("dbgcore.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5ef9853e-4d0e-4a70-846f-a9ca37d876da_sysmon_ot"'
  description: LSASS Memory Dump
- id: eval
  filter: (EventID=="10" && (TargetImage.endsWith("\verclsid.exe") && GrantedAccess=="0x1FFFFF")
    && ((CallTrace.includes("|UNKNOWN(") && CallTrace.includes("VBE7.DLL")) || (SourceImage.includes("\Microsoft
    Office\\") && CallTrace.includes("|UNKNOWN"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b7967e22-3d7e-409b-9ed5-cdae3f9243a1_sysmon_ot"'
  description: Malware Shellcode in Verclsid Target Process
- id: eval
  filter: (EventID=="10" && TargetImage.endsWith("\lsass.exe") && SourceImage=="C:\Windows\system32\wsmprovhost.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aa35a627-33fb-4d04-a165-d33b4afca3e8_sysmon_ot"'
  description: Mimikatz through Windows Remote Management
- id: eval
  filter: (EventID=="10" && TargetImage.endsWith("\lsass.exe") && CallTrace.includes("C:\Windows\SYSTEM32\ntdll.dll+")
    && CallTrace.includes("C:\Windows\System32\KERNELBASE.dll+") && CallTrace.includes("libffi-7.dll")
    && CallTrace.includes("_ctypes.pyd+") && CallTrace.includes("python3*.dll+") &&
    GrantedAccess=="0x1FFFFF")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7186e989-4ed7-4f4e-a656-4674b9e3e48b_sysmon_ot"'
  description: Credential Dumping by Pypykatz
- id: eval
  filter: (EventID=="10" && (TargetImage.endsWith("\svchost.exe") && GrantedAccess=="0x143a")
    &&  ! ((SourceImage.endsWith("\services.exe") || SourceImage.endsWith("\msiexec.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"174afcfa-6e40-4ae9-af64-496546389294_sysmon_ot"'
  description: SVCHOST Credential Dump
- id: eval
  filter: (EventID=="10" && SourceImage.includes(":\Windows\SysWOW64\\") && GrantedAccess=="0x1fffff"
    && CallTrace.startsWith("UNKNOWN(0000000000000000)|UNKNOWN(0000000000000000)|"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4f6c43e2-f989-4ea5-bcd8-843b49a0317c_sysmon_ot"'
  description: UAC Bypass Using WOW64 Logger DLL Hijack
- id: eval
  filter: (EventID=="10" && (TargetImage.endsWith("\lsass.exe") && (GrantedAccess.endsWith("10")
    || GrantedAccess.endsWith("30") || GrantedAccess.endsWith("50") || GrantedAccess.endsWith("70")
    || GrantedAccess.endsWith("90") || GrantedAccess.endsWith("B0") || GrantedAccess.endsWith("D0")
    || GrantedAccess.endsWith("F0") || GrantedAccess.endsWith("18") || GrantedAccess.endsWith("38")
    || GrantedAccess.endsWith("58") || GrantedAccess.endsWith("78") || GrantedAccess.endsWith("98")
    || GrantedAccess.endsWith("B8") || GrantedAccess.endsWith("D8") || GrantedAccess.endsWith("F8")
    || GrantedAccess.endsWith("1A") || GrantedAccess.endsWith("3A") || GrantedAccess.endsWith("5A")
    || GrantedAccess.endsWith("7A") || GrantedAccess.endsWith("9A") || GrantedAccess.endsWith("BA")
    || GrantedAccess.endsWith("DA") || GrantedAccess.endsWith("FA") || GrantedAccess.endsWith("0x14C2")))
    &&  ! (((SourceImage=="C:\WINDOWS\system32\taskmgr.exe" || SourceImage=="C:\Program
    Files\Malwarebytes\Anti-Malware\MBAMService.exe" || SourceImage=="C:\PROGRAMDATA\MALWAREBYTES\MBAMSERVICE\ctlrupdate\mbupdatr.exe"
    || SourceImage=="C:\WINDOWS\system32\taskhostw.exe" || SourceImage=="C:\Users\\*\AppData\Local\Programs\Microsoft
    VS Code\Code.exe" || SourceImage=="C:\Program Files\Windows Defender\MsMpEng.exe"
    || SourceImage=="C:\Windows\SysWOW64\msiexec.exe" || SourceImage=="C:\Windows\System32\msiexec.exe"
    || SourceImage=="C:\Windows\System32\lsass.exe" || SourceImage=="C:\WINDOWS\System32\perfmon.exe"))
    || (SourceImage.startsWith("C:\ProgramData\Microsoft\Windows Defender\\") && SourceImage.endsWith("\MsMpEng.exe"))
    || (SourceImage.startsWith("C:\Program Files\WindowsApps\\") && SourceImage.endsWith("\GamingServices.exe")
    && (GrantedAccess=="0x1410" || GrantedAccess=="0x410")) || ((SourceImage.endsWith("\PROCEXP64.EXE")
    || SourceImage.endsWith("\PROCEXP.EXE")) && (GrantedAccess=="0x1410" || GrantedAccess=="0x410"))
    || (SourceImage.startsWith("C:\ProgramData\VMware\VMware Tools\\") && SourceImage.endsWith("\vmtoolsd.exe"))
    || ((SourceImage.startsWith("C:\Progra Files\\") || SourceImage.startsWith("C:\Progra
    Files (x86)\\")) && (SourceImage.includes("Antivirus"))) || (SourceImage=="C:\WINDOWS\system32\wbem\wmiprvse.exe"
    && (GrantedAccess=="0x1410" || GrantedAccess=="0x410")) || ((SourceImage.startsWith("C:\Program
    Files\\") || SourceImage.startsWith("C:\Program Files (x86)\\") || SourceImage.startsWith("C:\WINDOWS\system32\\"))
    && (GrantedAccess=="0x1410" || GrantedAccess=="0x410"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a18dd26b-6450-46de-8c91-9659150cf088_sysmon_ot"'
  description: Suspicious GrantedAccess Flags on LSASS Access
- id: eval
  filter: (EventID=="10" && (TargetImage.endsWith("\lsass.exe") && (GrantedAccess.endsWith("10")
    || GrantedAccess.endsWith("30") || GrantedAccess.endsWith("50") || GrantedAccess.endsWith("70")
    || GrantedAccess.endsWith("90") || GrantedAccess.endsWith("B0") || GrantedAccess.endsWith("D0")
    || GrantedAccess.endsWith("F0") || GrantedAccess.endsWith("18") || GrantedAccess.endsWith("38")
    || GrantedAccess.endsWith("58") || GrantedAccess.endsWith("78") || GrantedAccess.endsWith("98")
    || GrantedAccess.endsWith("B8") || GrantedAccess.endsWith("D8") || GrantedAccess.endsWith("F8")
    || GrantedAccess.endsWith("1A") || GrantedAccess.endsWith("3A") || GrantedAccess.endsWith("5A")
    || GrantedAccess.endsWith("7A") || GrantedAccess.endsWith("9A") || GrantedAccess.endsWith("BA")
    || GrantedAccess.endsWith("DA") || GrantedAccess.endsWith("FA") || GrantedAccess.endsWith("0x14C2")
    || GrantedAccess.endsWith("FF")) && (SourceImage.includes("\Temp\\") || SourceImage.includes("\Users\Public\\")
    || SourceImage.includes("\PerfLogs\\") || SourceImage.includes("\AppData\\") ||
    SourceImage.includes("\Temporary"))) &&  ! ((SourceImage.includes("C:\Users\\")
    && SourceImage.includes("\AppData\Local\\") && (SourceImage.endsWith("\Microsoft
    VS Code\Code.exe") || SourceImage.endsWith("\software_reporter_tool.exe")) &&
    GrantedAccess=="0x410")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fa34b441-961a-42fa-a100-ecc28c886725_sysmon_ot"'
  description: LSASS Access from Program in Suspicious Folder
- id: eval
  filter: (EventID=="1" && (Image.includes("\advanced_ip_scanner") || (CommandLine.includes("/portable")
    && CommandLine.includes("/lng"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bef37fa2-f205-4a7b-b484-0759bfd5f86f_sysmon_ot"'
  description: Advanced IP Scanner
- id: eval
  filter: (EventID=="1" && (Image.includes("\advanced_port_scanner") || (CommandLine.includes("/portable")
    && CommandLine.includes("/lng"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"54773c5f-f1cc-4703-9126-2f797d96a69d_sysmon_ot"'
  description: Advanced Port Scanner
- id: eval
  filter: (EventID=="1" && CommandLine.includes("txt:") && ((CommandLine.includes("type
    ") && CommandLine.includes(" > ")) || (CommandLine.includes("makecab ") && CommandLine.includes(".cab"))
    || (CommandLine.includes("reg ") && CommandLine.includes(" export ")) || (CommandLine.includes("regedit
    ") && CommandLine.includes(" /E ")) || (CommandLine.includes("esentutl ") && CommandLine.includes("
    /y ") && CommandLine.includes(" /d ") && CommandLine.includes(" /o "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7f43c430-5001-4f8b-aaa9-c3b88f18fa5c_sysmon_ot"'
  description: Execute From Alternate Data Streams
- id: eval
  filter: (EventID=="1" && (sha1=="e570585edc69f9074cb5e8a790708336bd45ca0f") &&  !
    ((Image.includes(":\Program Files(x86)\\") || Image.includes(":\Program Files\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"18739897-21b1-41da-8ee4-5b786915a676_sysmon_ot"'
  description: GALLIUM Artefacts
- id: eval
  filter: (EventID=="1" && (sha1=="53a44c2396d15c3a03723fa5e5db54cafd527635" || sha1=="9c5e496921e3bc882dc40694f1dcc3746a75db19"
    || sha1=="aeb573accfd95758550cf30bf04f389a92922844" || sha1=="79ef78a797403a4ed1a616c68e07fff868a8650a"
    || sha1=="4f6f38b4cec35e895d91c052b1f5a83d665c2196" || sha1=="1e8c2cac2e4ce7cbd33c3858eb2e24531cb8a84d"
    || sha1=="e841a63e47361a572db9a7334af459ddca11347a" || sha1=="c28f606df28a9bc8df75a4d5e5837fc5522dd34d"
    || sha1=="2e94b305d6812a9f96e6781c888e48c7fb157b6b" || sha1=="dd44133716b8a241957b912fa6a02efde3ce3025"
    || sha1=="8793bf166cb89eb55f0593404e4e933ab605e803" || sha1=="a39b57032dbb2335499a51e13470a7cd5d86b138"
    || sha1=="41cc2b15c662bc001c0eb92f6cc222934f0beeea" || sha1=="d209430d6af54792371174e70e27dd11d3def7a7"
    || sha1=="1c6452026c56efd2c94cea7e0f671eb55515edb0" || sha1=="c6b41d3afdcdcaf9f442bbe772f5da871801fd5a"
    || sha1=="4923d460e22fbbf165bbbaba168e5a46b8157d9f" || sha1=="f201504bd96e81d0d350c3a8332593ee1c9e09de"
    || sha1=="ddd2db1127632a2a52943a2fe516a2e7d05d70d2"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"440a56bf-7873-4439-940a-1c8a671073c2_sysmon_ot"'
  description: GALLIUM Artefacts
- id: eval
  filter: (EventID=="1" && CommandLine.includes("loaddll -a "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9fefd33c-339d-4495-9cba-b96ca006f512_sysmon_ot"'
  description: Pandemic Registry Key
- id: eval
  filter: (EventID=="1" && Image.endsWith("\schtasks.exe") && (CommandLine.includes("/delete")
    || CommandLine.includes("/change")) && CommandLine.includes("/TN") && CommandLine.includes("\Microsoft\Windows\Defrag\ScheduledDefrag"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"958d81aa-8566-4cea-a565-59ccd4df27b0_sysmon_ot"'
  description: Defrag Deactivation
- id: eval
  filter: (EventID=="1" && (CommandLine.startsWith("net use \\%DomainController%\C$
    "P@ssw0rd" ") || CommandLine=="dir c:\\*.doc* /s" || CommandLine=="dir %TEMP%\\*.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c601f20d-570a-4cde-a7d6-e17f99cb8e7f_sysmon_ot"'
  description: Turla Group Lateral Movement
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("checkadmin.exe 127.0.0.1 -all")
    || CommandLine.includes("netsh advfirewall firewall add rule name=powershell dir=in")
    || CommandLine.includes("cmd /c powershell.exe -ep bypass -file c:\s.ps1") ||
    CommandLine.includes("/tn win32times /f") || CommandLine.includes("create win32times
    binPath=") || CommandLine.includes("\c$\windows\system32\devmgr.dll") || CommandLine.includes("
    -exec bypass -enc JgAg") || CommandLine.includes("type *keepass\KeePass.config.xml")
    || CommandLine.includes("iie.exe iie.txt") || CommandLine.includes("reg query
    HKEY_CURRENT_USER\Software\\*\PuTTY\Sessions\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1cfac73c-be78-4f9a-9b08-5bde0c3953ab_sysmon_ot"'
  description: Operation Wocao Activity
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(".doc") || CommandLine.includes(".docx")
    || CommandLine.includes(".xls") || CommandLine.includes(".xlsx") || CommandLine.includes(".ppt")
    || CommandLine.includes(".pptx") || CommandLine.includes(".rtf") || CommandLine.includes(".pdf")
    || CommandLine.includes(".txt")) && ((CommandLine.includes("dir ") && CommandLine.includes("
    /b ") && CommandLine.includes(" /s ")) || (OriginalFileName=="FINDSTR.EXE" &&
    (CommandLine.includes(" /e ") || CommandLine.includes(" /si ")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f576a613-2392-4067-9d1a-9345fb58d8d1_sysmon_ot"'
  description: Automated Collection Command Prompt
- id: eval
  filter: (EventID=="1" && CommandLine.includes("rundll32.exe") && CommandLine.includes(".dll")
    && CommandLine.includes("StartNodeRelay"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b18c9d4c-fac9-4708-bd06-dd5bfacf200f_sysmon_ot"'
  description: F-Secure C3 Load by Rundll32
- id: eval
  filter: (EventID=="1" && Image.endsWith("\certoc.exe") && CommandLine.includes("-LoadDLL")
    && CommandLine.includes(".dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"242301bc-f92f-4476-8718-78004a6efd9f_sysmon_ot"'
  description: Suspicious Load DLL via CertOC.exe
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\SepRemovalToolNative_x64.exe")) || (Image.endsWith("\CATClean.exe")
    && CommandLine.includes("--uninstall")) || (Image.endsWith("\NetInstaller.exe")
    && CommandLine.includes("-r")) || (Image.endsWith("\WFPUnins.exe") && CommandLine.includes("/uninstall")
    && CommandLine.includes("/enterprise"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f44800ac-38ec-471f-936e-3fa7d9c53100_sysmon_ot"'
  description: CleanWipe Usage
- id: eval
  filter: (EventID=="1" && OriginalFileName=="clip.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ddeff553-5233-4ae9-bbab-d64d2bd634be_sysmon_ot"'
  description: Use of CLIP
- id: eval
  filter: (EventID=="1" && CommandLine.includes("rundll32.exe") && CommandLine.includes(".dll")
    && CommandLine.includes("StartW"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ae9c6a7c-9521-42a6-915e-5aaa8689d529_sysmon_ot"'
  description: CobaltStrike Load by Rundll32
- id: eval
  filter: (EventID=="1" && CommandLine.includes("-m ") && CommandLine.includes("-net
    ") && CommandLine.includes("-size ") && CommandLine.includes("-nomutex ") && CommandLine.includes("-p
    \\\") && CommandLine.includes("$"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"689308fc-cfba-4f72-9897-796c1dc61487_sysmon_ot"'
  description: Conti Ransomware Execution
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("sqlcmd ") || CommandLine.includes("sqlcmd.exe"))
    && CommandLine.includes(" -S localhost ") && (CommandLine.includes("sys.sysprocesses")
    || CommandLine.includes("master.dbo.sysdatabases") || CommandLine.includes("BACKUP
    DATABASE")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2f47f1fd-0901-466e-a770-3b7092834a1b_sysmon_ot"'
  description: Conti Backup Database
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" /am51") || CommandLine.includes("
    /password")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d78b5d61-187d-44b6-bf02-93486a80de5a_sysmon_ot"'
  description: DInject PowerShell Cradle CommandLine Flags
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("dir ") || CommandLine.includes("findstr
    ")) && (CommandLine.includes(".key") || CommandLine.includes(".pgp") || CommandLine.includes(".gpg")
    || CommandLine.includes(".ppk") || CommandLine.includes(".p12") || CommandLine.includes(".pem")
    || CommandLine.includes(".pfx") || CommandLine.includes(".cer") || CommandLine.includes(".p7b")
    || CommandLine.includes(".asc")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"213d6a77-3d55-4ce8-ba74-fcfef741974e_sysmon_ot"'
  description: Discover Private Keys
- id: eval
  filter: (EventID=="1" && Image.endsWith("\dnscmd.exe") && CommandLine.includes("/config")
    && CommandLine.includes("/serverlevelplugindll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f63b56ee-3f79-4b8a-97fb-5c48007e8573_sysmon_ot"'
  description: DNS ServerLevelPluginDll Install
- id: eval
  filter: (EventID=="1" && (CommandLine.endsWith(".dll") || CommandLine.endsWith(".csproj"))
    && (Image.endsWith("\dotnet.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d80d5c81-04ba-45b4-84e4-92eba40e0ad3_sysmon_ot"'
  description: Dotnet.exe Exec Dll and Execute Unsigned Code LOLBIN
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\DumpStack.log") || CommandLine==" -o
    DumpStack.log"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4f647cfa-b598-4e12-ad69-c68dd16caef8_sysmon_ot"'
  description: DumpStack.log Defender Evasion
- id: eval
  filter: (EventID=="1" && Hashes.includes("09D278F9DE118EF09163C6140255C690"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2704ab9e-afe2-4854-a3b1-0c0706d03578_sysmon_ot"'
  description: Dumpert Process Dumper
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\msedge.exe") || Image.endsWith("\chrome.exe"))
    && CommandLine.includes("--headless") && CommandLine.includes("dump-dom") && CommandLine.includes("http"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0e8cfe08-02c9-4815-a2f8-0d157b7ed33e_sysmon_ot"'
  description: File Download with Headless Browser
- id: eval
  filter: (EventID=="1" && CommandLine.includes("InfDefaultInstall.exe ") && CommandLine.includes(".inf"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ce7cf472-6fcc-490a-9481-3786840b5d9b_sysmon_ot"'
  description: InfDefaultInstall.exe .inf Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("/in:") && CommandLine.includes("/out:")
    && (Image.endsWith("\DataSvcUtil.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e290b10b-1023-4452-a4a9-eb31a9013b3a_sysmon_ot"'
  description: LOLBAS Data Exfiltration by DataSvcUtil.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("regsvr32") || Image.endsWith("rundll32")
    || Image.endsWith("msiexec") || Image.endsWith("mshta") || Image.endsWith("verclsid"))
    && (ParentImage.endsWith("winword.exe") || ParentImage.endsWith("excel.exe") ||
    ParentImage.endsWith("powerpnt.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"23daeb52-e6eb-493c-8607-c4f0246cb7d8_sysmon_ot"'
  description: New Lolbin Process by Office Applications
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("-i") || CommandLine.includes("/install")
    || CommandLine.includes("-a") || CommandLine.includes("/add-driver") || CommandLine.includes(".inf"))
    && (Image.endsWith("\pnputil.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a2ea3ae7-d3d0-40a0-a55c-25a45c87cac1_sysmon_ot"'
  description: Suspicious Driver Install by pnputil.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("regsvr32") || Image.endsWith("rundll32")
    || Image.endsWith("msiexec") || Image.endsWith("mshta") || Image.endsWith("verclsid"))
    && ParentImage.endsWith("\wbem\WmiPrvSE.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8a582fe2-0882-4b89-a82a-da6b2dc32937_sysmon_ot"'
  description: Lolbins Process Creation with WmiPrvse
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\cmd.exe") && CommandLine.includes("sc
    config") && CommandLine.includes("wercplsupporte.dll")) || (Image.endsWith("\wmic.exe")
    && CommandLine.endsWith("COR_PROFILER"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c3198a27-23a0-4c2c-af19-e5328d49680e_sysmon_ot"'
  description: Blue Mockingbird
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("=[char][byte]('0x'+") || CommandLine.includes("
    -work worker0 -path ")) || (ParentCommandLine.includes("DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}")
    && Image.includes("\AppData\Local\Temp\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"965fff6c-1d7e-4e25-91fd-cdccd75f7d2c_sysmon_ot"'
  description: DarkSide Ransomware Pattern
- id: eval
  filter: (EventID=="1" && CommandLine.includes("-i SM-tgytutrc -s"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"74db3488-fd28-480a-95aa-b7af626de068_sysmon_ot"'
  description: LockerGoga Ransomware
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\net.exe") || Image.endsWith("\net1.exe"))
    && CommandLine.includes("stop") && (CommandLine.includes("samss") || CommandLine.includes("audioendpointbuilder")
    || CommandLine.includes("unistoresvc_?????")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0acaad27-9f02-4136-a243-c357202edd74_sysmon_ot"'
  description: Ryuk Ransomware
- id: eval
  filter: (EventID=="1" && CommandLine.includes("verb:sync") && CommandLine.includes("-source:RunCommand")
    && CommandLine.includes("-dest:runCommand") && (Image.endsWith("\msdeploy.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"646bc99f-6682-4b47-a73a-17b1b64c9d34_sysmon_ot"'
  description: Execute Files with Msdeploy.exe
- id: eval
  filter: (EventID=="1" && CommandLine.includes("start /min msedge"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"94771a71-ba41-4b6e-a757-b531372eaab6_sysmon_ot"'
  description: Suspicious Minimized MSEdge Start
- id: eval
  filter: (EventID=="1" && (Image=="\wbem\WMIC.exe" || CommandLine.includes("wmic
    ") || OriginalFileName=="wmic.exe" || Description=="WMI Commandline Utility")
    && (ParentImage.endsWith("winword.exe") || ParentImage.endsWith("excel.exe") ||
    ParentImage.endsWith("powerpnt.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"518643ba-7d9c-4fa5-9f37-baed36059f6a_sysmon_ot"'
  description: Office Applications Spawning Wmi Cli
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\wbem\WMIC.exe") || ParentCommandLine.includes("wmic
    ") || OriginalFileName=="wmic.exe" || Description=="WMI Commandline Utility")
    && (CommandLine.includes("regsvr32") || CommandLine.includes("rundll32") || CommandLine.includes("msiexec")
    || CommandLine.includes("mshta") || CommandLine.includes("verclsid")) && (ParentImage.endsWith("winword.exe")
    || ParentImage.endsWith("excel.exe") || ParentImage.endsWith("powerpnt.exe"))
    && ParentCommandLine.includes("process") && ParentCommandLine.includes("create")
    && ParentCommandLine.includes("call"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9d1c72f5-43f0-4da5-9320-648cf2099dd0_sysmon_ot"'
  description: Excel Proxy Executing Regsvr32 With Payload
- id: eval
  filter: (EventID=="1" && (ParentCommandLine.includes("regsvr32") || ParentCommandLine.includes("rundll32")
    || ParentCommandLine.includes("msiexec") || ParentCommandLine.includes("mshta")
    || ParentCommandLine.includes("verclsid")) && (Image.endsWith("\wbem\WMIC.exe")
    || ParentCommandLine.includes("wmic ")) && (ParentImage.endsWith("winword.exe")
    || ParentImage.endsWith("excel.exe") || ParentImage.endsWith("powerpnt.exe"))
    && ParentCommandLine.includes("process") && ParentCommandLine.includes("create")
    && ParentCommandLine.includes("call"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c0e1c3d5-4381-4f18-8145-2583f06a1fe5_sysmon_ot"'
  description: Excel Proxy Executing Regsvr32 With Payload
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\wbem\WMIC.exe") || ParentCommandLine.includes("wmic
    ")) && (ParentImage=="winword.exe" || ParentImage=="excel.exe" || ParentImage=="powerpnt.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"04f5363a-6bca-42ff-be70-0d28bf629ead_sysmon_ot"'
  description: Office Applications Spawning Wmi Cli
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("updata.exe") && CommandLine.includes("config")
    && CommandLine.includes("msdtc") && CommandLine.includes("start") && CommandLine.includes("auto"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b2400ffb-7680-47c0-b08a-098a7de7e7a9_sysmon_ot"'
  description: Pingback Backdoor
- id: eval
  filter: (EventID=="1" && Image.endsWith("\protocolhandler.exe") && CommandLine.includes(""ms-word")
    && CommandLine.includes(".docx""))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"104cdb48-a7a8-4ca7-a453-32942c6e5dcb_sysmon_ot"'
  description: ProtocolHandler.exe Downloaded Suspicious File
- id: eval
  filter: (EventID=="1" && CommandLine.includes("root") && ((Image.endsWith("\certutil.exe")
    && CommandLine.includes("-addstore")) || (Image.endsWith("\CertMgr.exe") && CommandLine.includes("/add"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"46591fae-7a4c-46ea-aec3-dff5e6d785dc_sysmon_ot"'
  description: Root Certificate Installed
- id: eval
  filter: (EventID=="1" && OriginalFileName=="sdelete.exe" &&  ! ((CommandLine.includes("
    -h") || CommandLine.includes(" -c") || CommandLine.includes(" -z") || CommandLine.includes("
    /?"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a4824fca-976f-4964-b334-0621379e84c4_sysmon_ot"'
  description: Sysinternals SDelete Delete File
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\java.exe") && (Image.endsWith("\cmd.exe")))
    &&  ! (ParentImage.includes("build") && CommandLine.includes("build")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dff1e1cc-d3fd-47c8-bfc2-aeb878a754c0_sysmon_ot"'
  description: Shells Spawn by Java
- id: eval
  filter: (EventID=="1" && Image.endsWith("\reg.exe") && CommandLine.includes("query")
    && CommandLine.includes("\software\\") && CommandLine.includes("/v") && CommandLine.includes("svcversion"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e13f668e-7f95-443d-98d2-1816a7648a7b_sysmon_ot"'
  description: Detected Windows Software Discovery
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\winlogon.exe") && Image.endsWith("\cmd.exe")
    && (CommandLine.includes("sethc.exe") || CommandLine.includes("utilman.exe") ||
    CommandLine.includes("osk.exe") || CommandLine.includes("Magnify.exe") || CommandLine.includes("Narrator.exe")
    || CommandLine.includes("DisplaySwitch.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2fdefcb3-dbda-401e-ae23-f0db027628bc_sysmon_ot"'
  description: Sticky Key Like Backdoor Usage
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\stordiag.exe") && (Image.endsWith("\schtasks.exe")
    || Image.endsWith("\systeminfo.exe") || Image.endsWith("\fltmc.exe"))) &&  ! ((ParentImage.startsWith("c:\windows\system32\\")
    || ParentImage.startsWith("c:\windows\syswow64\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"961e0abb-1b1e-4c84-a453-aafe56ad0d34_sysmon_ot"'
  description: Execution via stordiag.exe
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("7z.exe") || CommandLine.includes("7za.exe"))
    && CommandLine.includes(" -p") && (CommandLine.includes(" a ") || CommandLine.includes("
    u ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9fbf5927-5261-4284-a71d-f681029ea574_sysmon_ot"'
  description: Compress Data and Lock With Password for Exfiltration With 7-ZIP
- id: eval
  filter: (EventID=="1" && Image.endsWith("\AccCheckConsole.exe") && CommandLine.includes("
    -window ") && CommandLine.includes(".dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0f6da907-5854-4be6-859a-e9958747b0aa_sysmon_ot"'
  description: Suspicious LOLBIN AccCheckConsole
- id: eval
  filter: (EventID=="1" && CommandLine.includes("Invoke-ATHRemoteFXvGPUDisablementCommand
    ") && (CommandLine.includes("-ModuleName ") || CommandLine.includes("-ModulePath
    ") || CommandLine.includes("-ScriptBlock ") || CommandLine.includes("-RemoteFXvGPUDisablementFilePath")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a6fc3c46-23b8-4996-9ea2-573f4c4d88c5_sysmon_ot"'
  description: Abusable Invoke-ATHRemoteFXvGPUDisablementCommand
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("del *.exe") && CommandLine.includes("/f
    ") && CommandLine.includes("/q ")) || (CommandLine.includes("del *.dll") && CommandLine.includes("C:\ProgramData\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"204b17ae-4007-471b-917b-b917b315c5db_sysmon_ot"'
  description: Suspicious Del in CommandLine
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\curl.exe") || Image.endsWith("\wget.exe"))
    || (CommandLine.includes("Start-BitsTransfer") || CommandLine.includes(".DownloadFile(")
    || CommandLine.includes(".DownloadString("))) && (CommandLine.includes("https://attachment.outlook.live.net/owa/")
    || CommandLine.includes("https://onenoteonlinesync.onenote.com/onenoteonlinesync/")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"00d49ed5-4491-4271-a8db-650a4ef6f8c1_sysmon_ot"'
  description: Suspicious Download from Office Domain
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\dtrace.exe") && CommandLine.includes("lkd(0)"))
    || (CommandLine.includes("syscall:::return") && CommandLine.includes("lkd("))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7124aebe-4cd7-4ccb-8df0-6d6b93c96795_sysmon_ot"'
  description: Suspicious Kernel Dump Using Dtrace
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\format.com") && CommandLine.includes("/fs:"))
    &&  ! (((CommandLine.includes("/fs:FAT") || CommandLine.includes("/fs:exFAT")
    || CommandLine.includes("/fs:NTFS") || CommandLine.includes("/fs:UDF") || CommandLine.includes("/fs:ReFS")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9fb6b26e-7f9e-4517-a48b-8cac4a1b6c60_sysmon_ot"'
  description: Format.com FileSystem LOLBIN
- id: eval
  filter: (EventID=="1" &&  ! (Image.includes("\\")) &&  ! ((Image ===null ) || (Image=="Registry"
    || CommandLine=="Registry")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"71158e3f-df67-472b-930e-7d287acaa3e1_sysmon_ot"'
  description: Execution Of Not Existing File
- id: eval
  filter: (EventID=="1" &&  ! (Image.endsWith(".exe")) &&  ! ((Image ===null ) ||
    (Image=="Registry") || ((Image=="-" || Image=="")) || (Image.startsWith("C:\Windows\Installer\MSI"))
    || (ParentImage.startsWith("C:\ProgramData\Avira\\")) || (Image.startsWith("C:\Windows\Temp\\")
    && Image.endsWith("\avira_speedup_setup_update.tmp")) || (Image.endsWith(".scr"))
    || (Image.includes("NVIDIA\NvBackend\\") && Image.endsWith(".dat")) || (Image.startsWith("C:\Windows\System32\\")
    && Image.endsWith(".com"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c09dad97-1c78-4f71-b127-7edb2b8e491a_sysmon_ot"'
  description: Execution File Type Other Than .exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\tree.com") || Image.endsWith("\WMIC.exe")
    || Image.endsWith("\doskey.exe") || Image.endsWith("\sc.exe")) && ParentCommandLine.includes("
    > %TEMP%\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aa2efee7-34dd-446e-8a37-40790a66efd7_sysmon_ot"'
  description: Recon Information for Export with Command Prompt
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("> \\127.0.0.1\admin$") || CommandLine.includes(">
    \\localhost\admin$")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ab9e3b40-0c85-4ba1-aede-455d226fd124_sysmon_ot"'
  description: Suspicious Redirection to Local Admin Share
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("rundll32") && CommandLine.includes("javascript")
    && CommandLine.includes("..\..\mshtml,RunHTMLApplication")) || (CommandLine.includes(";document.write();GetObject("script"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9f06447a-a33a-4cbe-a94f-a3f43184a7a3_sysmon_ot"'
  description: Rundll32 JS RunHTMLApplication Pattern
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\java.exe") && (Image.endsWith("\sh.exe")
    || Image.endsWith("\bash.exe") || Image.endsWith("\powershell.exe") || Image.endsWith("\schtasks.exe")
    || Image.endsWith("\certutil.exe") || Image.endsWith("\whoami.exe") || Image.endsWith("\bitsadmin.exe")
    || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe") || Image.endsWith("\scrcons.exe")
    || Image.endsWith("\regsvr32.exe") || Image.endsWith("\hh.exe") || Image.endsWith("\wmic.exe")
    || Image.endsWith("\mshta.exe") || Image.endsWith("\rundll32.exe") || Image.endsWith("\forfiles.exe")
    || Image.endsWith("\scriptrunner.exe") || Image.endsWith("\mftrace.exe") || Image.endsWith("\AppVLP.exe")
    || Image.endsWith("\curl.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0d34ed8b-1c12-4ff2-828c-16fc860b766d_sysmon_ot"'
  description: Suspicious Shells Spawn by Java
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\keytool.exe") && (Image.endsWith("\cmd.exe")
    || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe") || Image.endsWith("\powershell.exe")
    || Image.endsWith("\schtasks.exe") || Image.endsWith("\certutil.exe") || Image.endsWith("\whoami.exe")
    || Image.endsWith("\bitsadmin.exe") || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\scrcons.exe") || Image.endsWith("\regsvr32.exe") || Image.endsWith("\hh.exe")
    || Image.endsWith("\wmic.exe") || Image.endsWith("\mshta.exe") || Image.endsWith("\rundll32.exe")
    || Image.endsWith("\forfiles.exe") || Image.endsWith("\scriptrunner.exe") || Image.endsWith("\mftrace.exe")
    || Image.endsWith("\AppVLP.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"90fb5e62-ca1f-4e22-b42e-cc521874c938_sysmon_ot"'
  description: Suspicious Shells Spawn by Java Utility Keytool
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("Invoke-WebRequest") || CommandLine.includes("iwr
    ") || CommandLine.includes("wget ") || CommandLine.includes("curl ") || CommandLine.includes("Net.WebClient")
    || CommandLine.includes("Start-BitsTransfer")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d_sysmon_ot"'
  description: Windows Suspicious Use Of Web Request in CommandLine
- id: eval
  filter: (EventID=="1" && CommandLine.includes(".exe whoami"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e9142d84-fbe0-401d-ac50-3e519fb00c89_sysmon_ot"'
  description: WhoAmI as Parameter
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("winzip.exe") || CommandLine.includes("winzip64.exe"))
    && (CommandLine.includes("-s"")) && (CommandLine.includes(" -min ") || CommandLine.includes("
    -a ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e2e80da2-8c66-4e00-ae3c-2eebd29f6b6d_sysmon_ot"'
  description: Compress Data and Lock With Password for Exfiltration With WINZIP
- id: eval
  filter: (EventID=="1" && CommandLine.includes("Compress-Archive ") && CommandLine.includes("
    -Path ") && CommandLine.includes(" -DestinationPath ") && CommandLine.includes("$env:TEMP\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98_sysmon_ot"'
  description: Zip A Folder With PowerShell For Staging In Temp
- id: eval
  filter: (EventID=="1" && Image.endsWith("\SyncAppvPublishingServer.exe") && CommandLine.includes(""n;
    "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fbd7c32d-db2a-4418-b92c-566eb8911133_sysmon_ot"'
  description: SyncAppvPublishingServer Execute Arbitrary PowerShell Code
- id: eval
  filter: (EventID=="1" && CommandLine.includes("\SyncAppvPublishingServer.vbs") &&
    CommandLine.includes(""\n;"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"36475a7d-0f6d-4dce-9b01-6aeb473bbaf1_sysmon_ot"'
  description: SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" -accepteula"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7cccd811-7ae9-4ebe-9afd-cb5c406b824b_sysmon_ot"'
  description: Usage of Sysinternals Tools
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\eventvwr.exe") &&  ! (Image.endsWith("\mmc.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"be344333-921d-4c4d-8bb8-e584cf584780_sysmon_ot"'
  description: UAC Bypass via Event Viewer
- id: eval
  filter: (EventID=="1" && Image.endsWith("\PSEXESVC.exe") && User.startsWith("NT
    AUTHORITY\SYSTEM"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fa91cc36-24c9-41ce-b3c8-3bbc3f2f67ba_sysmon_ot"'
  description: PsExec Tool Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("Install-TransportAgent"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"83809e84-4475-4b69-bc3e-4aad8568612f_sysmon_ot"'
  description: MSExchange Transport Agent Installation
- id: eval
  filter: (EventID=="1" && Image.endsWith("\dump64.exe") && ( ! (Image.includes("\Installer\Feedback\dump64.exe"))
    || (CommandLine.includes(" -ma ") || CommandLine.includes("accpeteula"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"129966c9-de17-4334-a123-8b58172e664d_sysmon_ot"'
  description: Suspicious Dump64.exe Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("New-MailboxExport") && CommandLine.includes("
    -Mailbox ") && CommandLine.includes(" -FilePath \\127.0.0.1\C$"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"889719ef-dd62-43df-86c3-768fb08dc7c0_sysmon_ot"'
  description: Suspicious PowerShell Mailbox Export to Share
- id: eval
  filter: (EventID=="1" && CommandLine.includes("esentutl") && CommandLine.includes("
    /p"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7df1713a-1a5b-4a4b-a071-dc83b144a101_sysmon_ot"'
  description: Esentutl Gather Credentials
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\policydefinitions\postgresql.exe"))
    || (CommandLine.includes("CSIDL_SYSTEM_DRIVE\temp\sys.tmp") || CommandLine.includes("
    1> \\127.0.0.1\ADMIN$\__16")) || (CommandLine.includes("powershell -c ") && CommandLine.includes("\comsvcs.dll
    MiniDump ") && CommandLine.includes("\winupd.log full"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2f974656-6d83-4059-bbdf-68ac5403422f_sysmon_ot"'
  description: Hermetic Wiper TG Process Patterns
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\AdvancedRun.exe") || (CommandLine.includes("
    /EXEFilename ") && CommandLine.includes(" /Run")) || (CommandLine.includes(" /WindowState
    0") && CommandLine.includes(" /RunAs ") && CommandLine.includes(" /CommandLine
    "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d2b749ee-4225-417e-b20e-a8d2193cbb84_sysmon_ot"'
  description: Suspicious AdvancedRun Execution
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("/EXEFilename") || CommandLine.includes("/CommandLine"))
    && ((CommandLine.includes(" /RunAs 8 ") || CommandLine.includes(" /RunAs 4 "))
    || (CommandLine.endsWith("/RunAs 8") || CommandLine.endsWith("/RunAs 4"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fa00b701-44c6-4679-994d-5a18afa8a707_sysmon_ot"'
  description: Suspicious AdvancedRun Runas Priv User
- id: eval
  filter: '(EventID=="1" && (Image.endsWith("\rundll32.exe") && (CommandLine.includes(",#")
    || CommandLine.includes(", #") || CommandLine.includes(".dll #") || CommandLine.includes(".ocx
    #"))) &&  ! (CommandLine.includes("EDGEHTML.dll") && CommandLine.includes("#141")))'
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e79a9e79-eb72-4e78-a628-0e7e8f59e89c_sysmon_ot"'
  description: Suspicious Call by Ordinal
- id: eval
  filter: (EventID=="1" && ((ParentImage.endsWith("\winlogon.exe") || ParentImage.endsWith("\services.exe")
    || ParentImage.endsWith("\lsass.exe") || ParentImage.endsWith("\csrss.exe") ||
    ParentImage.endsWith("\smss.exe") || ParentImage.endsWith("\wininit.exe") || ParentImage.endsWith("\spoolsv.exe")
    || ParentImage.endsWith("\searchindexer.exe")) && (Image.endsWith("\powershell.exe")
    || Image.endsWith("\cmd.exe")) && (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys"))) &&  ! (CommandLine.includes(" route ") && CommandLine.includes(" ADD
    ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d522eca2-2973-4391-a3e0-ef0374321dae_sysmon_ot"'
  description: Abused Debug Privilege by Arbitrary Parent Processes
- id: eval
  filter: (EventID=="1" && IntegrityLevel=="Medium" && (Product.endsWith("AccessChk")
    || Description.includes("Reports effective permissions")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c625d754-6a3d-4f65-9c9a-536aea960d37_sysmon_ot"'
  description: Accesschk Usage After Privilege Escalation
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\cmd.exe") || Image.endsWith("\powershell.exe"))
    && ParentImage.includes("\Windows\Installer\\") && ParentImage.includes("msi")
    && (ParentImage.endsWith("tmp")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1e53dd56-8d83-4eb4-a43e-b790a05510aa_sysmon_ot"'
  description: Always Install Elevated MSI Spawned Cmd And Powershell
- id: eval
  filter: (EventID=="1" && ((Image.includes("\Windows\Installer\\") && Image.includes("msi")
    && (Image.endsWith("tmp")) && (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys"))) || (((Image.endsWith("\msiexec.exe")) && (User.startsWith("NT AUTHORITY\SYSTEM")
    || User.startsWith("AUTORITE NT\Sys")) && IntegrityLevel=="System") &&  ! (CommandLine.endsWith("\system32\msiexec.exe
    /V") || ParentCommandLine.endsWith("\system32\msiexec.exe /V")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd951fdc-4b2f-47f5-ba99-a33bf61e3770_sysmon_ot"'
  description: Always Install Elevated Windows Installer
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\powershell.exe")) && (ParentImage.endsWith("\excel.exe"))
    && (CommandLine.includes("DataExchange.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"36222790-0d43-4fe8-86e4-674b27809543_sysmon_ot"'
  description: DNS Tunnel Technique from MuddyWater
- id: eval
  filter: (EventID=="1" && ((Image.includes("windows\system32\Physmem.sys") || (Image.includes("Windows\system32\ime\SHARED\WimBootConfigurations.ini")
    || Image.includes("Windows\system32\ime\IMEJP\WimBootConfigurations.ini") || Image.includes("Windows\system32\ime\IMETC\WimBootConfigurations.ini")))
    || ((Image.includes("windows\system32\filepath2") || Image.includes("windows\system32\ime"))
    && (CommandLine.includes("reg add")) && (CommandLine.includes("HKEY_LOCAL_MACHINE\software\classes\clsid\{7c857801-7381-11cf-884d-00aa004b2e24}\inprocserver32")
    || CommandLine.includes("HKEY_LOCAL_MACHINE\software\classes\clsid\{cf4cc405-e2c5-4ddd-b3ce-5e7582d8c9fa}\inprocserver32")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7ba08e95-1e0b-40cd-9db5-b980555e42fd_sysmon_ot"'
  description: SOURGUM Actor Behaviours
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\Atlassian\Confluence\jre\bin\java.exe")
    && (CommandLine.includes("cmd /c") || CommandLine.includes("cmd /k") || CommandLine.includes("powershell")
    || CommandLine.includes("certutil") || CommandLine.includes("curl") || CommandLine.includes("whoami")
    || CommandLine.includes("ipconfig")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"245f92e3-c4da-45f1-9070-bc552e06db11_sysmon_ot"'
  description: Atlassian Confluence CVE-2021-26084
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\cmstp.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7d4cdc5a-0076-40ca-aac8-f7e714570e47_sysmon_ot"'
  description: CMSTP Execution Process Creation
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" /INJECTRUNNING") && CommandLine.includes(".dll")
    && OriginalFileName.includes("mavinject"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4f73421b-5a0b-4bbf-a892-5a7fb99bea66_sysmon_ot"'
  description: Mavinject Inject DLL Into Running Process
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("UMWorkerProcess.exe") &&  ! ((Image.endsWith("wermgr.exe")
    || Image.endsWith("WerFault.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd479ccc-d8f0-4c66-ba7d-e06286f3f887_sysmon_ot"'
  description: CVE-2021-26857 Exchange Exploitation
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\expand.exe")) && (CommandLine.includes(".cab")
    || CommandLine.includes("/F:") || CommandLine.includes("-F:") || CommandLine.includes("C:\ProgramData\\")
    || CommandLine.includes("C:\Public\\") || CommandLine.includes("\AppData\Local\Temp\\")
    || CommandLine.includes("\AppData\Roaming\Temp\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9f107a84-532c-41af-b005-8d12a607639f_sysmon_ot"'
  description: Cabinet File Expansion
- id: eval
  filter: (EventID=="1" && ((Imphash=="a53a02b997935fd8eedcb5f7abab9b9f" || Imphash=="e96a73c7bf33a464c510ede582318bf2")
    || (CommandLine.endsWith(".exe -S") && ParentImage.endsWith("\services.exe")))
    &&  ! (Image.endsWith("\clussvc.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7aa7009a-28b9-4344-8c1f-159489a390df_sysmon_ot"'
  description: Windows Credential Editor
- id: eval
  filter: (EventID=="1" && Image.endsWith("sdclt.exe") && IntegrityLevel=="High")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"40f9af16-589d-4984-b78d-8c2aec023197_sysmon_ot"'
  description: High Integrity Sdclt Process
- id: eval
  filter: (EventID=="1" && (((ParentImage.endsWith("\userinit.exe") &&  ! (Image.endsWith("\explorer.exe")))
    &&  ! ((CommandLine.includes("netlogon*.bat") || CommandLine.includes("UsrLogon.cmd"))))
    || CommandLine.includes("UserInitMprLogonScript")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0a98a10c-685d-4ab0-bddc-b6bdd1d48458_sysmon_ot"'
  description: Logon Scripts (UserInitMprLogonScript)
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\ncat.exe")) || (CommandLine.includes("
    -lvp ") || CommandLine.includes(" -l --proxy-type http ") || CommandLine.includes("
    --exec cmd.exe ") || CommandLine.includes(" -vnl --exec "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e31033fc-33f0-4020-9a16-faf9b31cbf08_sysmon_ot"'
  description: Ncat Execution
- id: eval
  filter: (EventID=="1" && ((Image.includes("wuauclt") || OriginalFileName=="wuauclt.exe")
    && (CommandLine.includes("UpdateDeploymentProvider") && CommandLine.includes(".dll")
    && CommandLine.includes("RunHandlerComServer"))) &&  ! ((CommandLine.includes("
    /UpdateDeploymentProvider UpdateDeploymentProvider.dll ") || CommandLine.includes("
    wuaueng.dll "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"af77cf95-c469-471c-b6a0-946c685c4798_sysmon_ot"'
  description: Proxy Execution via Wuauclt
- id: eval
  filter: (EventID=="1" && OriginalFileName=="MpCmdRun.exe" && CommandLine.includes("
    -RemoveDefinitions") && CommandLine.includes(" -All"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9719a8aa-401c-41af-8108-ced7ec9cd75c_sysmon_ot"'
  description: Remove Windows Defender Definition Files
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\sdclt.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"da2738f2-fadb-4394-afa7-0a0674885afa_sysmon_ot"'
  description: Sdclt Child Processes
- id: eval
  filter: (EventID=="1" && Description=="Command-line SSH, Telnet, and Rlogin client"
    && CommandLine.includes(" -R "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"48a61b29-389f-4032-b317-b30de6b95314_sysmon_ot"'
  description: Suspicious Plink Remote Forwarding
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("Stop-Service ") || CommandLine.includes("Remove-Service
    ")) && (CommandLine.includes(" McAfeeDLPAgentService") || CommandLine.includes("
    Trend Micro Deep Security Manager") || CommandLine.includes(" TMBMServer")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6783aa9e-0dc3-49d4-a94a-8b39c5fd700b_sysmon_ot"'
  description: Stop Or Remove Antivirus Service
- id: eval
  filter: (EventID=="1" && Image.endsWith("\rundll32.exe") && CommandLine.includes("C:\windows\system32\davclnt.dll,DavSetCookie"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2dbd9d3d-9e27-42a8-b8df-f13825c6c3d5_sysmon_ot"'
  description: Suspicious WebDav Client Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("\WindowsSensor.exe") && CommandLine.includes("
    /uninstall") && CommandLine.includes(" /quiet"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f0f7be61-9cf5-43be-9836-99d6ef448a18_sysmon_ot"'
  description: Uninstall Crowdstrike Falcon
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\vmtoolsd.exe") && (Image.endsWith("\cmd.exe")
    || Image.endsWith("\powershell.exe") || Image.endsWith("\rundll32.exe") || Image.endsWith("\regsvr32.exe")
    || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe"))) &&  ! ((CommandLine.includes("\VMware\VMware
    Tools\poweron-vm-default.bat") || CommandLine.includes("\VMware\VMware Tools\poweroff-vm-default.bat")
    || CommandLine.includes("\VMware\VMware Tools\resume-vm-default.bat") || CommandLine.includes("\VMware\VMware
    Tools\suspend-vm-default.bat"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5687f942-867b-4578-ade7-1e341c46e99a_sysmon_ot"'
  description: VMToolsd Suspicious Child Process
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("\Service.exe") && (CommandLine.endsWith("i")
    || CommandLine.endsWith("u"))) || (CommandLine.endsWith("\microsoft\Taskbar\autoit3.exe")
    || CommandLine.startsWith("C:\wsc.exe")) || (Image.includes("\Windows\Temp\DB\\")
    && Image.endsWith(".exe")) || (CommandLine.includes("\nslookup.exe") && CommandLine.includes("-q=TXT")
    && ParentImage.includes("\Autoit"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ce6e34ca-966d-41c9-8d93-5b06c8b97a06_sysmon_ot"'
  description: Chafer Activity
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("domainlist") || CommandLine.includes("trustdmp")
    || CommandLine.includes("dcmodes") || CommandLine.includes("adinfo") || CommandLine.includes("
    dclist ") || CommandLine.includes("computer_pwdnotreqd") || CommandLine.includes("objectcategory=")
    || CommandLine.includes("-subnets -f") || CommandLine.includes("name="Domain Admins"")
    || CommandLine.includes("-sc u:") || CommandLine.includes("domainncs") || CommandLine.includes("dompol")
    || CommandLine.includes(" oudmp ") || CommandLine.includes("subnetdmp") || CommandLine.includes("gpodmp")
    || CommandLine.includes("fspdmp") || CommandLine.includes("users_noexpire") ||
    CommandLine.includes("computers_active")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9a132afa-654e-11eb-ae93-0242ac130002_sysmon_ot"'
  description: AdFind Usage Detection
- id: eval
  filter: (EventID=="1" && CommandLine.includes("--install") && CommandLine.includes("--start-with-win")
    && CommandLine.includes("--silent"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"114e7f1c-f137-48c8-8f54-3088c24ce4b9_sysmon_ot"'
  description: AnyDesk Silent Installation
- id: eval
  filter: (EventID=="1" && CommandLine.includes("-noni") && CommandLine.includes("-ep")
    && CommandLine.includes("bypass") && CommandLine.includes("$"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"033fe7d6-66d1-4240-ac6b-28908009c71f_sysmon_ot"'
  description: APT29
- id: eval
  filter: (EventID=="1" && (CommandLine=="reg query "HKEY_CURRENT_USER\Software\Microsoft\Terminal
    Server Client\Default"" || CommandLine.startsWith("powershell.exe mshta.exe http")
    || CommandLine=="cmd.exe /c taskkill /im cmd.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2b30fa36-3a18-402f-a22d-bf4ce2189f35_sysmon_ot"'
  description: Baby Shark Activity
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\xcopy.exe") && CommandLine.includes("/S")
    && CommandLine.includes("/E") && CommandLine.includes("/C") && CommandLine.includes("/Q")
    && CommandLine.includes("/H") && CommandLine.includes("\\\")) || (Image.endsWith("\adexplorer.exe")
    && CommandLine.includes("-snapshot") && CommandLine.includes("""") && CommandLine.includes("c:\users\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b83f5166-9237-4b5e-9cd4-7b5d52f4d8ee_sysmon_ot"'
  description: Judgement Panda Credential Access Activity
- id: eval
  filter: (EventID=="1" && CommandLine.includes("\AppData\Local\\") && (CommandLine.includes("\regsvr32")
    || CommandLine.includes(",DllEntry")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bd70d3f8-e60e-4d25-89f0-0b5a9cff20e0_sysmon_ot"'
  description: BlueMashroom DLL Load
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cscript.exe") && CommandLine.includes(".vbs")
    && CommandLine.includes("/shell"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"966e4016-627f-44f7-8341-f394905c361f_sysmon_ot"'
  description: WMIExec VBS Script
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\crackmapexec.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"04d9079e-3905-4b70-ad37-6bdf11304965_sysmon_ot"'
  description: CrackMapExecWin
- id: eval
  filter: (EventID=="1" && ((Image=="C:\Windows\SysWOW64\cmd.exe" && CommandLine.includes("\Windows\Caches\NavShExt.dll
    ")) || CommandLine.endsWith("\AppData\Roaming\MICROS~1\Windows\Caches\NavShExt.dll,Setting")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e507feb7-5f73-4ef6-a970-91bb6f6d744f_sysmon_ot"'
  description: Elise Backdoor
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\sllauncher.exe") && Image.endsWith("\svchost.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9aa01d62-7667-4d3b-acb8-8cb5103e2014_sysmon_ot"'
  description: Emissary Panda Malware SLLauncher
- id: eval
  filter: (EventID=="1" && CommandLine.endsWith("/i:%APPDATA%\logs.txt scrobj.dll")
    && (Image.endsWith("\cutil.exe") || Description=="Microsoft(C) Registerserver"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"10152a7b-b566-438f-a33c-390b607d1c8d_sysmon_ot"'
  description: Empire Monkey
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\rundll32.exe") && CommandLine.endsWith(",dll_u"))
    || CommandLine.includes(" -export dll_u ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d465d1d8-27a2-4cca-9621-a800f37cf72e_sysmon_ot"'
  description: Equation Group DLL_U Load
- id: eval
  filter: (EventID=="1" && CommandLine.includes("regsvr32") && CommandLine.includes("/s")
    && CommandLine.includes("/i") && CommandLine.includes("\AppData\Roaming\\") &&
    CommandLine.includes(".ocx"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8acf3cfa-1e8c-4099-83de-a0c4038e18f0_sysmon_ot"'
  description: EvilNum Golden Chickens Deployment via OCX Files
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("bitsadmin") && CommandLine.includes("/transfer")
    && CommandLine.includes("CSIDL_APPDATA")) || (CommandLine.includes("CSIDL_SYSTEM_DRIVE"))
    || (CommandLine.includes("\msf.ps1") || CommandLine.includes("8989 -e cmd.exe")
    || CommandLine.includes("system.Data.SqlClient.SqlDataAdapter($cmd); [void]$da.fill")
    || CommandLine.includes("-nop -w hidden -c $k=new-object") || CommandLine.includes("[Net.CredentialCache]::DefaultCredentials;IEX
    ") || CommandLine.includes(" -nop -w hidden -c $m=new-object net.webclient;$m")
    || CommandLine.includes("-noninteractive -executionpolicy bypass whoami") || CommandLine.includes("-noninteractive
    -executionpolicy bypass netstat -a") || CommandLine.includes("L3NlcnZlcj1")) ||
    (Image.endsWith("\adobe\Adobe.exe") || Image.endsWith("\oracle\local.exe") ||
    Image.endsWith("\revshell.exe") || Image.endsWith("infopagesbackup\ncat.exe")
    || Image.endsWith("CSIDL_SYSTEM\cmd.exe") || Image.endsWith("\programdata\oracle\java.exe")
    || Image.endsWith("CSIDL_COMMON_APPDATA\comms\comms.exe") || Image.endsWith("\Programdata\VMware\Vmware.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3711eee4-a808-4849-8a14-faf733da3612_sysmon_ot"'
  description: Greenbug Campaign Indicators
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("attrib") && CommandLine.includes("
    +h ") && CommandLine.includes(" +s ") && CommandLine.includes(" +r ") && CommandLine.includes(".aspx"))
    || (CommandLine.includes("schtasks") && CommandLine.includes("VSPerfMon")) ||
    (CommandLine.includes("vssadmin list shadows") && CommandLine.includes("Temp\__output"))
    || CommandLine.includes("%TEMP%\execute.bat") || Image.endsWith("Users\Public\opera\Opera_browser.exe")
    || (Image.endsWith("Opera_browser.exe") && (ParentImage.endsWith("\services.exe")
    || ParentImage.endsWith("\svchost.exe"))) || Image.includes("\ProgramData\VSPerfMon\\")
    || (CommandLine.includes(" -t7z ") && CommandLine.includes("C:\Programdata\pst")
    && CommandLine.includes("\it.zip")) || (Image.endsWith("\makecab.exe") && (CommandLine.includes("Microsoft\Exchange
    Server\\") || CommandLine.includes("inetpub\wwwroot"))) || (CommandLine.includes("\Temp\xx.bat")
    || CommandLine.includes("Windows\WwanSvcdcs") || CommandLine.includes("Windows\Temp\cw.exe"))
    || (CommandLine.includes("\comsvcs.dll") && CommandLine.includes("Minidump") &&
    CommandLine.includes("\inetpub\wwwroot")) || (CommandLine.includes("dsquery")
    && CommandLine.includes(" -uco ") && CommandLine.includes("\inetpub\wwwroot"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bbb2dedd-a0e3-46ab-ba6c-6c82ae7a9aa7_sysmon_ot"'
  description: Exchange Exploitation Activity
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("localgroup") && CommandLine.includes("admin")
    && CommandLine.includes("/add")) || (CommandLine.includes("\Win64.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0eb2107b-a596-422e-b123-b389d5594ed7_sysmon_ot"'
  description: Hurricane Panda Activity
- id: eval
  filter: (EventID=="1" && (CommandLine.endsWith("eprod.ldf") || (CommandLine.includes("\ldifde.exe
    -f -n ") || CommandLine.includes("\7za.exe a 1.7z ") || CommandLine.includes("\aaaa\procdump64.exe")
    || CommandLine.includes("\aaaa\netsess.exe") || CommandLine.includes("\aaaa\7za.exe")
    || CommandLine.includes("copy .\1.7z \\") || CommandLine.includes("copy \\client\c$\aaaa\\"))
    || Image=="C:\Users\Public\7za.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"03e2746e-2b31-42f1-ab7a-eb39365b2422_sysmon_ot"'
  description: Judgement Panda Exfil Activity
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("-Property DWORD -name DisableFirstRunCustomize
    -value 2 -Force") || CommandLine.includes("-Property String -name Check_Associations
    -value") || CommandLine.includes("-Property DWORD -name IEHarden -value 0 -Force")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7b544661-69fc-419f-9a59-82ccc328f205_sysmon_ot"'
  description: Ke3chang Registry Key Modifications
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("mshta") && CommandLine.includes(".zip"))
    || ((ParentImage=="C:\Windows\System32\wbem\wmiprvse.exe") && (Image=="C:\Windows\System32\mshta.exe"))
    || ((ParentImage.includes(":\Users\Public\\")) && (Image=="C:\Windows\System32\rundll32.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4a12fa47-c735-4032-a214-6fab5b120670_sysmon_ot"'
  description: Lazarus Activity
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("reg.exe save hklm\sam %temp%\~reg_sam.save")
    || CommandLine.includes("1q2w3e4r@#$@#$@#$") || CommandLine.includes(" -hp1q2w3e4
    ") || CommandLine.includes(".dat data03 10000 -p ")) || (CommandLine.includes("process
    call create") && CommandLine.includes(" > %temp%\~")) || (CommandLine.includes("netstat
    -aon | find ") && CommandLine.includes(" > %temp%\~")) || (CommandLine.includes(".255
    10 C:\ProgramData\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"24c4d154-05a4-4b99-b57d-9b977472443a_sysmon_ot"'
  description: Lazarus Activity
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("cmd.exe /c ") && CommandLine.includes("
    -p 0x") && (CommandLine.includes("C:\ProgramData\\") || CommandLine.includes("C:\RECYCLER\\")))
    || (CommandLine.includes("rundll32.exe ") && CommandLine.includes("C:\ProgramData\\")
    && (CommandLine.includes(".bin,") || CommandLine.includes(".tmp,") || CommandLine.includes(".dat,")
    || CommandLine.includes(".io,") || CommandLine.includes(".ini,") || CommandLine.includes(".db,")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7b49c990-4a9a-4e65-ba95-47c9cc448f6e_sysmon_ot"'
  description: Lazarus Loaders
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\msdtc.exe") || Image.endsWith("\gpvc.exe"))
    &&  ! ((Image.startsWith("C:\Windows\System32\\") || Image.startsWith("C:\Windows\SysWOW64\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3f7f5b0b-5b16-476c-a85f-ab477f6dd24b_sysmon_ot"'
  description: Lazarus Session Highjacker
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("Temp\wtask.exe /create") || CommandLine.includes("%windir:~-3,1%%PUBLIC:~-9,1%")
    || CommandLine.includes("/tn "Security Script ") || CommandLine.includes("%windir:~-1,1%"))
    || (CommandLine.includes("/E:vbscript") && CommandLine.includes("C:\Users\\")
    && CommandLine.includes(".txt") && CommandLine.includes("/F")) || Image.endsWith("Temp\winwsh.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2d87d610-d760-45ee-a7e6-7a6f2a65de00_sysmon_ot"'
  description: Mustang Panda Dropper
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("C:\Windows\cert.exe") || CommandLine.includes("Set-MpPreference
    -DisableRealtimeMonitoring $true -DisableIntrusionPreventionSystem $true -DisableIOAVProtection
    $true -DisableScriptScanning $true -EnableControlledFolderAccess Disabled -EnableNetworkProtection
    AuditMode -Force -MAPSReporting Disabled") || CommandLine.includes("del /q /f
    c:\kworking\agent.crt") || CommandLine.includes("Kaseya VSA Agent Hot-fix") ||
    CommandLine.includes("\AppData\Local\Temp\MsMpEng.exe") || CommandLine.includes("rmdir
    /s /q %SystemDrive%\inetpub\logs") || CommandLine.includes("del /s /q /f %SystemDrive%\\*.log")
    || CommandLine.includes("c:\kworking1\agent.exe") || CommandLine.includes("c:\kworking1\agent.crt"))
    && (Image=="C:\Windows\MsMpEng.exe" || Image=="C:\Windows\cert.exe" || Image=="C:\kworking\agent.exe"
    || Image=="C:\kworking1\agent.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5de632bc-7fbd-4c8a-944a-fce55c59eae5_sysmon_ot"'
  description: REvil Kaseya Incident Malware Patterns
- id: eval
  filter: '(EventID=="1" && (CommandLine.includes("rundll32.exe") && CommandLine.includes("%APPDATA%\\"))
    && (CommandLine.includes(".dat",") || (CommandLine.endsWith(".dll",#1") || CommandLine.endsWith(".dll
    #1") || CommandLine.endsWith(".dll" #1"))))'
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ba778144-5e3d-40cf-8af9-e28fb1df1e20_sysmon_ot"'
  description: Sofacy Trojan Loader Activity
- id: eval
  filter: (EventID=="1" && CommandLine=="ps.exe -accepteula")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"18da1007-3f26-470f-875d-f77faf1cab31_sysmon_ot"'
  description: Ps.exe Renamed SysInternals Tool
- id: eval
  filter: (EventID=="1" && Image.endsWith("\mshta.exe") && ParentImage.endsWith("\wmiprvse.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"18cf6cf0-39b0-4c22-9593-e244bdc9a2d4_sysmon_ot"'
  description: TA505 Dropper Load Pattern
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("dll,MyStart") || CommandLine.includes("dll
    MyStart")) || ((CommandLine.endsWith(" MyStart")) && (CommandLine.includes("rundll32.exe")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d1aa3382-abab-446f-96ea-4de52908210b_sysmon_ot"'
  description: TAIDOOR RAT DLL Load
- id: eval
  filter: (EventID=="1" && CommandLine.includes("abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8c7090c3-e0a0-4944-bd08-08c3a0cecf79_sysmon_ot"'
  description: TropicTrooper Campaign November 2018
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("tracert -h 10 yahoo.com") || CommandLine.includes(".WSqmCons))|iex;")
    || CommandLine.includes("Fr`omBa`se6`4Str`ing")) || (CommandLine.includes("net
    use https://docs.live.net") && CommandLine.includes("@aol.co.uk"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9e2e51c5-c699-4794-ba5a-29f5da40ac0c_sysmon_ot"'
  description: Turla Group Commands May 2020
- id: eval
  filter: (EventID=="1" && (((((CommandLine.includes("7z.exe a -v500m -mx9 -r0 -p"))
    || (ParentCommandLine.includes("wscript.exe") && ParentCommandLine.includes(".vbs")
    && CommandLine.includes("rundll32.exe") && CommandLine.includes("C:\Windows")
    && CommandLine.includes(".dll,Tk_"))) || (ParentImage.endsWith("\rundll32.exe")
    && ParentCommandLine.includes("C:\Windows") && CommandLine.includes("cmd.exe /C
    "))) || (CommandLine.includes("rundll32 c:\windows\\") && CommandLine.includes(".dll
    "))) || ((ParentImage.endsWith("\rundll32.exe") && Image.endsWith("\dllhost.exe"))
    &&  ! ((CommandLine==" " || CommandLine=="")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9be34ad0-b6a7-4fbd-91cf-fc7ec1047f5f_sysmon_ot"'
  description: UNC2452 Process Creation Patterns
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("Invoke-WMIMethod win32_process
    -name create -argumentlist") && CommandLine.includes("rundll32 c:\windows")) ||
    (CommandLine.includes("wmic /node:") && CommandLine.includes("process call create
    "rundll32 c:\windows"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b7155193-8a81-4d8f-805d-88de864ca50c_sysmon_ot"'
  description: UNC2452 PowerShell Pattern
- id: eval
  filter: (EventID=="1" && CommandLine.includes("cyzfc.dat,") && CommandLine.endsWith("PointFunctionCall"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7453575c-a747-40b9-839b-125a0aae324b_sysmon_ot"'
  description: Unidentified Attacker November 2018
- id: eval
  filter: (EventID=="1" && (((ParentImage.includes("C:\Windows\Temp") || ParentImage.includes("\hpqhvind.exe"))
    && Image.startsWith("C:\ProgramData\DRM")) || (ParentImage.startsWith("C:\ProgramData\DRM")
    && Image.endsWith("\wmplayer.exe")) || (ParentImage.endsWith("\Test.exe") && Image.endsWith("\wmplayer.exe"))
    || Image=="C:\ProgramData\DRM\CLR\CLR.exe" || (ParentImage.startsWith("C:\ProgramData\DRM\Windows")
    && Image.endsWith("\SearchFilterHost.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3121461b-5aa0-4a41-b910-66d25524edbb_sysmon_ot"'
  description: Winnti Malware HK University Campaign
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("setup0.exe -p")) || (CommandLine.includes("setup.exe")
    && (CommandLine.endsWith("-x:0") || CommandLine.endsWith("-x:1") || CommandLine.endsWith("-x:2")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"73d70463-75c9-4258-92c6-17500fe972f2_sysmon_ot"'
  description: Winnti Pipemon Characteristics
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\rundll32.exe")) && (CommandLine.includes("zxFunction")
    || CommandLine.includes("RemoteDiskXXXXX")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f0b70adb-0075-43b0-9745-e82a1c608fcc_sysmon_ot"'
  description: ZxShell Malware
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\attrib.exe") && CommandLine.includes("
    +h ")) &&  ! ((CommandLine.includes("\desktop.ini ") || (ParentImage.endsWith("\cmd.exe")
    && CommandLine=="+R +H +S +A \\*.cui" && ParentCommandLine=="C:\WINDOWS\system32\\*.bat"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4281cb20-2994-4580-aa63-c8b86d019934_sysmon_ot"'
  description: Hiding Files with Attrib.exe
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\WerFault.exe") && CommandLine.endsWith("\WerFault.exe"))
    || (Image.endsWith("\rundll32.exe") && CommandLine.endsWith("\rundll32.exe"))
    || (Image.endsWith("\regsvcs.exe") && CommandLine.endsWith("\regsvcs.exe")) ||
    (Image.endsWith("\regasm.exe") && CommandLine.endsWith("\regasm.exe")) || (Image.endsWith("\regsvr32.exe")
    && CommandLine.endsWith("\regsvr32.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a7c3d773-caef-227e-a7e7-c2f13c622329_sysmon_ot"'
  description: Bad Opsec Defaults Sacrificial Processes With Improper Arguments
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\bcdedit.exe") && CommandLine.includes("set"))
    && ((CommandLine.includes("bootstatuspolicy") && CommandLine.includes("ignoreallfailures"))
    || (CommandLine.includes("recoveryenabled") && CommandLine.includes("no"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1444443e-6757-43e4-9ea4-c8fc705f79a2_sysmon_ot"'
  description: Modification of Boot Configuration
- id: eval
  filter: (EventID=="1" && CommandLine.includes("http") && (((Image.endsWith("\wmic.exe"))
    && CommandLine.includes("wmic") && CommandLine.includes("format")) || ((Imphash=="1B1A3F43BF37B5BFE60751F2EE2F326E"
    || Imphash=="37777A96245A3C74EB217308F3546F4C" || Imphash=="9D87C9D67CE724033C0B40CC4CA1B206")
    && CommandLine.includes("format:"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8d63dadf-b91b-4187-87b6-34a1114577ea_sysmon_ot"'
  description: SquiblyTwo
- id: eval
  filter: (EventID=="1" && CommandLine.includes("cmd") && CommandLine.includes("/c")
    && CommandLine.includes("assoc"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3d3aa6cd-6272-44d6-8afc-7e88dfef7061_sysmon_ot"'
  description: Change Default File Association
- id: eval
  filter: (EventID=="1" && CommandLine.includes("CL_Invocation.ps1") && CommandLine.includes("SyncInvoke"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a0459f02-ac51-4c09-b511-b8c9203fc429_sysmon_ot"'
  description: Execution via CL_Invocation.ps1
- id: eval
  filter: (EventID=="1" && CommandLine.includes("CL_Mutexverifiers.ps1") && CommandLine.includes("runAfterCancelProcess"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"99465c8f-f102-4157-b11c-b0cddd53b79a_sysmon_ot"'
  description: Execution via CL_Mutexverifiers.ps1
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cmdkey.exe") && CommandLine.includes("
    /list"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"07f8bdc2-c9b3-472a-9817-5a670b872f53_sysmon_ot"'
  description: Cmdkey Cached Credentials Recon
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\DllHost.exe") && (IntegrityLevel=="High"
    || IntegrityLevel=="System") && (ParentCommandLine.includes(" /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}")
    || ParentCommandLine.includes(" /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}")
    || ParentCommandLine.includes(" /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}")
    || ParentCommandLine.includes(" /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}")
    || ParentCommandLine.includes(" /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4b60e6f2-bf39-47b4-b4ea-398e33cfe253_sysmon_ot"'
  description: CMSTP UAC Bypass via COM Object Access
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("\cmd.exe /C whoami") && ParentImage.startsWith("C:\Temp"))
    || (CommandLine.includes("conhost.exe 0xffffffff -ForceV1") && (ParentCommandLine.includes("/C
    whoami") || ParentCommandLine.includes("cmd.exe /C echo") || ParentCommandLine.includes("
    > \\.\pipe"))) || ((CommandLine.includes("cmd.exe /c echo") || CommandLine.includes(">
    \\.\pipe") || CommandLine.includes("\whoami.exe")) && ParentImage.endsWith("\dllhost.exe"))
    || (Image.endsWith("\cmd.exe") && ParentImage.endsWith("\runonce.exe") && ParentCommandLine.endsWith("\runonce.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f35c5d71-b489-4e22-a115-f003df287317_sysmon_ot"'
  description: CobaltStrike Process Patterns
- id: eval
  filter: (EventID=="1" && ParentCommandLine.includes("cmd") && ParentCommandLine.includes("/c")
    && CommandLine.includes("/../../"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"087790e3-3287-436c-bccf-cbd0184a7db1_sysmon_ot"'
  description: Cmd.exe CommandLine Path Traversal
- id: eval
  filter: (EventID=="1" && ((Image.includes("\Windows\\") && (CommandLine.includes("\..\Windows\\")
    || CommandLine.includes("\..\System32\\") || CommandLine.includes("\..\..\\")))
    || CommandLine.includes(".exe\..\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1327381e-6ab0-4f38-b583-4c1b8346a56b_sysmon_ot"'
  description: Command Line Path Traversal Evasion
- id: eval
  filter: (EventID=="1" && ((CommandLine.endsWith(".cpl") &&  ! ((CommandLine.includes("\System32\\")
    || CommandLine.includes("%System%")))) || (Image.endsWith("\reg.exe") && CommandLine.includes("add")
    && (CommandLine.includes("CurrentVersion\\Control Panel\\CPLs")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0ba863e6-def5-4e50-9cea-4dd8c7dc46a4_sysmon_ot"'
  description: Control Panel Items
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\esentutl.exe") && (CommandLine.includes("vss")
    || CommandLine.includes(" /m ") || CommandLine.includes(" /y "))) || (CommandLine.includes("\windows\ntds\ntds.dit")
    || CommandLine.includes("\config\sam") || CommandLine.includes("\config\security")
    || CommandLine.includes("\config\system ") || CommandLine.includes("\repair\sam")
    || CommandLine.includes("\repair\system") || CommandLine.includes("\repair\security")
    || CommandLine.includes("\config\RegBack\sam") || CommandLine.includes("\config\RegBack\system")
    || CommandLine.includes("\config\RegBack\security"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e7be6119-fc37-43f0-ad4f-1f3f99be2f9f_sysmon_ot"'
  description: Copying Sensitive Files with Credential Data
- id: eval
  filter: (EventID=="1" && CommandLine.includes("HKLM\SYSTEM\CurrentControlSet\Control\Lsa")
    && CommandLine.includes("scecli\0") && CommandLine.includes("reg add"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b7966f4a-b333-455b-8370-8ca53c229762_sysmon_ot"'
  description: Dropping Of Password Filter DLL
- id: eval
  filter: (EventID=="1" && CommandLine.includes("rundll32.exe") && CommandLine.includes("InstallArcherSvc"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3d4aebe0-6d29-45b2-a8a4-3dfde586a26d_sysmon_ot"'
  description: Fireball Archer Install
- id: eval
  filter: (EventID=="1" && (((ParentImage.endsWith("\WINWORD.exe")) && (Image.endsWith(".tmp")))
    || (Image.endsWith("\wmic.exe") && ParentImage.includes("\Temp\\") && CommandLine.endsWith("shadowcopy
    delete")) || (CommandLine.endsWith("shadowcopy delete") && CommandLine.includes("\..\..\system32"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"29fd07fc-9cfd-4331-b7fd-cc18dfa21052_sysmon_ot"'
  description: Maze Ransomware
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("shutdown /r /f /t 00") || CommandLine.includes("net
    stop SuperBackupMan")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5325945e-f1f0-406e-97b8-65104d393fff_sysmon_ot"'
  description: Snatch Ransomware
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" --cpu-priority=") || CommandLine.includes("--donate-level=0")
    || CommandLine.includes(" -o pool.") || CommandLine.includes(" --nicehash") ||
    CommandLine.includes(" --algo=rx/0 ") || CommandLine.includes("stratum+tcp://")
    || CommandLine.includes("stratum+udp://") || CommandLine.includes("LS1kb25hdGUtbGV2ZWw9")
    || CommandLine.includes("0tZG9uYXRlLWxldmVsP") || CommandLine.includes("tLWRvbmF0ZS1sZXZlbD")
    || CommandLine.includes("c3RyYXR1bSt0Y3A6Ly") || CommandLine.includes("N0cmF0dW0rdGNwOi8v")
    || CommandLine.includes("zdHJhdHVtK3RjcDovL") || CommandLine.includes("c3RyYXR1bSt1ZHA6Ly")
    || CommandLine.includes("N0cmF0dW0rdWRwOi8v") || CommandLine.includes("zdHJhdHVtK3VkcDovL")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"66c3b204-9f88-4d0a-a7f7-8a57d521ca55_sysmon_ot"'
  description: Windows Crypto Mining Indicators
- id: eval
  filter: (EventID=="1" && Image.endsWith("\rar.exe") && CommandLine.includes(" a
    "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6f3e2987-db24-4c78-a860-b4f4095a7095_sysmon_ot"'
  description: Data Compressed - rar.exe
- id: eval
  filter: (EventID=="1" && Image.endsWith("\xwizard.exe") &&  ! (Image.startsWith("C:\Windows\System32\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"193d5ccd-6f59-40c6-b5b0-8e32d5ddd3d1_sysmon_ot"'
  description: Xwizard DLL Sideloading
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\iodine.exe") || Image.includes("\dnscat2")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"98a96a5a-64a0-4c42-92c5-489da3866cb0_sysmon_ot"'
  description: DNS Exfiltration and Tunneling Tools Execution
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("OjpGcm9tQmFzZTY0U3RyaW5n") || CommandLine.includes("o6RnJvbUJhc2U2NFN0cmluZ")
    || CommandLine.includes("6OkZyb21CYXNlNjRTdHJpbm")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c_sysmon_ot"'
  description: Encoded FromBase64String
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("SUVYIChb") || CommandLine.includes("lFWCAoW")
    || CommandLine.includes("JRVggKF") || CommandLine.includes("aWV4IChb") || CommandLine.includes("lleCAoW")
    || CommandLine.includes("pZXggKF") || CommandLine.includes("aWV4IChOZX") || CommandLine.includes("lleCAoTmV3")
    || CommandLine.includes("pZXggKE5ld") || CommandLine.includes("SUVYIChOZX") ||
    CommandLine.includes("lFWCAoTmV3") || CommandLine.includes("JRVggKE5ld")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"88f680b8-070e-402c-ae11-d2914f2257f1_sysmon_ot"'
  description: Encoded IEX
- id: eval
  filter: (EventID=="1" && CommandLine.includes("COMPlus_ETWEnabled=0"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"41421f44-58f9-455d-838a-c398859841d4_sysmon_ot"'
  description: COMPlus_ETWEnabled Command Line Arguments
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("cl") && CommandLine.includes("/Trace"))
    || (CommandLine.includes("clear-log") && CommandLine.includes("/Trace")) || (CommandLine.includes("sl")
    && CommandLine.includes("/e:false")) || (CommandLine.includes("set-log") && CommandLine.includes("/e:false"))
    || (CommandLine.includes("Remove-EtwTraceProvider") && CommandLine.includes("EventLog-Microsoft-Windows-WMI-Activity-Trace")
    && CommandLine.includes("{1418ef04-b0b4-4623-bf7e-d74ab47bbdaa}")) || (CommandLine.includes("Set-EtwTraceProvider")
    && CommandLine.includes("{1418ef04-b0b4-4623-bf7e-d74ab47bbdaa}") && CommandLine.includes("EventLog-Microsoft-Windows-WMI-Activity-Trace")
    && CommandLine.includes("0x11")) || (CommandLine.includes("logman") && CommandLine.includes("update")
    && CommandLine.includes("trace") && CommandLine.includes("--p") && CommandLine.includes("-ets"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a238b5d0-ce2d-4414-a676-7a531b3d13d6_sysmon_ot"'
  description: Disable of ETW Trace
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\plink.exe") || Image.endsWith("\socat.exe")
    || Image.endsWith("\stunnel.exe") || Image.endsWith("\httptunnel.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c75309a3-59f8-4a8d-9c2c-4c927ad50555_sysmon_ot"'
  description: Exfiltration and Tunneling Tools Execution
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\WINWORD.EXE") && Image.endsWith("\MicroScMgmt.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7993792c-5ce2-4475-a3db-a3a5539827ef_sysmon_ot"'
  description: Exploit for CVE-2015-1641
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\WINWORD.EXE") && Image.includes("\FLTLDR.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"864403a1-36c9-40a2-a982-4c9a45f7d833_sysmon_ot"'
  description: Exploit for CVE-2017-0261
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\EQNEDT32.EXE"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"678eb5f4-8597-4be6-8be7-905e4234b53a_sysmon_ot"'
  description: Droppers Exploiting CVE-2017-11882
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\WINWORD.EXE") && Image.endsWith("\csc.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fdd84c68-a1f6-47c9-9477-920584f94905_sysmon_ot"'
  description: Exploit for CVE-2017-8759
- id: eval
  filter: (EventID=="1" && (ParentCommandLine.includes("\cmd.exe") && ParentCommandLine.includes("/c")
    && ParentCommandLine.includes("C:\Windows\Setup\Scripts\\") && (ParentCommandLine.endsWith("SetupComplete.cmd")
    || ParentCommandLine.endsWith("PartnerSetupComplete.cmd"))) &&  ! ((Image.startsWith("C:\Windows\System32\\")
    || Image.startsWith("C:\Windows\SysWOW64\\") || Image.startsWith("C:\Windows\WinSxS\\")
    || Image.startsWith("C:\Windows\Setup\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1c373b6d-76ce-4553-997d-8c1da9a6b5f5_sysmon_ot"'
  description: Exploiting SetupComplete.cmd CVE-2019-1378
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\consent.exe") && Image.endsWith("\iexplore.exe")
    && CommandLine.includes(" http")) && (IntegrityLevel=="System" || (User.startsWith("NT
    AUTHORITY\SYSTEM") || User.startsWith("AUTORITE NT\Sys"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"02e0b2ea-a597-428e-b04a-af6a1a403e5c_sysmon_ot"'
  description: Exploiting CVE-2019-1388
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("DesktopCentral_Server\jre\bin\java.exe")
    && (Image.endsWith("\cmd.exe") || Image.endsWith("\powershell.exe") || Image.endsWith("\bitsadmin.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"846b866e-2a57-46ee-8e16-85fa92759be7_sysmon_ot"'
  description: Exploited CVE-2020-10189 Zoho ManageEngine
- id: eval
  filter: (EventID=="1" && (((CommandLine.includes("Add-PrinterPort -Name")) && (CommandLine.includes(".exe")
    || CommandLine.includes(".dll") || CommandLine.includes(".bat"))) || (CommandLine.includes("Generic
    / Text Only"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cc08d590-8b90-413a-aff6-31d1a99678d7_sysmon_ot"'
  description: Suspicious PrinterPorts Creation (CVE-2020-1048)
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\System32\dns.exe") &&  ! ((Image.endsWith("\System32\werfault.exe")
    || Image.endsWith("\System32\conhost.exe") || Image.endsWith("\System32\dnscmd.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b5281f31-f9cc-4d0d-95d0-45b91c45b487_sysmon_ot"'
  description: DNS RCE CVE-2020-1350
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cmd.exe") && ParentImage.endsWith("\elevation_service.exe")
    && IntegrityLevel=="System")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"af8bbce4-f751-46b4-8d91-82a33a736f61_sysmon_ot"'
  description: Possible InstallerFileTakeOver LPE CVE-2021-41379
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("printnightmare.gentilkiwi.com")
    || CommandLine.includes(" /user:gentilguest ") || CommandLine.includes("Kiwi Legit
    Printer")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c01f7bd6-0c1d-47aa-9c61-187b91273a16_sysmon_ot"'
  description: SystemNightmare Exploitation Script Execution
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\takeown.exe") || Image.endsWith("\cacls.exe")
    || Image.endsWith("\icacls.exe")) && CommandLine.includes("/grant")) || (Image.endsWith("\attrib.exe")
    && CommandLine.includes("-r"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"37ae075c-271b-459b-8d7b-55ad5f993dd8_sysmon_ot"'
  description: File or Folder Permissions Modifications
- id: eval
  filter: "(EventID==\"1\" && Image.endsWith(\"\\reg.exe\") && (CommandLine.includes(\"\
    save\") || CommandLine.includes(\"export\") || CommandLine.includes(\"\u02E2ave\"\
    ) || CommandLine.includes(\"e\u02E3port\")) && (CommandLine.includes(\"hklm\"\
    ) || CommandLine.includes(\"hk\u02EAm\") || CommandLine.includes(\"hkey_local_machine\"\
    ) || CommandLine.includes(\"hkey_\u02EAocal_machine\") || CommandLine.includes(\"\
    hkey_loca\u02EA_machine\") || CommandLine.includes(\"hkey_\u02EAoca\u02EA_machine\"\
    )) && (CommandLine.endsWith(\"\\system\") || CommandLine.endsWith(\"\\sam\") ||\
    \ CommandLine.endsWith(\"\\security\") || CommandLine.endsWith(\"\\\u02E2ystem\"\
    ) || CommandLine.endsWith(\"\\sy\u02E2tem\") || CommandLine.endsWith(\"\\\u02E2\
    y\u02E2tem\") || CommandLine.endsWith(\"\\\u02E2am\") || CommandLine.endsWith(\"\
    \\\u02E2ecurity\")))"
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fd877b94-9bb5-4191-bb25-d79cbd93c167_sysmon_ot"'
  description: Grabbing Sensitive Hives via Reg Utility
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" --adcs ") && CommandLine.includes("
    --port "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd8c163e-a19b-402e-bdd5-419ff5859f12_sysmon_ot"'
  description: ADCSPwn Hack Tool
- id: eval
  filter: (EventID=="1" && ((Image.includes("\Bloodhound.exe") || Image.includes("\SharpHound.exe"))
    || (CommandLine.includes(" -CollectionMethod All ") || CommandLine.includes(".exe
    -c All -d ") || CommandLine.includes("Invoke-Bloodhound") || CommandLine.includes("Get-BloodHoundData"))
    || (CommandLine.includes(" -JsonFolder ") && CommandLine.includes(" -ZipFileName
    ")) || (CommandLine.includes(" DCOnly ") && CommandLine.includes(" --NoSaveCache
    "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f376c8a7-a2d0-4ddc-aa0c-16c17236d962_sysmon_ot"'
  description: Bloodhound and Sharphound Hack Tool
- id: eval
  filter: (EventID=="1" && CommandLine.includes("-u ") && CommandLine.includes("-p
    ") && (CommandLine.includes("^USER^") || CommandLine.includes("^PASS^")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aaafa146-074c-11eb-adc1-0242ac120002_sysmon_ot"'
  description: Hydra Password Guessing Hack Tool
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cmd.exe") && CommandLine.includes("/q")
    && CommandLine.includes("/c") && CommandLine.includes("chcp"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5cddf373-ef00-4112-ad72-960ac29bac34_sysmon_ot"'
  description: Koadic Execution
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" asreproast ") || CommandLine.includes("
    dump /service:krbtgt ") || CommandLine.includes(" kerberoast ") || CommandLine.includes("
    createnetonly /program:") || CommandLine.includes(" ptt /ticket:") || CommandLine.includes("
    /impersonateuser:") || CommandLine.includes(" renew /ticket:") || CommandLine.includes("
    asktgt /user:") || CommandLine.includes(" harvest /interval:") || CommandLine.includes("
    s4u /user:") || CommandLine.includes(" s4u /ticket:") || CommandLine.includes("
    hash /password:")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7ec2c172-dceb-4c10-92c9-87c1881b7e18_sysmon_ot"'
  description: Rubeus Hack Tool
- id: eval
  filter: (EventID=="1" && (Company=="SecurityXploded" || Image.endsWith("PasswordDump.exe")
    || OriginalFileName.endsWith("PasswordDump.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7679d464-4f74-45e2-9e01-ac66c5eb041a_sysmon_ot"'
  description: SecurityXploded Tool
- id: eval
  filter: (EventID=="1" && Image.endsWith("\hh.exe") && CommandLine.includes(".chm"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"68c8acb4-1b60-4890-8e82-3ddf7a6dba84_sysmon_ot"'
  description: HH.exe Execution
- id: eval
  filter: (EventID=="1" && (Image.includes("\CreateMiniDump.exe") || Imphash=="4a07f944a83e8a7c2525efa35dd30e2f"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"36d88494-1d43-4dc0-b3fa-35c8fea0ca9d_sysmon_ot"'
  description: CreateMiniDump Hacktool
- id: eval
  filter: (EventID=="1" && (Product=="UACMe" || Company=="REvol Corp" || OriginalFileName=="Akagi.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d38d2fa4-98e6-4a24-aff1-410b0c9ad177_sysmon_ot"'
  description: UAC Bypass Tool UACMe
- id: eval
  filter: (EventID=="1" && ParentImage=="C:\Windows\hh.exe" && (Image.endsWith("\cmd.exe")
    || Image.endsWith("\powershell.exe") || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\regsvr32.exe") || Image.endsWith("\wmic.exe") || Image.endsWith("\rundll32.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"52cad028-0ff0-4854-8f67-d25dfcbc78b4_sysmon_ot"'
  description: HTML Help Shell Spawn
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\Hwp.exe") && Image.endsWith("\gbb.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"023394c4-29d5-46ab-92b8-6a534c6f447b_sysmon_ot"'
  description: Suspicious HWP Sub Processes
- id: eval
  filter: (EventID=="1" && ((Image.includes("\goldenPac") || Image.includes("\karmaSMB")
    || Image.includes("\kintercept") || Image.includes("\ntlmrelayx") || Image.includes("\rpcdump")
    || Image.includes("\samrdump") || Image.includes("\secretsdump") || Image.includes("\smbexec")
    || Image.includes("\smbrelayx") || Image.includes("\wmiexec") || Image.includes("\wmipersist"))
    || (Image.endsWith("\atexec_windows.exe") || Image.endsWith("\dcomexec_windows.exe")
    || Image.endsWith("\dpapi_windows.exe") || Image.endsWith("\findDelegation_windows.exe")
    || Image.endsWith("\GetADUsers_windows.exe") || Image.endsWith("\GetNPUsers_windows.exe")
    || Image.endsWith("\getPac_windows.exe") || Image.endsWith("\getST_windows.exe")
    || Image.endsWith("\getTGT_windows.exe") || Image.endsWith("\GetUserSPNs_windows.exe")
    || Image.endsWith("\ifmap_windows.exe") || Image.endsWith("\mimikatz_windows.exe")
    || Image.endsWith("\netview_windows.exe") || Image.endsWith("\nmapAnswerMachine_windows.exe")
    || Image.endsWith("\opdump_windows.exe") || Image.endsWith("\psexec_windows.exe")
    || Image.endsWith("\rdp_check_windows.exe") || Image.endsWith("\sambaPipe_windows.exe")
    || Image.endsWith("\smbclient_windows.exe") || Image.endsWith("\smbserver_windows.exe")
    || Image.endsWith("\sniffer_windows.exe") || Image.endsWith("\sniff_windows.exe")
    || Image.endsWith("\split_windows.exe") || Image.endsWith("\ticketer_windows.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4627c6ae-6899-46e2-aa0c-6ebcb1becd19_sysmon_ot"'
  description: Impacket Tool Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("cmd.exe") && CommandLine.includes("&1")
    && (((ParentImage.endsWith("\wmiprvse.exe") || ParentImage.endsWith("\mmc.exe")
    || ParentImage.endsWith("\explorer.exe") || ParentImage.endsWith("\services.exe"))
    && CommandLine.includes("/Q") && CommandLine.includes("/c") && CommandLine.includes("\\\\127.0.0.1\\"))
    || ((ParentCommandLine.includes("svchost.exe -k netsvcs") || ParentCommandLine.includes("taskeng.exe"))
    && CommandLine.includes("/C") && CommandLine.includes("Windows\Temp\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"10c14723-61c7-4c75-92ca-9af245723ad2_sysmon_ot"'
  description: Impacket Lateralization Detection
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\pcalua.exe") || ParentImage.endsWith("\forfiles.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fa47597e-90e9-41cd-ab72-c3b74cfb0d02_sysmon_ot"'
  description: Indirect Command Execution
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\pcwrun.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b97cd4b1-30b8-4a9d-bd72-6293928d52bc_sysmon_ot"'
  description: Indirect Command Execution By Program Compatibility Wizard
- id: eval
  filter: (EventID=="1" && CommandLine.includes("\CurrentVersion\Image File Execution
    Options\\") && (CommandLine.includes("sethc.exe") || CommandLine.includes("utilman.exe")
    || CommandLine.includes("osk.exe") || CommandLine.includes("magnify.exe") || CommandLine.includes("narrator.exe")
    || CommandLine.includes("displayswitch.exe") || CommandLine.includes("atbroker.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ae215552-081e-44c7-805f-be16f975c8a2_sysmon_ot"'
  description: Suspicious Debugger Registration Cmdline
- id: eval
  filter: (EventID=="1" && Image.endsWith("\at.exe") && CommandLine.includes("interactive"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"60fc936d-2eb0-4543-8a13-911c750a1dfc_sysmon_ot"'
  description: Interactive AT Job
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\svchost.exe") && Image.endsWith("\mshta.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ed5d72a6-f8f4-479d-ba79-02f6a80d7471_sysmon_ot"'
  description: MSHTA Spwaned by SVCHOST
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\whoami.exe") || (Image.endsWith("\wmic.exe")
    && CommandLine.includes("useraccount") && CommandLine.includes("get")) || (Image.endsWith("\quser.exe")
    || Image.endsWith("\qwinsta.exe")) || (Image.endsWith("\cmdkey.exe") && CommandLine.includes("/list"))
    || (Image.endsWith("\cmd.exe") && CommandLine.includes("/c") && CommandLine.includes("dir
    ") && CommandLine.includes("\Users\\"))) &&  ! ((CommandLine.includes(" rmdir
    ")))) || (((Image.endsWith("\net.exe") || Image.endsWith("\net1.exe")) && CommandLine.includes("user"))
    &&  ! ((CommandLine.includes("/domain") || CommandLine.includes("/add") || CommandLine.includes("/delete")
    || CommandLine.includes("/active") || CommandLine.includes("/expires") || CommandLine.includes("/passwordreq")
    || CommandLine.includes("/scriptpath") || CommandLine.includes("/times") || CommandLine.includes("/workstations"))))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"502b42de-4306-40b4-9596-6f590c81f073_sysmon_ot"'
  description: Local Accounts Discovery
- id: eval
  filter: (EventID=="1" && CommandLine.includes("cscript.exe") && CommandLine.includes("gatherNetworkInfo.vbs"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"575dce0c-8139-4e30-9295-1ee75969f7fe_sysmon_ot"'
  description: GatherNetworkInfo.vbs Script Usage
- id: eval
  filter: (EventID=="1" && CommandLine.includes("winget") && CommandLine.includes("install")
    && (CommandLine.includes("-m ") || CommandLine.includes("--manifest")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"313d6012-51a0-4d93-8dfc-de8553239e25_sysmon_ot"'
  description: Monitoring Winget For LOLbin Execution
- id: eval
  filter: (EventID=="1" && (((CommandLine.includes("lsass") && CommandLine.includes(".dmp"))
    &&  ! (Image.endsWith("\werfault.exe"))) || (Image.includes("\procdump") && Image.endsWith(".exe")
    && CommandLine.includes("lsass"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ffa6861c-4461-4f59-8a41-578c39f3f23e_sysmon_ot"'
  description: LSASS Memory Dumping
- id: eval
  filter: (EventID=="1" && CommandLine.includes("vssadmin list shadows") && CommandLine.includes("log.txt"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7b30e0a7-c675-4b24-8a46-82fa67e2433d_sysmon_ot"'
  description: Conti Volume Shadow Listing
- id: eval
  filter: (EventID=="1" && CommandLine.includes("7za.exe") && CommandLine.includes("\\C$\\temp\\log.zip"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aa92fd02-09f2-48b0-8a93-864813fb8f41_sysmon_ot"'
  description: Conti Volume Shadow Listing
- id: eval
  filter: (EventID=="1" && CommandLine.includes("\\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy")
    && (CommandLine.includes("\\NTDS.dit") || CommandLine.includes("\\SYSTEM") ||
    CommandLine.includes("\\SECURITY") || CommandLine.includes("C:\\tmp\\log")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f57f8d16-1f39-4dcb-a604-6c73d9b54b3d_sysmon_ot"'
  description: Conti Volume Shadow Listing
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\svchost.exe") && CommandLine.includes("C:\Users\\")
    && CommandLine.includes("\Desktop\\")) || (ParentImage.endsWith("\svchost.exe")
    && ((Image.endsWith("\whoami.exe") && CommandLine.includes("all")) || ((Image.endsWith("\net.exe")
    || Image.endsWith("\net1.exe")) && CommandLine.includes("view"))))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e6eb5a96-9e6f-4a18-9cdd-642cfda21c8e_sysmon_ot"'
  description: Dridex Process Pattern
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" echo EEEE > "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f1531fa4-5b84-4342-8f68-9cf3fdbd83d4_sysmon_ot"'
  description: DTRACK Process Creation
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" -e* PAA") || CommandLine.includes("JABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQ")
    || CommandLine.includes("QAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUA") || CommandLine.includes("kAGUAbgB2ADoAdQBzAGUAcgBwAHIAbwBmAGkAbABlA")
    || CommandLine.includes("IgAoACcAKgAnACkAOwAkA") || CommandLine.includes("IAKAAnACoAJwApADsAJA")
    || CommandLine.includes("iACgAJwAqACcAKQA7ACQA") || CommandLine.includes("JABGAGwAeAByAGgAYwBmAGQ")
    || CommandLine.includes("PQAkAGUAbgB2ADoAdABlAG0AcAArACgA") || CommandLine.includes("0AJABlAG4AdgA6AHQAZQBtAHAAKwAoA")
    || CommandLine.includes("9ACQAZQBuAHYAOgB0AGUAbQBwACsAKA")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d02e8cf5-6099-48cf-9bfc-1eec2d0c7b18_sysmon_ot"'
  description: Emotet Process Creation
- id: eval
  filter: (EventID=="1" && (ParentCommandLine.startsWith("C:\Windows\System32\\")
    || ParentCommandLine.startsWith("C:\Windows\SysWOW64\\")) && (ParentCommandLine.endsWith(".exe"))
    && CommandLine.includes("C:\Users\\") && ((CommandLine.includes("/c") && CommandLine.includes("del")
    && CommandLine.includes("\AppData\Local\Temp\\")) || (CommandLine.includes("/c")
    && CommandLine.includes("del") && CommandLine.includes("\Desktop\\")) || (CommandLine.includes("/C")
    && CommandLine.includes("type nul >") && CommandLine.includes("\Desktop\\")))
    && CommandLine.endsWith(".exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"032f5fb3-d959-41a5-9263-4173c802dc2b_sysmon_ot"'
  description: Formbook Process Creation
- id: eval
  filter: '(EventID=="1" && ((CommandLine.includes("\AppData\Local\Temp\\") && CommandLine.includes("\\.\pipe\\\"))
    || (Image.endsWith("\rundll32.exe") && (CommandLine.endsWith(".dat,#1") || CommandLine.endsWith(".dat
    #1"))) || "\perfc.dat"))'
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"79aeeb41-8156-4fac-a0cd-076495ab82a1_sysmon_ot"'
  description: NotPetya Ransomware Activity
- id: eval
  filter: (EventID=="1" && (((ParentImage.endsWith("\WinRAR.exe") && Image.endsWith("\wscript.exe"))
    || CommandLine.includes(" /c ping.exe -n 6 127.0.0.1 & type ")) || (CommandLine.includes("regsvr32.exe")
    && CommandLine.includes("C:\ProgramData") && CommandLine.includes(".tmp"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4fcac6eb-0287-4090-8eea-2602e4c20040_sysmon_ot"'
  description: QBot Process Creation
- id: eval
  filter: (EventID=="1" && CommandLine.includes("Microsoft\Windows\CurrentVersion\Run")
    && CommandLine.includes("C:\users\Public\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c37510b8-2107-4b78-aa32-72f251e7a844_sysmon_ot"'
  description: Ryuk Ransomware
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe"))
    && (CommandLine.includes("C:\Users\\") || CommandLine.includes("C:\ProgramData\\"))
    && (CommandLine.includes(".jse") || CommandLine.includes(".vbe") || CommandLine.includes(".js")
    || CommandLine.includes(".vba") || CommandLine.includes(".vbs"))) &&  ! (ParentImage.includes("\winzip")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cea72823-df4d-4567-950c-0b579eaf0846_sysmon_ot"'
  description: WScript or CScript Dropper
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\cmd.exe")) && (Image.endsWith("\nltest.exe"))
    && (CommandLine.includes("/domain_trusts /all_trusts")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"410ad193-a728-4107-bc79-4419789fcbf8_sysmon_ot"'
  description: Trickbot Malware Recon Activity
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\wermgr.exe")) && (ParentImage.endsWith("\rundll32.exe"))
    && (ParentCommandLine.includes("DllRegisterServer")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"58bf96d9-ff5f-44bd-8dcc-1c4f79bf3a27_sysmon_ot"'
  description: Trickbot Malware Activity
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\tasksche.exe") || Image.endsWith("\mssecsvc.exe")
    || Image.endsWith("\taskdl.exe") || Image.endsWith("\taskhsvc.exe") || Image.endsWith("\taskse.exe")
    || Image.endsWith("\111.exe") || Image.endsWith("\lhdfrgui.exe") || Image.endsWith("\diskpart.exe")
    || Image.endsWith("\linuxnew.exe") || Image.endsWith("\wannacry.exe")) || Image.includes("WanaDecryptor")
    || (CommandLine.includes("icacls") && CommandLine.includes("/grant") && CommandLine.includes("Everyone:F")
    && CommandLine.includes("/T") && CommandLine.includes("/C") && CommandLine.includes("/Q"))
    || (CommandLine.includes("bcdedit") && CommandLine.includes("/set") && CommandLine.includes("{default}")
    && CommandLine.includes("recoveryenabled") && CommandLine.includes("no")) || (CommandLine.includes("wbadmin")
    && CommandLine.includes("delete") && CommandLine.includes("catalog") && CommandLine.includes("-quiet"))
    || CommandLine.includes("@Please_Read_Me@.txt")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"41d40bff-377a-43e2-8e1b-2e543069e079_sysmon_ot"'
  description: WannaCry Ransomware
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("\AppData\Roaming\Oracle") && CommandLine.includes("\java")
    && CommandLine.includes(".exe ")) || (CommandLine.includes("cscript.exe") && CommandLine.includes("Retrive")
    && CommandLine.includes(".vbs "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1fac1481-2dbc-48b2-9096-753c49b4ec71_sysmon_ot"'
  description: Adwind RAT / JRAT
- id: eval
  filter: (EventID=="1" && CommandLine.includes("cscript") && CommandLine.includes("manage-bde.wsf"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c363385c-f75d-4753-a108-c1a8e28bdbda_sysmon_ot"'
  description: Suspicious Usage of the Manage-bde.wsf Script
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" /INJECTRUNNING "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"17eb8e57-9983-420d-ad8a-2c4976c22eb8_sysmon_ot"'
  description: MavInject Process Injection
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\services.exe") && ((CommandLine.includes("cmd")
    && CommandLine.includes("/c") && CommandLine.includes("echo") && CommandLine.includes("\pipe\\"))
    || (CommandLine.includes("%COMSPEC%") && CommandLine.includes("/c") && CommandLine.includes("echo")
    && CommandLine.includes("\pipe\\")) || (CommandLine.includes("cmd.exe") && CommandLine.includes("/c")
    && CommandLine.includes("echo") && CommandLine.includes("\pipe\\")) || (CommandLine.includes("rundll32")
    && CommandLine.includes(".dll,a") && CommandLine.includes("/p:")))) &&  ! (CommandLine.includes("MpCmdRun")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"15619216-e993-4721-b590-4c520615a67d_sysmon_ot"'
  description: Meterpreter or Cobalt Strike Getsystem Service Start
- id: eval
  filter: (EventID=="1" && (((CommandLine.includes("DumpCreds") || CommandLine.includes("invoke-mimikatz"))
    || ((CommandLine.includes("rpc") || CommandLine.includes("token") || CommandLine.includes("crypto")
    || CommandLine.includes("dpapi") || CommandLine.includes("sekurlsa") || CommandLine.includes("kerberos")
    || CommandLine.includes("lsadump") || CommandLine.includes("privilege") || CommandLine.includes("process")
    || CommandLine.includes("vault")) && (CommandLine.includes("::")))) || ((CommandLine.includes("aadcookie")
    || CommandLine.includes("detours") || CommandLine.includes("memssp") || CommandLine.includes("mflt")
    || CommandLine.includes("ncroutemon") || CommandLine.includes("ngcsign") || CommandLine.includes("printnightmare")
    || CommandLine.includes("skeleton") || CommandLine.includes("preshutdown") ||
    CommandLine.includes("mstsc") || CommandLine.includes("multirdp")) && (CommandLine.includes("::")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a642964e-bead-4bed-8910-1bb4d63e3b4d_sysmon_ot"'
  description: Mimikatz Command Line
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\svchost.exe") && Image.endsWith("\mmc.exe")
    && CommandLine.includes("-Embedding"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f1f3bf22-deb2-418d-8cce-e1a45e46a5bd_sysmon_ot"'
  description: MMC20 Lateral Movement
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\mmc.exe") && ((Image.endsWith("\cmd.exe")
    || Image.endsWith("\powershell.exe") || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe") || Image.endsWith("\reg.exe")
    || Image.endsWith("\regsvr32.exe")) || (Image.includes("\BITSADMIN"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"05a2ab7e-ce11-4b63-86db-ab32e763e11d_sysmon_ot"'
  description: MMC Spawning Windows Shell
- id: eval
  filter: (EventID=="1" && (Product.includes("Mouse Lock") || Company.includes("Misc314")
    || CommandLine.includes("Mouse Lock_")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c9192ad9-75e5-43eb-8647-82a0a5b493e3_sysmon_ot"'
  description: Mouse Lock Credential Gathering
- id: eval
  filter: (EventID=="1" && Image.endsWith("\mshta.exe") && CommandLine.includes("javascript"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"67f113fa-e23d-4271-befa-30113b3e08b1_sysmon_ot"'
  description: Mshta JavaScript Execution
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\mshta.exe") && ((Image.endsWith("\cmd.exe")
    || Image.endsWith("\powershell.exe") || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe") || Image.endsWith("\reg.exe")
    || Image.endsWith("\regsvr32.exe")) || (Image.includes("\BITSADMIN"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"03cc0c25-389f-4bf8-b48d-11878079f1ca_sysmon_ot"'
  description: MSHTA Spawning Windows Shell
- id: eval
  filter: (EventID=="1" && CommandLine.includes("netsh") && ((CommandLine.includes("firewall
    add portopening") && CommandLine.includes("tcp 3389")) || (CommandLine.includes("advfirewall
    firewall add rule") && CommandLine.includes("action=allow") && CommandLine.includes("protocol=TCP")
    && CommandLine.includes("localport=3389"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"01aeb693-138d-49d2-9403-c4f52d7d3d62_sysmon_ot"'
  description: Netsh RDP Port Opening
- id: eval
  filter: (EventID=="1" && Image.endsWith("\netsh.exe") && CommandLine.includes("firewall")
    && CommandLine.includes("add"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c_sysmon_ot"'
  description: Netsh Port or Application Allowed
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\netsh.exe") && CommandLine.includes("firewall")
    && CommandLine.includes("add") && (CommandLine.includes("allowedprogram") || (CommandLine.includes("advfirewall")
    && CommandLine.includes("rule") && CommandLine.includes("action=allow") && CommandLine.includes("program="))))
    && ((CommandLine.includes("%TEMP%") || CommandLine.includes(":\RECYCLER\\") ||
    CommandLine.includes("C:\$Recycle.bin\\") || CommandLine.includes(":\SystemVolumeInformation\\")
    || CommandLine.includes("C:\Windows\Temp\\") || CommandLine.includes("C:\Temp\\")
    || CommandLine.includes("C:\Users\Public\\") || CommandLine.includes("C:\Users\Default\\")
    || CommandLine.includes("C:\Users\Desktop\\") || CommandLine.includes("\Downloads\\")
    || CommandLine.includes("\Temporary Internet Files\Content.Outlook\\") || CommandLine.includes("\Local
    Settings\Temporary Internet Files\\")) || (CommandLine.startsWith("C:\Windows\Tasks\\")
    || CommandLine.startsWith("C:\Windows\debug\\") || CommandLine.startsWith("C:\Windows\fonts\\")
    || CommandLine.startsWith("C:\Windows\help\\") || CommandLine.startsWith("C:\Windows\drivers\\")
    || CommandLine.startsWith("C:\Windows\addins\\") || CommandLine.startsWith("C:\Windows\cursors\\")
    || CommandLine.startsWith("C:\Windows\system32\tasks\\") || CommandLine.startsWith("%Public%\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a35f5a72-f347-4e36-8895-9869b0d5fc6d_sysmon_ot"'
  description: Netsh Program Allowed with Suspcious Location
- id: eval
  filter: (EventID=="1" && CommandLine.includes("netsh") && CommandLine.includes("trace")
    && CommandLine.includes("start"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d3c3861d-c504-4c77-ba55-224ba82d0118_sysmon_ot"'
  description: Capture a Network Trace with netsh.exe
- id: eval
  filter: (EventID=="1" && Image.endsWith("\netsh.exe") && ((CommandLine.includes("interface")
    && CommandLine.includes("portproxy") && CommandLine.includes("add") && CommandLine.includes("v4tov4"))
    || (CommandLine.includes("connectp") && CommandLine.includes("listena") && CommandLine.includes("c="))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"322ed9ec-fcab-4f67-9a34-e7c6aef43614_sysmon_ot"'
  description: Netsh Port Forwarding
- id: eval
  filter: (EventID=="1" && Image.endsWith("\netsh.exe") && CommandLine.includes("i")
    && CommandLine.includes(" p") && CommandLine.includes("=3389") && CommandLine.includes("
    c"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"782d6f3e-4c5d-4b8c-92a3-1d05fed72e63_sysmon_ot"'
  description: Netsh RDP Port Forwarding
- id: eval
  filter: (EventID=="1" && Image.endsWith("\netsh.exe") && CommandLine.includes("wlan")
    && CommandLine.includes(" s") && CommandLine.includes(" p") && CommandLine.includes("
    k") && CommandLine.includes("=clear"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"42b1a5b8-353f-4f10-b256-39de4467faff_sysmon_ot"'
  description: Harvesting of Wifi Credentials Using netsh.exe
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\tshark.exe") && CommandLine.includes("-i"))
    || Image.endsWith("\windump.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ba1f7802-adc7-48b4-9ecb-81e227fddfd5_sysmon_ot"'
  description: Network Sniffing
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\net.exe") || Image.endsWith("\net1.exe"))
    && CommandLine.includes("view")) &&  ! (CommandLine.includes("\\\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"62510e69-616b-4078-b371-847da438cc03_sysmon_ot"'
  description: Windows Network Enumeration
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\net.exe") || Image.endsWith("\net1.exe"))
    && CommandLine.includes("user") && CommandLine.includes("add"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd219ff3-fa99-45d4-8380-a7d15116c6dc_sysmon_ot"'
  description: Net.exe User Account Creation
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\net.exe") || Image.endsWith("\net1.exe"))
    && CommandLine.includes(" use ") && CommandLine.includes("\\\*\\*$"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3abd6094-7027-475f-9630-8ab9be7b9725_sysmon_ot"'
  description: Mounted Windows Admin Shares with net.exe
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\sc.exe") && CommandLine.includes("create")
    && CommandLine.includes("binpath")) || (Image.endsWith("\powershell.exe") && CommandLine.includes("new-service"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7fe71fc9-de3b-432a-8d57-8c809efc10ab_sysmon_ot"'
  description: New Service Creation
- id: eval
  filter: (EventID=="1" && Image.endsWith("\nltest.exe") && ((CommandLine.includes("/server")
    && CommandLine.includes("/query")) || (CommandLine.includes("/dclist:") || CommandLine.includes("/parentdomain")
    || CommandLine.includes("/domain_trusts") || CommandLine.includes("/trusted_domains")
    || CommandLine.includes("/user"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5cc90652-4cbd-4241-aa3b-4b462fa5a248_sysmon_ot"'
  description: Recon Activity with NLTEST
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") &&  ! ((ParentImage.endsWith("\explorer.exe")
    || ParentImage.endsWith("\CompatTelRunner.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f4bbd493-b796-416e-bbf2-121235348529_sysmon_ot"'
  description: Non Interactive PowerShell
- id: eval
  filter: (EventID=="1" && IntegrityLevel=="Medium" && ((CommandLine.includes("reg")
    && CommandLine.includes("add")) || (CommandLine.includes("powershell") && (CommandLine.includes("set-itemproperty")
    || CommandLine.includes(" sp ") || CommandLine.includes("new-itemproperty"))))
    && (CommandLine.includes("ControlSet") && CommandLine.includes("Services")) &&
    (CommandLine.includes("ImagePath") || CommandLine.includes("FailureCommand") ||
    CommandLine.includes("ServiceDLL")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8f02c935-effe-45b3-8fc9-ef8696a9e41d_sysmon_ot"'
  description: Non-privileged Usage of Reg or Powershell
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\WINWORD.EXE") || ParentImage.endsWith("\EXCEL.EXE")
    || ParentImage.endsWith("\POWERPNT.exe") || ParentImage.endsWith("\MSPUB.exe")
    || ParentImage.endsWith("\VISIO.exe") || ParentImage.endsWith("\OUTLOOK.EXE")
    || ParentImage.endsWith("\MSACCESS.EXE") || ParentImage.endsWith("\EQNEDT32.EXE"))
    && (Image.endsWith("\cmd.exe") || Image.endsWith("\powershell.exe") || Image.endsWith("\wscript.exe")
    || Image.endsWith("\cscript.exe") || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe")
    || Image.endsWith("\scrcons.exe") || Image.endsWith("\schtasks.exe") || Image.endsWith("\regsvr32.exe")
    || Image.endsWith("\hh.exe") || Image.endsWith("\wmic.exe") || Image.endsWith("\mshta.exe")
    || Image.endsWith("\rundll32.exe") || Image.endsWith("\msiexec.exe") || Image.endsWith("\forfiles.exe")
    || Image.endsWith("\scriptrunner.exe") || Image.endsWith("\mftrace.exe") || Image.endsWith("\AppVLP.exe")
    || Image.endsWith("\svchost.exe") || Image.endsWith("\msbuild.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"438025f9-5856-4663-83f7-52f878a70a50_sysmon_ot"'
  description: Microsoft Office Product Spawning Windows Shell
- id: eval
  filter: (EventID=="1" && ((ParentImage.endsWith("\WINWORD.EXE") || ParentImage.endsWith("\EXCEL.EXE")
    || ParentImage.endsWith("\POWERPNT.exe") || ParentImage.endsWith("\MSPUB.exe")
    || ParentImage.endsWith("\VISIO.exe")) && Image.startsWith("C:\users\\") && Image.endsWith(".exe"))
    &&  ! (Image.endsWith("\Teams.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aa3a6f94-890e-4e22-b634-ffdfd54792cc_sysmon_ot"'
  description: MS Office Product Spawning Exe in User Dir
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("del ") && CommandLine.includes("/f"))
    || (CommandLine.includes("rmdir") && CommandLine.includes("/s") && CommandLine.includes("/q"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"379fa130-190e-4c3f-b7bc-6c8e834485f3_sysmon_ot"'
  description: Windows Cmd Delete File
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cmd.exe") && CommandLine.includes(">"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4f4eaa9f-5ad4-410c-a4be-bc6132b0175a_sysmon_ot"'
  description: Redirect Output in CommandLine
- id: eval
  filter: (EventID=="1" && (image.endsWith("\wbadmin.exe") || CommandLine.includes("wbadmin"))
    && (CommandLine.includes("delete ") && CommandLine.includes("systemstatebackup
    ") && CommandLine.includes("-keepVersions:0")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"89f75308-5b1b-4390-b2d8-d6b2340efaf8_sysmon_ot"'
  description: Wbadmin Delete Systemstatebackup
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\DismHost.exe") && ParentCommandLine.includes("/online")
    && ParentCommandLine.includes("/Disable-Feature") && ParentCommandLine.includes("/FeatureName:")
    && ParentCommandLine.includes("/Remove")) || (Image.endsWith("\Dism.exe") && CommandLine.includes("/online")
    && CommandLine.includes("/Disable-Feature") && CommandLine.includes("/FeatureName:")
    && CommandLine.includes("/Remove"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"43e32da2-fdd0-4156-90de-50dfd62636f9_sysmon_ot"'
  description: Dism Remove Online Package
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\reg.exe") && CommandLine.includes(" query
    ") && CommandLine.includes("/t ") && CommandLine.includes("REG_SZ") && CommandLine.includes("/s"))
    && ((CommandLine.includes("/f ") && CommandLine.includes("HKLM")) || (CommandLine.includes("/f
    ") && CommandLine.includes("HKCU")) || CommandLine.includes("HKCU\Software\SimonTatham\PuTTY\Sessions")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e0b0c2ab-3d52-46d9-8cb7-049dc775fbd1_sysmon_ot"'
  description: Enumeration for Credentials in Registry
- id: eval
  filter: (EventID=="1" && Image.endsWith("\ruby.exe") && CommandLine.includes("-i
    ") && CommandLine.includes("-u ") && CommandLine.includes("-p "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a197e378-d31b-41c0-9635-cfdf1c1bb423_sysmon_ot"'
  description: WinRM Access with Evil-WinRM
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\accesschk.exe") || Image.endsWith("\accesschk64.exe")
    || Image.endsWith("\AccessEnum.exe") || Image.endsWith("\ADExplorer.exe") || Image.endsWith("\ADExplorer64.exe")
    || Image.endsWith("\ADInsight.exe") || Image.endsWith("\ADInsight64.exe") || Image.endsWith("\adrestore.exe")
    || Image.endsWith("\adrestore64.exe") || Image.endsWith("\Autologon.exe") || Image.endsWith("\Autologon64.exe")
    || Image.endsWith("\Autoruns.exe") || Image.endsWith("\Autoruns64.exe") || Image.endsWith("\autorunsc.exe")
    || Image.endsWith("\autorunsc64.exe") || Image.endsWith("\Bginfo.exe") || Image.endsWith("\Bginfo64.exe")
    || Image.endsWith("\Cacheset.exe") || Image.endsWith("\Cacheset64.exe") || Image.endsWith("\Clockres.exe")
    || Image.endsWith("\Clockres64.exe") || Image.endsWith("\Contig.exe") || Image.endsWith("\Contig64.exe")
    || Image.endsWith("\Coreinfo.exe") || Image.endsWith("\Coreinfo64.exe") || Image.endsWith("\CPUSTRES.EXE")
    || Image.endsWith("\CPUSTRES64.EXE") || Image.endsWith("\ctrl2cap.exe") || Image.endsWith("\Dbgview.exe")
    || Image.endsWith("\dbgview64.exe") || Image.endsWith("\Desktops.exe") || Image.endsWith("\Desktops64.exe")
    || Image.endsWith("\disk2vhd.exe") || Image.endsWith("\disk2vhd64.exe") || Image.endsWith("\diskext.exe")
    || Image.endsWith("\diskext64.exe") || Image.endsWith("\Diskmon.exe") || Image.endsWith("\Diskmon64.exe")
    || Image.endsWith("\DiskView.exe") || Image.endsWith("\DiskView64.exe") || Image.endsWith("\du.exe")
    || Image.endsWith("\du64.exe") || Image.endsWith("\efsdump.exe") || Image.endsWith("\FindLinks.exe")
    || Image.endsWith("\FindLinks64.exe") || Image.endsWith("\handle.exe") || Image.endsWith("\handle64.exe")
    || Image.endsWith("\hex2dec.exe") || Image.endsWith("\hex2dec64.exe") || Image.endsWith("\junction.exe")
    || Image.endsWith("\junction64.exe") || Image.endsWith("\ldmdump.exe") || Image.endsWith("\listdlls.exe")
    || Image.endsWith("\listdlls64.exe") || Image.endsWith("\livekd.exe") || Image.endsWith("\livekd64.exe")
    || Image.endsWith("\loadOrd.exe") || Image.endsWith("\loadOrd64.exe") || Image.endsWith("\loadOrdC.exe")
    || Image.endsWith("\loadOrdC64.exe") || Image.endsWith("\logonsessions.exe") ||
    Image.endsWith("\logonsessions64.exe") || Image.endsWith("\movefile.exe") || Image.endsWith("\movefile64.exe")
    || Image.endsWith("\notmyfault.exe") || Image.endsWith("\notmyfault64.exe") ||
    Image.endsWith("\notmyfaultc.exe") || Image.endsWith("\notmyfaultc64.exe") ||
    Image.endsWith("\ntfsinfo.exe") || Image.endsWith("\ntfsinfo64.exe") || Image.endsWith("\pendmoves.exe")
    || Image.endsWith("\pendmoves64.exe") || Image.endsWith("\pipelist.exe") || Image.endsWith("\pipelist64.exe")
    || Image.endsWith("\portmon.exe") || Image.endsWith("\procdump.exe") || Image.endsWith("\procdump64.exe")
    || Image.endsWith("\procexp.exe") || Image.endsWith("\procexp64.exe") || Image.endsWith("\Procmon.exe")
    || Image.endsWith("\Procmon64.exe") || Image.endsWith("\psExec.exe") || Image.endsWith("\psExec64.exe")
    || Image.endsWith("\psfile.exe") || Image.endsWith("\psfile64.exe") || Image.endsWith("\psGetsid.exe")
    || Image.endsWith("\psGetsid64.exe") || Image.endsWith("\psInfo.exe") || Image.endsWith("\psInfo64.exe")
    || Image.endsWith("\pskill.exe") || Image.endsWith("\pskill64.exe") || Image.endsWith("\pslist.exe")
    || Image.endsWith("\pslist64.exe") || Image.endsWith("\psLoggedon.exe") || Image.endsWith("\psLoggedon64.exe")
    || Image.endsWith("\psloglist.exe") || Image.endsWith("\psloglist64.exe") || Image.endsWith("\pspasswd.exe")
    || Image.endsWith("\pspasswd64.exe") || Image.endsWith("\psping.exe") || Image.endsWith("\psping64.exe")
    || Image.endsWith("\psService.exe") || Image.endsWith("\psService64.exe") || Image.endsWith("\psshutdown.exe")
    || Image.endsWith("\psshutdown64.exe") || Image.endsWith("\pssuspend.exe") ||
    Image.endsWith("\pssuspend64.exe") || Image.endsWith("\RAMMap.exe") || Image.endsWith("\RDCMan.exe")
    || Image.endsWith("\RegDelNull.exe") || Image.endsWith("\RegDelNull64.exe") ||
    Image.endsWith("\regjump.exe") || Image.endsWith("\ru.exe") || Image.endsWith("\ru64.exe")
    || Image.endsWith("\sdelete.exe") || Image.endsWith("\sdelete64.exe") || Image.endsWith("\ShareEnum.exe")
    || Image.endsWith("\ShareEnum64.exe") || Image.endsWith("\shellRunas.exe") ||
    Image.endsWith("\sigcheck.exe") || Image.endsWith("\sigcheck64.exe") || Image.endsWith("\streams.exe")
    || Image.endsWith("\streams64.exe") || Image.endsWith("\strings.exe") || Image.endsWith("\strings64.exe")
    || Image.endsWith("\sync.exe") || Image.endsWith("\sync64.exe") || Image.endsWith("\Sysmon.exe")
    || Image.endsWith("\Sysmon64.exe") || Image.endsWith("\tcpvcon.exe") || Image.endsWith("\tcpvcon64.exe")
    || Image.endsWith("\tcpview.exe") || Image.endsWith("\tcpview64.exe") || Image.endsWith("\Testlimit.exe")
    || Image.endsWith("\Testlimit64.exe") || Image.endsWith("\vmmap.exe") || Image.endsWith("\vmmap64.exe")
    || Image.endsWith("\Volumeid.exe") || Image.endsWith("\Volumeid64.exe") || Image.endsWith("\whois.exe")
    || Image.endsWith("\whois64.exe") || Image.endsWith("\Winobj.exe") || Image.endsWith("\Winobj64.exe")
    || Image.endsWith("\ZoomIt.exe") || Image.endsWith("\ZoomIt64.exe")) &&  ! (((Company=="Sysinternals
    - www.sysinternals.com" || Company=="Sysinternals")) || (Company ===null )))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7cce6fc8-a07f-4d84-a53e-96e1879843c9_sysmon_ot"'
  description: False Sysinternals Suite Tools
- id: eval
  filter: (EventID=="1" && Image.endsWith("\findstr.exe") && CommandLine.includes("cpassword")
    && CommandLine.includes("\sysvol\\") && CommandLine.includes(".xml"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"91a2c315-9ee6-4052-a853-6f6a8238f90d_sysmon_ot"'
  description: Findstr GPP Passwords
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\hashcat.exe") || (CommandLine.includes("-a
    ") && CommandLine.includes("-m 1000 ") && CommandLine.includes("-r "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"39b31e81-5f5f-4898-9c0e-2160cfc0f9bf_sysmon_ot"'
  description: Password Cracking with Hashcat
- id: eval
  filter: (EventID=="1" && Image.endsWith("\appcmd.exe") && CommandLine.includes("set")
    && CommandLine.includes("config") && CommandLine.includes("/section:httplogging")
    && CommandLine.includes("/dontLog:true"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e4ed6030-ffe5-4e6a-8a8a-ab3c1ab9d94e_sysmon_ot"'
  description: Disable Windows IIS HTTP Logging
- id: eval
  filter: (EventID=="1" && Image.includes("C:\Windows\Microsoft.NET\Framework") &&
    Image.includes("aspnet_compiler.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a01b8329-5953-4f73-ae2d-aa01e1f35f00_sysmon_ot"'
  description: Suspicious aspnet_compiler.exe Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("bash.exe") && CommandLine.includes("-c
    "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5edc2273-c26f-406c-83f3-f4d948e740dd_sysmon_ot"'
  description: Suspicious Subsystem for Linux Bash Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("ConfigSecurityPolicy.exe") && (CommandLine.includes("https://")
    || CommandLine.includes("http://") || CommandLine.includes("ftp://")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1f0f6176-6482-4027-b151-00071af39d7e_sysmon_ot"'
  description: Suspicious ConfigSecurityPolicy Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("diantz.exe") && CommandLine.includes("
    \\\") && CommandLine.includes(".cab"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"185d7418-f250-42d0-b72e-0c8b70661e93_sysmon_ot"'
  description: Suspicious Diantz Download and Compress Into a CAB File
- id: eval
  filter: (EventID=="1" && CommandLine.includes("Extexport.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fb0b815b-f5f6-4f50-970f-ffe21f253f7a_sysmon_ot"'
  description: Suspicious Extexport Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("extrac32.exe") && CommandLine.includes(".cab")
    && (CommandLine.includes("/C") || CommandLine.includes("/Y") || CommandLine.includes("
    \\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aa8e035d-7be4-48d3-a944-102aec04400d_sysmon_ot"'
  description: Suspicious Extrac32 Execution
- id: eval
  filter: (EventID=="1" && Image.endsWith("\msiexec.exe") && CommandLine.includes("
    /y"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6f4191bb-912b-48a8-9ce7-682769541e6d_sysmon_ot"'
  description: Suspisious Msiexec Execute Arbitrary DLL
- id: eval
  filter: (EventID=="1" && Image.endsWith("\msiexec.exe") && CommandLine.includes("
    /i") && CommandLine.includes(" /q"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"79a87aa6-e4bd-42fc-a5bb-5e6fbdcd62f5_sysmon_ot"'
  description: Suspisious Msiexec Quiet Install
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\mstsc.exe") && CommandLine.includes("
    /v:")) || (Image.endsWith("\cmdkey.exe") && CommandLine.includes("/generic:")
    && CommandLine.includes("/user:") && CommandLine.includes("/pass:"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"954f0af7-62dd-418f-b3df-a84bc2c7a774_sysmon_ot"'
  description: Remote Desktop Protocol Use Mstsc
- id: eval
  filter: (EventID=="1" && Image.endsWith("\netsh.exe") && CommandLine.includes("advfirewall")
    && CommandLine.includes("firewall") && CommandLine.includes("set") && CommandLine.includes("rule")
    && CommandLine.includes("group=") && CommandLine.includes("new") && CommandLine.includes("enable=Yes"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"347906f3-e207-4d18-ae5b-a9403d6bcdef_sysmon_ot"'
  description: Netsh Allow Group Policy on Microsoft Defender Firewall
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\pypykatz.exe") || Image.endsWith("\python.exe"))
    && CommandLine.includes("live") && CommandLine.includes("registry"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a29808fd-ef50-49ff-9c7a-59a9b040b404_sysmon_ot"'
  description: Registry Parse with Pypykatz
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" save ") && (CommandLine.includes("HKLM\sam")
    || CommandLine.includes("HKLM\system") || CommandLine.includes("HKLM\security")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"038cd51c-3ad8-41c5-ba8f-5d1c92f3cc1e_sysmon_ot"'
  description: Registry Dump of SAM Creds and Secrets
- id: eval
  filter: (EventID=="1" && Image.endsWith("\reg.exe") && CommandLine.includes("add
    ") && CommandLine.includes("HKLM\SYSTEM\CurrentControlSet\Services\\") && CommandLine.includes("/v
    ") && CommandLine.includes("ImagePath ") && CommandLine.includes("/d "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9b0b7ac3-6223-47aa-a3fd-e8f211e637db_sysmon_ot"'
  description: Service ImagePath Change with Reg.exe
- id: eval
  filter: (EventID=="1" && Image.includes(".zip\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1a70042a-6622-4a2b-8958-267625349abf_sysmon_ot"'
  description: Run from a Zip File
- id: eval
  filter: (EventID=="1" && CommandLine.includes("-executionpolicy ") && (CommandLine.includes("Unrestricted")
    || CommandLine.includes("bypass") || CommandLine.includes("RemoteSigned")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180_sysmon_ot"'
  description: Change PowerShell Policies to a Unsecure Level
- id: eval
  filter: (EventID=="1" && Image.endsWith("\sqlcmd.exe") && CommandLine.includes("SELECT")
    && CommandLine.includes("TOP") && CommandLine.includes("[VeeamBackup].[dbo].[Credentials]"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b57ba453-b384-4ab9-9f40-1038086b4e53_sysmon_ot"'
  description: VeeamBackup Database Credentials Dump
- id: eval
  filter: (EventID=="1" && Image.endsWith("\wmic.exe") && CommandLine.includes(" group"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"164eda96-11b2-430b-85ff-6a265c15bf32_sysmon_ot"'
  description: Suspicious Get Local Groups Information with WMIC
- id: eval
  filter: (EventID=="1" && Image.endsWith("\adfind.exe") && ((CommandLine.includes("lockoutduration")
    || CommandLine.includes("lockoutthreshold") || CommandLine.includes("lockoutobservationwindow")
    || CommandLine.includes("maxpwdage") || CommandLine.includes("minpwdage") || CommandLine.includes("minpwdlength")
    || CommandLine.includes("pwdhistorylength") || CommandLine.includes("pwdproperties"))
    || CommandLine.includes("-sc admincountdmp") || CommandLine.includes("-sc exchaddresses")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"455b9d50-15a1-4b99-853f-8d37655a4c1b_sysmon_ot"'
  description: Suspicious AdFind Enumerate
- id: eval
  filter: (EventID=="1" && Image.endsWith("\python.exe") && CommandLine.includes("adidnsdump"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"26d3f0a2-f514-4a3f-a8a7-e7e48a8d9160_sysmon_ot"'
  description: Suspicious Execution of Adidnsdump
- id: eval
  filter: "(EventID==\"1\" && (CommandLine.includes(\"\xE2\") || CommandLine.includes(\"\
    \u20AC\") || CommandLine.includes(\"\xA3\") || CommandLine.includes(\"\xAF\")\
    \ || CommandLine.includes(\"\xAE\") || CommandLine.includes(\"\xB5\") || CommandLine.includes(\"\
    \xB6\")))"
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e0552b19-5a83-4222-b141-b36184bb8d79_sysmon_ot"'
  description: Obfuscated Command Line Using Special Unicode Characters
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cipher.exe") && CommandLine.includes("
    /w:"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4b046706-5789-4673-b111-66f25fe99534_sysmon_ot"'
  description: Overwrite Deleted Data with Cipher
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\cmdl32.exe") || OriginalFileName=="CMDL32.EXE")
    && (CommandLine.includes("/vpn ") && CommandLine.includes("/lan ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f37aba28-a9e6-4045-882c-d5004043b337_sysmon_ot"'
  description: Suspicious Cmdl32 Execution
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cscript.exe") && CommandLine.includes(".vbs"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"23250293-eed5-4c39-b57a-841c8933a57d_sysmon_ot"'
  description: Cscript Visual Basic Script Execution
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\curl.exe") || Product=="The curl executable")
    && (CommandLine.includes(" -A ") || CommandLine.includes(" --user-agent ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3286d37a-00fd-41c2-a624-a672dcd34e60_sysmon_ot"'
  description: Suspicious Curl Change User Agents
- id: eval
  filter: (EventID=="1" && CommandLine.includes("dir ") && CommandLine.includes("
    /s") && CommandLine.includes(" /b"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7c9340a9-e2ee-4e43-94c5-c54ebbea1006_sysmon_ot"'
  description: Suspicious DIR Execution
- id: eval
  filter: (EventID=="1" && Image.endsWith("\findstr.exe") && CommandLine.includes("
    385201"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"37db85d1-b089-490a-a59a-c7b6f984f480_sysmon_ot"'
  description: Suspicious Findstr 385201 Execution
- id: eval
  filter: (EventID=="1" && Image.endsWith("\HOSTNAME.EXE"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7be5fb68-f9ef-476d-8b51-0256ebece19e_sysmon_ot"'
  description: Suspicious Execution of Hostname
- id: eval
  filter: (EventID=="1" && Image.endsWith("\InstallUtil.exe") && Image.includes("Microsoft.NET\Framework64\\")
    && CommandLine.includes("/logfile= ") && CommandLine.includes("/LogToConsole=false"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d042284c-a296-4988-9be5-f424fadcc28c_sysmon_ot"'
  description: Suspicious Execution of InstallUtil Without Log
- id: eval
  filter: (EventID=="1" && Image.endsWith("\reg.exe") && CommandLine.includes("SOFTWARE\Microsoft\Cryptography")
    && CommandLine.includes("/v ") && CommandLine.includes("MachineGuid"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f5240972-3938-4e56-8e4b-e33893176c1f_sysmon_ot"'
  description: Suspicious Query of MachineGUID
- id: eval
  filter: (EventID=="1" && CommandLine.includes("netsh ") && CommandLine.includes("advfirewall
    ") && CommandLine.includes("firewall ") && CommandLine.includes("show ") && CommandLine.includes("rule
    ") && CommandLine.includes("name=all"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0e4164da-94bc-450d-a7be-a4b176179f1f_sysmon_ot"'
  description: Suspicious Netsh Discovery Command
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("ipconfig /all") || CommandLine.includes("netsh
    interface show interface") || CommandLine.includes("arp -a") || CommandLine.includes("nbtstat
    -n") || CommandLine.includes("net config")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a29c1813-ab1f-4dde-b489-330b952e91ae_sysmon_ot"'
  description: Suspicious Network Command
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("netstat") || (CommandLine.includes("net
    ") && ((CommandLine.endsWith(" use") || CommandLine.endsWith(" sessions")) ||
    (CommandLine.includes(" use ") || CommandLine.includes(" sessions "))))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1c67a717-32ba-409b-a45d-0fb704a73a81_sysmon_ot"'
  description: Suspicious Listing of Network Connections
- id: eval
  filter: (EventID=="1" && OriginalFileName=="nmap.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f6ecd1cf-19b8-4488-97f6-00f0924991a3_sysmon_ot"'
  description: Suspicious Nmap Execution
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") && (CommandLine.includes("
    -e ") || CommandLine.includes(" -en ") || CommandLine.includes(" -enc ") || CommandLine.includes("
    -enco")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fb843269-508c-4b76-8b8d-88679db22ce7_sysmon_ot"'
  description: Suspicious Execution of Powershell with Base64
- id: eval
  filter: (EventID=="1" && (Description=="Radmin Viewer" || Product=="Radmin Viewer"
    || OriginalFileName=="Radmin.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5817e76f-4804-41e6-8f1d-5fa0b3ecae2d_sysmon_ot"'
  description: Use Radmin Viewer Utility
- id: eval
  filter: (EventID=="1" && Image.endsWith("\regsvr32.exe") && CommandLine.endsWith(".jpg"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"089fc3d2-71e8-4763-a8a5-c97fbb0a403e_sysmon_ot"'
  description: Suspicious Regsvr32 Execution With Image Extension
- id: eval
  filter: (EventID=="1" && CommandLine.includes("REG") && CommandLine.includes("ADD")
    && CommandLine.includes("HKLM\SOFTWARE\Policies\Microsoft\FVE") && CommandLine.includes("/v")
    && CommandLine.includes("/f") && (CommandLine.includes("EnableBDEWithNoTPM") ||
    CommandLine.includes("UseAdvancedStartup") || CommandLine.includes("UseTPM") ||
    CommandLine.includes("UseTPMKey") || CommandLine.includes("UseTPMKeyPIN") || CommandLine.includes("RecoveryKeyMessageSource")
    || CommandLine.includes("UseTPMPIN") || CommandLine.includes("RecoveryKeyMessage")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0e0255bf-2548-47b8-9582-c0955c9283f5_sysmon_ot"'
  description: Suspicious Reg Add BitLocker
- id: eval
  filter: (EventID=="1" && CommandLine.includes("reg") && ((CommandLine.includes("add")
    && CommandLine.includes("hkcu\software\classes\ms-settings\shell\open\command")
    && CommandLine.includes("/ve ") && CommandLine.includes("/d")) || (CommandLine.includes("add")
    && CommandLine.includes("hkcu\software\classes\ms-settings\shell\open\command")
    && CommandLine.includes("/v") && CommandLine.includes("DelegateExecute")) || (CommandLine.includes("delete")
    && CommandLine.includes("hkcu\software\classes\ms-settings"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dd3ee8cc-f751-41c9-ba53-5a32ed47e563_sysmon_ot"'
  description: Suspicious Reg Add Open Command
- id: eval
  filter: (EventID=="1" && CommandLine.includes("rundll32") && CommandLine.includes("mshtml,RunHTMLApplication")
    && (CommandLine.includes("javascript:") || CommandLine.includes("vbscript:")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"73fcad2e-ff14-4c38-b11d-4172c8ac86c7_sysmon_ot"'
  description: Suspicious Rundll32 Script in CommandLine
- id: eval
  filter: (EventID=="1" && Image.endsWith("\schtasks.exe") && CommandLine.includes("/Change")
    && CommandLine.includes("/TN") && CommandLine.includes("/disable") && CommandLine.includes("\Microsoft\Windows\SystemRestore\SR"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9ac94dc8-9042-493c-ba45-3b5e7c86b980_sysmon_ot"'
  description: Disable Important Scheduled Task
- id: eval
  filter: (EventID=="1" && Image.endsWith("schtasks.exe") && CommandLine.includes("/Create
    ") && CommandLine.includes("\AppData\Local\Temp"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"43f487f0-755f-4c2a-bce7-d6d2eec2fcf8_sysmon_ot"'
  description: Suspicius Add Task From User AppData Temp
- id: eval
  filter: (EventID=="1" && CommandLine.includes("sc query"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"57712d7a-679c-4a41-a913-87e7175ae429_sysmon_ot"'
  description: Suspicious Sc Query
- id: eval
  filter: (EventID=="1" && (OriginalFileName=="SharpView.exe" || (Commandline.includes("Get-DomainGPOUserLocalGroupMapping")
    || Commandline.includes("Find-GPOLocation") || Commandline.includes("Get-DomainGPOComputerLocalGroupMapping")
    || Commandline.includes("Find-GPOComputerAdmin") || Commandline.includes("Get-DomainObjectAcl")
    || Commandline.includes("Get-ObjectAcl") || Commandline.includes("Add-DomainObjectAcl")
    || Commandline.includes("Add-ObjectAcl") || Commandline.includes("Remove-DomainObjectAcl")
    || Commandline.includes("Get-RegLoggedOn") || Commandline.includes("Get-LoggedOnLocal")
    || Commandline.includes("Get-NetRDPSession") || Commandline.includes("Test-AdminAccess")
    || Commandline.includes("Invoke-CheckLocalAdminAccess") || Commandline.includes("Get-WMIProcess")
    || Commandline.includes("Get-NetProcess") || Commandline.includes("Get-WMIRegProxy")
    || Commandline.includes("Get-Proxy") || Commandline.includes("Get-WMIRegLastLoggedOn")
    || Commandline.includes("Get-LastLoggedOn") || Commandline.includes("Get-WMIRegCachedRDPConnection")
    || Commandline.includes("Get-CachedRDPConnection") || Commandline.includes("Get-WMIRegMountedDrive")
    || Commandline.includes("Get-RegistryMountedDrive") || Commandline.includes("Find-InterestingDomainAcl")
    || Commandline.includes("Invoke-ACLScanner") || Commandline.includes("Get-NetShare")
    || Commandline.includes("Get-NetLoggedon") || Commandline.includes("Get-NetLocalGroup")
    || Commandline.includes("Get-NetLocalGroupMember") || Commandline.includes("Get-NetSession")
    || Commandline.includes("Get-PathAcl") || Commandline.includes("ConvertFrom-UACValue")
    || Commandline.includes("Get-PrincipalContext") || Commandline.includes("New-DomainGroup")
    || Commandline.includes("New-DomainUser") || Commandline.includes("Add-DomainGroupMember")
    || Commandline.includes("Set-DomainUserPassword") || Commandline.includes("Invoke-Kerberoast")
    || Commandline.includes("Export-PowerViewCSV") || Commandline.includes("Find-LocalAdminAccess")
    || Commandline.includes("Find-DomainLocalGroupMember") || Commandline.includes("Find-DomainShare")
    || Commandline.includes("Find-DomainUserEvent") || Commandline.includes("Find-DomainProcess")
    || Commandline.includes("Find-DomainUserLocation") || Commandline.includes("Find-InterestingFile")
    || Commandline.includes("Find-InterestingDomainShareFile") || Commandline.includes("Find-DomainObjectPropertyOutlier")
    || Commandline.includes("TestMethod") || Commandline.includes("Get-Domain") ||
    Commandline.includes("Get-NetDomain") || Commandline.includes("Get-DomainComputer")
    || Commandline.includes("Get-NetComputer") || Commandline.includes("Get-DomainController")
    || Commandline.includes("Get-NetDomainController") || Commandline.includes("Get-DomainFileServer")
    || Commandline.includes("Get-NetFileServer") || Commandline.includes("Convert-ADName")
    || Commandline.includes("Get-DomainObject") || Commandline.includes("Get-ADObject")
    || Commandline.includes("Get-DomainUser") || Commandline.includes("Get-NetUser")
    || Commandline.includes("Get-DomainGroup") || Commandline.includes("Get-NetGroup")
    || Commandline.includes("Get-DomainDFSShare") || Commandline.includes("Get-DFSshare")
    || Commandline.includes("Get-DomainDNSRecord") || Commandline.includes("Get-DNSRecord")
    || Commandline.includes("Get-DomainDNSZone") || Commandline.includes("Get-DNSZone")
    || Commandline.includes("Get-DomainForeignGroupMember") || Commandline.includes("Find-ForeignGroup")
    || Commandline.includes("Get-DomainForeignUser") || Commandline.includes("Find-ForeignUser")
    || Commandline.includes("ConvertFrom-SID") || Commandline.includes("Convert-SidToName")
    || Commandline.includes("Get-DomainGroupMember") || Commandline.includes("Get-NetGroupMember")
    || Commandline.includes("Get-DomainManagedSecurityGroup") || Commandline.includes("Find-ManagedSecurityGroups")
    || Commandline.includes("Get-DomainOU") || Commandline.includes("Get-NetOU") ||
    Commandline.includes("Get-DomainSID") || Commandline.includes("Get-Forest") ||
    Commandline.includes("Get-NetForest") || Commandline.includes("Get-ForestTrust")
    || Commandline.includes("Get-NetForestTrust") || Commandline.includes("Get-DomainTrust")
    || Commandline.includes("Get-NetDomainTrust") || Commandline.includes("Get-ForestDomain")
    || Commandline.includes("Get-NetForestDomain") || Commandline.includes("Get-DomainSite")
    || Commandline.includes("Get-NetSite") || Commandline.includes("Get-DomainSubnet")
    || Commandline.includes("Get-NetSubnet") || Commandline.includes("Get-DomainTrustMapping")
    || Commandline.includes("Invoke-MapDomainTrust") || Commandline.includes("Get-ForestGlobalCatalog")
    || Commandline.includes("Get-NetForestCatalog") || Commandline.includes("Get-DomainUserEvent")
    || Commandline.includes("Get-UserEvent") || Commandline.includes("Get-DomainGUIDMap")
    || Commandline.includes("Get-GUIDMap") || Commandline.includes("Resolve-IPAddress")
    || Commandline.includes("Get-IPAddress") || Commandline.includes("ConvertTo-SID")
    || Commandline.includes("Invoke-UserImpersonation") || Commandline.includes("Invoke-RevertToSelf")
    || Commandline.includes("Get-DomainSPNTicket") || Commandline.includes("Request-SPNTicket")
    || Commandline.includes("Get-NetComputerSiteName") || Commandline.includes("Get-SiteName")
    || Commandline.includes("Get-DomainGPO") || Commandline.includes("Get-NetGPO")
    || Commandline.includes("Set-DomainObject") || Commandline.includes("Set-ADObject")
    || Commandline.includes("Add-RemoteConnection") || Commandline.includes("Remove-RemoteConnection")
    || Commandline.includes("Get-IniContent") || Commandline.includes("Get-GptTmpl")
    || Commandline.includes("Get-GroupsXML") || Commandline.includes("Get-DomainPolicyData")
    || Commandline.includes("Get-DomainPolicy") || Commandline.includes("Get-DomainGPOLocalGroup")
    || Commandline.includes("Get-NetGPOGroup"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b2317cfa-4a47-4ead-b3ff-297438c0bc2d_sysmon_ot"'
  description: Suspicious Execution of SharpView Aka PowerView
- id: eval
  filter: (EventID=="1" && Image.endsWith("\shutdown.exe") && (CommandLine.includes("/r
    ") || CommandLine.includes("/s ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"34ebb878-1b15-4895-b352-ca2eeb99b274_sysmon_ot"'
  description: Suspicious Execution of Shutdown
- id: eval
  filter: (EventID=="1" && Image.endsWith("\systeminfo.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0ef56343-059e-4cb6-adc1-4c3c967c5e46_sysmon_ot"'
  description: Suspicious Execution of Systeminfo
- id: eval
  filter: (EventID=="1" && Image.endsWith("\taskkill.exe") && CommandLine.includes("/f")
    && CommandLine.includes("/im"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"86085955-ea48-42a2-9dd3-85d4c36b167d_sysmon_ot"'
  description: Suspicious Execution of Taskkill
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("tasklist") || Image=="C:\Windows\System32\tasklist.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"63332011-f057-496c-ad8d-d2b6afb27f96_sysmon_ot"'
  description: Suspicious Tasklist Discovery Command
- id: eval
  filter: (EventID=="1" && Image.endsWith("\where.exe") && (CommandLine.includes("Bookmarks")
    || CommandLine.includes("places.sqlite")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"725a9768-0f5e-4cb3-aec2-bc5719c6831a_sysmon_ot"'
  description: Suspicious Where Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes(".zip") && ((CommandLine.includes("/generic:Microsoft_Windows_Shell_ZipFolder:filename=")
    && CommandLine.includes("/pass:") && CommandLine.includes("/user:")) || (CommandLine.includes("/delete")
    && CommandLine.includes("Microsoft_Windows_Shell_ZipFolder:filename="))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"90dcf730-1b71-4ae7-9ffc-6fcf62bd0132_sysmon_ot"'
  description: Suspicious ZipExec Execution
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\Sysmon64.exe") || Image.endsWith("\Sysmon.exe"))
    && CommandLine.includes("-u"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6a5f68d1-c4b5-46b9-94ee-5324892ea939_sysmon_ot"'
  description: Uninstall Sysinternals Sysmon
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\WMIC.exe") && (CommandLine.includes("process")
    || CommandLine.includes("qfe"))) &&  ! (CommandLine.includes("call") && CommandLine.includes("create")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"221b251a-357a-49a9-920a-271802777cc0_sysmon_ot"'
  description: Suspicious WMI Reconnaissance
- id: eval
  filter: (EventID=="1" && Image.endsWith("\WMIC.exe") && CommandLine.includes("/node:")
    && CommandLine.includes("service"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"09af397b-c5eb-4811-b2bb-08b3de464ebf_sysmon_ot"'
  description: WMI Reconnaissance List Remote Services
- id: eval
  filter: (EventID=="1" && ((((((((((((Image.endsWith("\CamMute.exe") &&  ! ((Image.includes("\Lenovo\Communication
    Utility\\") || Image.includes("\Lenovo\Communications Utility\\")))) || (Image.endsWith("\chrome_frame_helper.exe")
    &&  ! (Image.includes("\Google\Chrome\application\\")))) || (Image.endsWith("\dvcemumanager.exe")
    &&  ! (Image.includes("\Microsoft Device Emulator\\")))) || (Image.endsWith("\Gadget.exe")
    &&  ! (Image.includes("\Windows Media Player\\")))) || (Image.endsWith("\hcc.exe")
    &&  ! (Image.includes("\HTML Help Workshop\\")))) || (Image.endsWith("\hkcmd.exe")
    &&  ! ((Image.includes("\System32\\") || Image.includes("\SysNative\\") || Image.includes("\SysWowo64\\")))))
    || (Image.endsWith("\Mc.exe") &&  ! ((Image.includes("\Microsoft Visual Studio")
    || Image.includes("\Microsoft SDK") || Image.includes("\Windows Kit"))))) || (Image.endsWith("\MsMpEng.exe")
    &&  ! ((Image.includes("\Microsoft Security Client\\") || Image.includes("\Windows
    Defender\\") || Image.includes("\AntiMalware\\"))))) || (Image.endsWith("\msseces.exe")
    &&  ! ((Image.includes("\Microsoft Security Center\\") || Image.includes("\Microsoft
    Security Client\\") || Image.includes("\Microsoft Security Essentials\\")))))
    || (Image.endsWith("\OInfoP11.exe") &&  ! (Image.includes("\Common Files\Microsoft
    Shared\\")))) || (Image.endsWith("\OleView.exe") &&  ! ((Image.includes("\Microsoft
    Visual Studio") || Image.includes("\Microsoft SDK") || Image.includes("\Windows
    Kit") || Image.includes("\Windows Resource Kit\\"))))) || (Image.endsWith("\rc.exe")
    &&  ! ((Image.includes("\Microsoft Visual Studio") || Image.includes("\Microsoft
    SDK") || Image.includes("\Windows Kit") || Image.includes("\Windows Resource Kit\\")
    || Image.includes("\Microsoft.NET\\"))))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aeab5ec5-be14-471a-80e8-e344418305c2_sysmon_ot"'
  description: Executable Used by PlugX in Uncommon Location
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("\msdt.exe") || CommandLine.includes("\installutil.exe")
    || CommandLine.includes("\regsvcs.exe") || CommandLine.includes("\regasm.exe")
    || CommandLine.includes("\msbuild.exe") || CommandLine.includes("\ieexec.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"82a19e3a-2bfe-4a91-8c0d-5d4c98fbb719_sysmon_ot"'
  description: Possible Applocker Bypass
- id: eval
  filter: (EventID=="1" && IntegrityLevel=="Medium" && CommandLine.includes("ControlSet")
    && CommandLine.includes("services") && (CommandLine.includes("\ImagePath") ||
    CommandLine.includes("\FailureCommand") || CommandLine.includes("\ServiceDll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0f9c21f1-6a73-4b0e-9809-cb562cb8d981_sysmon_ot"'
  description: Possible Privilege Escalation via Service Permissions Weakness
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("System.Management.Automation.AmsiUtils"))
    && (CommandLine.includes("amsiInitFailed")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"30edb182-aa75-42c0-b0a9-e998bb29067c_sysmon_ot"'
  description: Powershell AMSI Bypass via .NET Reflection
- id: eval
  filter: (EventID=="1" && CommandLine.includes("WindowsAudioDevice-Powershell-Cmdlet"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"932fb0d8-692b-4b0f-a26e-5643a50fe7d6_sysmon_ot"'
  description: Audio Capture via PowerShell
- id: eval
  filter: (EventID=="1" && CommandLine.includes("AAAAYInlM") && (CommandLine.includes("OiCAAAAYInlM")
    || CommandLine.includes("OiJAAAAYInlM")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2d117e49-e626-4c7c-bd1f-c3c0147774c8_sysmon_ot"'
  description: PowerShell Base64 Encoded Shellcode
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") && CommandLine.includes("Start-BitsTransfer"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f67dbfce-93bc-440d-86ad-a95ae8858c90_sysmon_ot"'
  description: Suspicious Bitsadmin Job via PowerShell
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") && (CommandLine.includes("hctac")
    || CommandLine.includes("kearb") || CommandLine.includes("dnammoc") || CommandLine.includes("ekovn")
    || CommandLine.includes("eliFd") || CommandLine.includes("rahc") || CommandLine.includes("etirw")
    || CommandLine.includes("golon") || CommandLine.includes("tninon") || CommandLine.includes("eddih")
    || CommandLine.includes("tpircS") || CommandLine.includes("ssecorp") || CommandLine.includes("llehsrewop")
    || CommandLine.includes("esnopser") || CommandLine.includes("daolnwod") || CommandLine.includes("tneilCbeW")
    || CommandLine.includes("tneilc") || CommandLine.includes("ptth") || CommandLine.includes("elifotevas")
    || CommandLine.includes("46esab") || CommandLine.includes("htaPpmeTteG") || CommandLine.includes("tcejbO")
    || CommandLine.includes("maerts") || CommandLine.includes("hcaerof") || CommandLine.includes("ekovni")
    || CommandLine.includes("retupmoc")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b6b49cd1-34d6-4ead-b1bf-176e9edba9a4_sysmon_ot"'
  description: Suspicious PowerShell Cmdline
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") && (((((CommandLine.includes("ToInt")
    || CommandLine.includes("ToDecimal") || CommandLine.includes("ToByte") || CommandLine.includes("ToUint")
    || CommandLine.includes("ToSingle") || CommandLine.includes("ToSByte")) && (CommandLine.includes("ToChar")
    || CommandLine.includes("ToString") || CommandLine.includes("String"))) || (CommandLine.includes("char")
    && CommandLine.includes("join"))) || (CommandLine.includes("split") && CommandLine.includes("join")))
    || (CommandLine.includes("ForEach") && CommandLine.includes("Xor")) || (CommandLine.includes("cOnvErTTO-SECUreStRIng"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cdf05894-89e7-4ead-b2b0-0a5f97a90f2f_sysmon_ot"'
  description: Encoded PowerShell Command Line
- id: eval
  filter: (EventID=="1" && (((CommandLine.includes("Add-MpPreference ") || CommandLine.includes("Set-MpPreference
    ")) && (CommandLine.includes(" -ExclusionPath ") || CommandLine.includes(" -ExclusionExtension
    ") || CommandLine.includes(" -ExclusionProcess "))) || (CommandLine.includes("QWRkLU1wUHJlZmVyZW5jZ")
    || CommandLine.includes("FkZC1NcFByZWZlcmVuY2") || CommandLine.includes("BZGQtTXBQcmVmZXJlbmNl"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"17769c90-230e-488b-a463-e05c08e9d48f_sysmon_ot"'
  description: Powershell Defender Exclusion
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\powershell.exe") && (CommandLine.includes("-DisableBehaviorMonitoring
    $true") || CommandLine.includes("-DisableRuntimeMonitoring $true"))) || (CommandLine.includes("sc")
    && CommandLine.includes("stop") && CommandLine.includes("WinDefend")) || (CommandLine.includes("sc")
    && CommandLine.includes("config") && CommandLine.includes("WinDefend") && CommandLine.includes("start=disabled"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a7ee1722-c3c5-aeff-3212-c777e4733217_sysmon_ot"'
  description: Powershell Used To Disable Windows Defender AV Security Monitoring
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\rundll32.exe")) || (Description.includes("Windows-Hostprozess
    (Rundll32)"))) && (CommandLine.includes("Default.GetString") || CommandLine.includes("FromBase64String")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6812a10b-60ea-420c-832f-dfcc33b646ba_sysmon_ot"'
  description: Detection of PowerShell Execution via DLL
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" -version 2 ") || CommandLine.includes("
    -versio 2 ") || CommandLine.includes(" -versi 2 ") || CommandLine.includes(" -vers
    2 ") || CommandLine.includes(" -ver 2 ") || CommandLine.includes(" -ve 2 ")) &&
    Image.endsWith("\powershell.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b3512211-c67e-4707-bedc-66efc7848863_sysmon_ot"'
  description: PowerShell Downgrade Attack
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") && CommandLine.includes("new-object")
    && CommandLine.includes("net.webclient).") && CommandLine.includes("download")
    && (CommandLine.includes("string(") || CommandLine.includes("file(")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3b6ab547-8ec2-4991-b9d2-2b06702a48d7_sysmon_ot"'
  description: PowerShell Download from URL
- id: eval
  filter: (EventID=="1" && CommandLine.includes("::FromBase64String("))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e32d4572-9826-4738-b651-95fa63747e8a_sysmon_ot"'
  description: FromBase64String Command Line
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") && (CommandLine.includes("new-object
    system.net.sockets.tcpclient")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"edc2f8ae-2412-4dfd-b9d5-0c57727e70be_sysmon_ot"'
  description: Powershell Reverse Shell Connection
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\Powershell.exe")) && (CommandLine.includes("
    -windowstyle h ") || CommandLine.includes(" -windowstyl h") || CommandLine.includes("
    -windowsty h") || CommandLine.includes(" -windowst h") || CommandLine.includes("
    -windows h") || CommandLine.includes(" -windo h") || CommandLine.includes(" -wind
    h") || CommandLine.includes(" -win h") || CommandLine.includes(" -wi h") || CommandLine.includes("
    -win h ") || CommandLine.includes(" -win hi ") || CommandLine.includes(" -win
    hid ") || CommandLine.includes(" -win hidd ") || CommandLine.includes(" -win hidde
    ") || CommandLine.includes(" -NoPr ") || CommandLine.includes(" -NoPro ") || CommandLine.includes("
    -NoProf ") || CommandLine.includes(" -NoProfi ") || CommandLine.includes(" -NoProfil
    ") || CommandLine.includes(" -nonin ") || CommandLine.includes(" -nonint ") ||
    CommandLine.includes(" -noninte ") || CommandLine.includes(" -noninter ") || CommandLine.includes("
    -nonintera ") || CommandLine.includes(" -noninterac ") || CommandLine.includes("
    -noninteract ") || CommandLine.includes(" -noninteracti ") || CommandLine.includes("
    -noninteractiv ") || CommandLine.includes(" -ec ") || CommandLine.includes(" -encodedComman
    ") || CommandLine.includes(" -encodedComma ") || CommandLine.includes(" -encodedComm
    ") || CommandLine.includes(" -encodedCom ") || CommandLine.includes(" -encodedCo
    ") || CommandLine.includes(" -encodedC ") || CommandLine.includes(" -encoded ")
    || CommandLine.includes(" -encode ") || CommandLine.includes(" -encod ") || CommandLine.includes("
    -enco ") || CommandLine.includes(" -en ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"36210e0d-5b19-485d-a087-c096088885f0_sysmon_ot"'
  description: Suspicious PowerShell Parameter Substring
- id: eval
  filter: (EventID=="1" && ((Description=="Windows PowerShell" || Product=="PowerShell
    Core 6") && (CommandLine.includes("bxor") || CommandLine.includes("-join ") ||
    CommandLine.includes("-join'") || CommandLine.includes("-join"") || CommandLine.includes("-join`")
    || CommandLine.includes("char"))) &&  ! ((ParentImage=="C:\Program Files\Amazon\SSM\ssm-document-worker.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bb780e0c-16cf-4383-8383-1e5471db6cf9_sysmon_ot"'
  description: Suspicious XOR Encoded PowerShell Command Line
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\powershell.exe") && Image.endsWith("\schtasks.exe")
    && CommandLine.includes("/Create") && CommandLine.includes("/SC") && (CommandLine.includes("ONLOGON")
    || CommandLine.includes("DAILY") || CommandLine.includes("ONIDLE") || CommandLine.includes("Updater"))
    && CommandLine.includes("/TN") && CommandLine.includes("Updater") && CommandLine.includes("/TR")
    && CommandLine.includes("powershell"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"56c217c3-2de2-479b-990f-5c109ba8458f_sysmon_ot"'
  description: Default PowerSploit and Empire Schtasks Persistence
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\procdump.exe") || Image.endsWith("\procdump64.exe"))
    || (CommandLine.includes(" -ma ") && CommandLine.includes(".exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2e65275c-8288-4ab4-aeb7-6274f58b6b20_sysmon_ot"'
  description: Procdump Usage
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("copy procdump") || CommandLine.includes("move
    procdump")) || (CommandLine.includes("copy ") && CommandLine.includes(".dmp ")
    && (CommandLine.includes("2.dmp") || CommandLine.includes("lsass") || CommandLine.includes("out.dmp")))
    || (CommandLine.includes("copy lsass.exe_") || CommandLine.includes("move lsass.exe_"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"79b06761-465f-4f88-9ef2-150e24d3d737_sysmon_ot"'
  description: Procdump Evasion
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\bitsadmin.exe")) && (((CommandLine.includes("
    /create ") || CommandLine.includes(" /addfile ")) && (CommandLine.includes("http")))
    || (CommandLine.includes(" /transfer ")))) || (CommandLine.includes("copy bitsadmin.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d059842b-6b9d-4ed1-b5c3-5b89143c6ede_sysmon_ot"'
  description: Bitsadmin Download
- id: eval
  filter: (EventID=="1" && OriginalFileName=="RdrLeakDiag.exe" && CommandLine.includes("fullmemdmp"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"edadb1e5-5919-4e4c-8462-a9e643b02c4b_sysmon_ot"'
  description: Process Dump via RdrLeakDiag.exe
- id: eval
  filter: (EventID=="1" && (((CommandLine.includes("comsvcs.dll") || CommandLine.includes("rundll32")
    || CommandLine.includes(".dmp")) && (Commandline.includes("#24") || Commandline.includes("#+24")
    || Commandline.includes("MiniDump")) && CommandLine.includes(" full")) || CommandLine.includes("#-4294967272")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"646ea171-dded-4578-8a4d-65e9822892e3_sysmon_ot"'
  description: Process Dump via Rundll32 and Comsvcs.dll
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\createdump.exe") && CommandLine.includes("
    -u ") && CommandLine.includes(" -f ")) || (CommandLine.includes(" -u -f ") &&
    CommandLine.includes(".dmp "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48_sysmon_ot"'
  description: CreateDump Process Dump
- id: eval
  filter: (EventID=="1" && CommandLine.includes("/fullmemdmp") && (Image.endsWith("\rdrleakdiag.exe")
    || (CommandLine.includes(" /o ") && CommandLine.includes(" /p "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6355a919-2e97-4285-a673-74645566340d_sysmon_ot"'
  description: RdrLeakDiag Process Dump
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\svchost.exe") || Image.endsWith("\taskhost.exe")
    || Image.endsWith("\lsm.exe") || Image.endsWith("\lsass.exe") || Image.endsWith("\services.exe")
    || Image.endsWith("\lsaiso.exe") || Image.endsWith("\csrss.exe") || Image.endsWith("\wininit.exe")
    || Image.endsWith("\winlogon.exe")) &&  ! ((ParentImage.endsWith("\SavService.exe")
    || ParentImage.endsWith("\ngen.exe")) || (ParentImage.includes("\System32\\")
    || ParentImage.includes("\SysWOW64\\")))) &&  ! ((ParentImage.includes("\Windows
    Defender\\") || ParentImage.includes("\Microsoft Security Client\\")) && ParentImage.endsWith("\MsMpEng.exe")))
    &&  ! (ParentImage ===null ))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"96036718-71cc-4027-a538-d1587e0006a7_sysmon_ot"'
  description: Windows Processes Suspicious Parent Directory
- id: eval
  filter: (EventID=="1" && CommandLine=="C:\Windows\PSEXESVC.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3ede524d-21cc-472d-a3ce-d21b568d8db7_sysmon_ot"'
  description: PsExec Service Start
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("xyz123456.exe") || CommandLine.includes("PurpleSharp"))
    || OriginalFileName=="PurpleSharp.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ff23ffbc-3378-435e-992f-0624dcf93ab4_sysmon_ot"'
  description: PurpleSharp Indicator
- id: eval
  filter: (EventID=="1" && Image.endsWith("\reg.exe") && (CommandLine.includes("query")
    || CommandLine.includes("save") || CommandLine.includes("export")) && (CommandLine.includes("currentVersion\windows")
    || CommandLine.includes("currentVersion\runServicesOnce") || CommandLine.includes("currentVersion\runServices")
    || CommandLine.includes("winlogon\\") || CommandLine.includes("currentVersion\shellServiceObjectDelayLoad")
    || CommandLine.includes("currentVersion\runOnce") || CommandLine.includes("currentVersion\runOnceEx")
    || CommandLine.includes("currentVersion\run") || CommandLine.includes("currentVersion\policies\explorer\run")
    || CommandLine.includes("currentcontrolset\services")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"970007b7-ce32-49d0-a4a4-fbef016950bd_sysmon_ot"'
  description: Query Registry
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\rasautou.exe") || OriginalFileName=="rasdlui.exe")
    && (CommandLine.includes("-d") && CommandLine.includes("-p")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd3d1298-eb3b-476c-ac67-12847de55813_sysmon_ot"'
  description: DLL Execution via Rasautou.exe
- id: eval
  filter: (EventID=="1" && CommandLine.includes("noconsentprompt") && CommandLine.includes("shadow:"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6ba5a05f-b095-4f0a-8654-b825f4f16334_sysmon_ot"'
  description: MSTSC Shadowing
- id: eval
  filter: (EventID=="1" && (Image.includes("rundll32.exe") || Image.includes("cmd.exe"))
    && (CommandLine.includes("gthread-3.6.dll") || CommandLine.includes("\Windows\Temp\tmp.bat")
    || CommandLine.includes("sigcmm-2.4.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"95022b85-ff2a-49fa-939a-d7b8f56eeb9b_sysmon_ot"'
  description: RedMimicry Winnti Playbook Execute
- id: eval
  filter: (EventID=="1" && Image.endsWith("\regedit.exe") && CommandLine.includes("
    /E ") && (CommandLine.includes("hklm") || CommandLine.includes("hkey_local_machine"))
    && (CommandLine.endsWith("\system") || CommandLine.endsWith("\sam") || CommandLine.endsWith("\security")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"82880171-b475-4201-b811-e9c826cd5eaa_sysmon_ot"'
  description: Exports Critical Registry Keys To a File
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\regedit.exe") && CommandLine.includes("
    /E ")) &&  ! (((CommandLine.includes("hklm") || CommandLine.includes("hkey_local_machine"))
    && (CommandLine.endsWith("\system") || CommandLine.endsWith("\sam") || CommandLine.endsWith("\security")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f0e53e89-8d22-46ea-9db5-9d4796ee2f8a_sysmon_ot"'
  description: Exports Registry Key To a File
- id: eval
  filter: (EventID=="1" && CommandLine.includes("reg") && CommandLine.includes(" ADD
    ") && CommandLine.includes("Software\Microsoft\Windows\CurrentVersion\Run"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"de587dce-915e-4218-aac4-835ca6af6f70_sysmon_ot"'
  description: Reg Add RUN Key
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\wsmprovhost.exe") || ParentImage.endsWith("\wsmprovhost.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"734f8d9b-42b8-41b2-bcf5-abaf49d5a3c8_sysmon_ot"'
  description: Remote PowerShell Session Host Process (WinRM)
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\net.exe") || Image.endsWith("\net1.exe"))
    && CommandLine.includes("time")) || (Image.endsWith("\w32tm.exe") && CommandLine.includes("tz"))
    || (Image.endsWith("\powershell.exe") && CommandLine.includes("Get-Date"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b243b280-65fe-48df-ba07-6ddea7646427_sysmon_ot"'
  description: Discovery of a System Time
- id: eval
  filter: (EventID=="1" && (OriginalFileName=="cmd.exe" || OriginalFileName=="CONHOST.EXE"
    || OriginalFileName=="powershell.exe" || OriginalFileName=="powershell_ise.exe"
    || OriginalFileName=="psexec.exe" || OriginalFileName=="psexec.c" || OriginalFileName=="cscript.exe"
    || OriginalFileName=="wscript.exe" || OriginalFileName=="mshta.exe" || OriginalFileName=="regsvr32.exe"
    || OriginalFileName=="wmic.exe" || OriginalFileName=="certutil.exe" || OriginalFileName=="rundll32.exe"
    || OriginalFileName=="cmstp.exe" || OriginalFileName=="msiexec.exe" || OriginalFileName=="7z.exe"
    || OriginalFileName=="winrar.exe" || OriginalFileName=="wevtutil.exe" || OriginalFileName=="net.exe"
    || OriginalFileName=="net1.exe" || OriginalFileName=="netsh.exe") &&  ! ((Image.endsWith("\cmd.exe")
    || Image.endsWith("\conhost.exe") || Image.endsWith("\powershell.exe") || Image.endsWith("\powershell_ise.exe")
    || Image.endsWith("\psexec.exe") || Image.endsWith("\psexec64.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\wscript.exe") || Image.endsWith("\mshta.exe") || Image.endsWith("\regsvr32.exe")
    || Image.endsWith("\wmic.exe") || Image.endsWith("\certutil.exe") || Image.endsWith("\rundll32.exe")
    || Image.endsWith("\cmstp.exe") || Image.endsWith("\msiexec.exe") || Image.endsWith("\7z.exe")
    || Image.endsWith("\winrar.exe") || Image.endsWith("\wevtutil.exe") || Image.endsWith("\net.exe")
    || Image.endsWith("\net1.exe") || Image.endsWith("\netsh.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"36480ae1-a1cb-4eaa-a0d6-29801d7e9142_sysmon_ot"'
  description: Renamed Binary
- id: eval
  filter: (EventID=="1" && (OriginalFileName=="powershell.exe" || OriginalFileName=="powershell_ise.exe"
    || OriginalFileName=="psexec.exe" || OriginalFileName=="psexec.c" || OriginalFileName=="cscript.exe"
    || OriginalFileName=="wscript.exe" || OriginalFileName=="mshta.exe" || OriginalFileName=="regsvr32.exe"
    || OriginalFileName=="wmic.exe" || OriginalFileName=="certutil.exe" || OriginalFileName=="rundll32.exe"
    || OriginalFileName=="cmstp.exe" || OriginalFileName=="msiexec.exe") &&  ! ((Image.endsWith("\powershell.exe")
    || Image.endsWith("\powershell_ise.exe") || Image.endsWith("\psexec.exe") || Image.endsWith("\psexec64.exe")
    || Image.endsWith("\cscript.exe") || Image.endsWith("\wscript.exe") || Image.endsWith("\mshta.exe")
    || Image.endsWith("\regsvr32.exe") || Image.endsWith("\wmic.exe") || Image.endsWith("\certutil.exe")
    || Image.endsWith("\rundll32.exe") || Image.endsWith("\cmstp.exe") || Image.endsWith("\msiexec.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0ba1da6d-b6ce-4366-828c-18826c9de23e_sysmon_ot"'
  description: Highly Relevant Renamed Binary
- id: eval
  filter: (EventID=="1" && (Description=="Java Update Scheduler" || Description=="Java(TM)
    Update Scheduler") &&  ! ((Image.endsWith("\jusched.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"edd8a48c-1b9f-4ba1-83aa-490338cd1ccb_sysmon_ot"'
  description: Renamed jusched.exe
- id: eval
  filter: (EventID=="1" && ((ParentImage.endsWith("\explorer.exe") && CommandLine.includes("C:\Windows\Temp\meg.exe"))
    || (OriginalFileName=="meg.exe" &&  ! (Image.endsWith("\meg.exe")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"643bdcac-8b82-49f4-9fd9-25a90b929f3b_sysmon_ot"'
  description: Renamed MegaSync
- id: eval
  filter: (EventID=="1" && ((Product.includes("PAExec")) && (Imphash=="11D40A7B7876288F919AB819CC2D9802"
    || Imphash=="6444f8a34e99b8f7d9647de66aabe516" || Imphash=="dfd6aa3f7b2b1035b76b718f1ddc689f"
    || Imphash=="1a6cca4d5460b1710a12dea39e4a592c")) &&  ! (Image.includes("paexec")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7b0666ad-3e38-4e3d-9bab-78b06de85f7b_sysmon_ot"'
  description: Execution of Renamed PaExec
- id: eval
  filter: (EventID=="1" && ((Description.startsWith("Windows PowerShell") || Description.startsWith("pwsh"))
    && Company=="Microsoft Corporation") &&  ! ((Image.endsWith("\powershell.exe")
    || Image.endsWith("\powershell_ise.exe") || Image.endsWith("\pwsh.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20_sysmon_ot"'
  description: Renamed PowerShell
- id: eval
  filter: (EventID=="1" && ((OriginalFileName=="procdump" || (CommandLine.includes("
    -ma ") && CommandLine.includes(" -accepteula "))) || (CommandLine.includes(" -ma
    ") && CommandLine.includes(".dmp"))) &&  ! ((Image.endsWith("\procdump.exe") ||
    Image.endsWith("\procdump64.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67_sysmon_ot"'
  description: Renamed ProcDump
- id: eval
  filter: (EventID=="1" && (Description=="Execute processes remotely" && Product=="Sysinternals
    PsExec") &&  ! ((Image.endsWith("\PsExec.exe") || Image.endsWith("\PsExec64.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2_sysmon_ot"'
  description: Renamed PsExec
- id: eval
  filter: (EventID=="1" && OriginalFileName=="whoami.exe" &&  ! (Image.endsWith("\whoami.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f1086bf7-a0c4-4a37-9102-01e573caf4a0_sysmon_ot"'
  description: Renamed Whoami Execution
- id: eval
  filter: (EventID=="1" && CommandLine=="rundll32.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5bb68627-3198-40ca-b458-49f973db8752_sysmon_ot"'
  description: Rundll32 Without Parameters
- id: eval
  filter: (EventID=="1" && Image.endsWith("\rundll32.exe") &&  ! ((CommandLine ===null
    ) || (CommandLine.includes(".dll") || CommandLine=="")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c3a99af4-35a9-4668-879e-c09aeb4f2bdf_sysmon_ot"'
  description: Application Executed Non-Executable Extension
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\powershell.exe") && Image.endsWith("\powershell.exe")
    && CommandLine.includes("Get-Content") && CommandLine.includes("-Stream"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"45a594aa-1fbd-4972-a809-ff5a99dd81b8_sysmon_ot"'
  description: Run PowerShell Script from ADS
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("VBoxRT.dll,RTR3Init") || CommandLine.includes("VBoxC.dll")
    || CommandLine.includes("VBoxDrv.sys")) || (CommandLine.includes("startvm") ||
    CommandLine.includes("controlvm"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bab049ca-7471-4828-9024-38279a4c04da_sysmon_ot"'
  description: Detect Virtualbox Driver Installation OR Starting Of VMs
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\scrcons.exe")) && (Image.endsWith("\svchost.exe")
    || Image.endsWith("\dllhost.exe") || Image.endsWith("\powershell.exe") || Image.endsWith("\wscript.exe")
    || Image.endsWith("\cscript.exe") || Image.endsWith("\schtasks.exe") || Image.endsWith("\regsvr32.exe")
    || Image.endsWith("\mshta.exe") || Image.endsWith("\rundll32.exe") || Image.endsWith("\msiexec.exe")
    || Image.endsWith("\msbuild.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f6d1dd2f-b8ce-40ca-bc23-062efb686b34_sysmon_ot"'
  description: Script Event Consumer Spawning Process
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\sdbinst.exe") && CommandLine.includes(".sdb"))
    &&  ! ((CommandLine.includes("iisexpressshim.sdb"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"517490a7-115a-48c6-8862-1a481504d5a8_sysmon_ot"'
  description: Possible Shim Database Persistence via sdbinst.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\net.exe") || Image.endsWith("\net1.exe"))
    && CommandLine.includes(" start "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2a072a96-a086-49fa-bcb5-15cc5a619093_sysmon_ot"'
  description: Service Execution
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\sc.exe") || Image.endsWith("\net.exe")
    || Image.endsWith("\net1.exe")) && CommandLine.includes("stop")) &&  ! (CommandLine=="sc  stop
    KSCWebConsoleMessageQueue" && (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"eb87818d-db5d-49cc-a987-d5da331fbd90_sysmon_ot"'
  description: Stop Windows Service
- id: eval
  filter: (EventID=="1" && CommandLine.includes("mklink") && CommandLine.includes("HarddiskVolumeShadowCopy"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"40b19fa6-d835-400c-b301-41f3a2baacaf_sysmon_ot"'
  description: Shadow Copies Access via Symlink
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\powershell.exe") || Image.endsWith("\wmic.exe")
    || Image.endsWith("\vssadmin.exe")) && CommandLine.includes("shadow") && CommandLine.includes("create"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b17ea6f7-6e90-447e-a799-e6c0a493d6ce_sysmon_ot"'
  description: Shadow Copies Creation Using Operating Systems Utilities
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\powershell.exe") || Image.endsWith("\wmic.exe")
    || Image.endsWith("\vssadmin.exe") || Image.endsWith("\diskshadow.exe")) && CommandLine.includes("shadow")
    && CommandLine.includes("delete")) || ((Image.endsWith("\wbadmin.exe")) && CommandLine.includes("delete")
    && CommandLine.includes("catalog") && CommandLine.includes("quiet")) || (Image.endsWith("\vssadmin.exe")
    && CommandLine.includes("resize") && CommandLine.includes("shadowstorage") &&
    CommandLine.includes("unbounded"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c947b146-0abc-4c87-9c64-b17e9d7274a2_sysmon_ot"'
  description: Shadow Copies Deletion Using Operating Systems Utilities
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\mshta.exe") && (Image.endsWith("\powershell.exe")
    || Image.endsWith("\cmd.exe") || Image.endsWith("\WScript.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"772bb24c-8df2-4be0-9157-ae4dfa794037_sysmon_ot"'
  description: Mshta Spawning Windows Shell
- id: eval
  filter: (EventID=="1" && ((ParentImage.endsWith("\mshta.exe") || ParentImage.endsWith("\powershell.exe")
    || ParentImage.endsWith("\rundll32.exe") || ParentImage.endsWith("\cscript.exe")
    || ParentImage.endsWith("\wscript.exe") || ParentImage.endsWith("\wmiprvse.exe"))
    && (Image.endsWith("\schtasks.exe") || Image.endsWith("\nslookup.exe") || Image.endsWith("\certutil.exe")
    || Image.endsWith("\bitsadmin.exe") || Image.endsWith("\mshta.exe"))) &&  ! (CurrentDirectory.includes("\ccmcache\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3a6586ad-127a-4d3b-a677-1e6eacdf8fde_sysmon_ot"'
  description: Windows Shell Spawning Suspicious Program
- id: eval
  filter: (EventID=="1" && Description.includes("st2stager"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"03552375-cc2c-4883-bbe4-7958d5a980be_sysmon_ot"'
  description: SILENTTRINITY Stager Execution
- id: eval
  filter: (EventID=="1" && Image.endsWith("\SoundRecorder.exe") && CommandLine.includes("/FILE"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"83865853-59aa-449e-9600-74b9d89a6d6e_sysmon_ot"'
  description: Audio Capture via SoundRecorder
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\setspn.exe") || (Description.includes("Query
    or reset the computer") && Description.includes("SPN attribute"))) && CommandLine.includes("-q"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1eeed653-dbc8-4187-ad0c-eeebb20e6599_sysmon_ot"'
  description: Possible SPN Enumeration
- id: eval
  filter: (EventID=="1" && CommandLine=="copy /y C:\windows\system32\cmd.exe C:\windows\system32\sethc.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1070db9a-3e5d-412e-8e7b-7183b616e1b3_sysmon_ot"'
  description: Using Sticky-keys To Obtain Unauthenticated, Privileged Console Access
- id: eval
  filter: (EventID=="1" && CommandLine.includes("net ") && CommandLine.includes("localgroup")
    && CommandLine.includes("Remote Desktop Users") && CommandLine.includes("/add"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ffa28e60-bdb1-46e0-9f82-05f7a61cc06e_sysmon_ot"'
  description: Suspicious Add User to Remote Desktop Users Group
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("objectcategory") || CommandLine.includes("trustdmp")
    || CommandLine.includes("dcmodes") || CommandLine.includes("dclist") || CommandLine.includes("computers_pwdnotreqd"))
    && Image.endsWith("\adfind.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"75df3b17-8bcc-4565-b89b-c9898acef911_sysmon_ot"'
  description: Suspicious AdFind Execution
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\AdvancedRun.exe") || (CommandLine.includes("
    /EXEFilename ") && CommandLine.includes(" /Run")) || (CommandLine.includes(" /WindowState
    0") && CommandLine.includes(" /RunAs ") && CommandLine.includes(" /CommandLine
    "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d2b749ee-4225-417e-b20e-a8d2193cbb84_sysmon_ot"'
  description: Suspicious AdvancedRun Execution
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("/EXEFilename") || CommandLine.includes("/CommandLine"))
    && ((CommandLine.includes(" /RunAs 8 ") || CommandLine.includes(" /RunAs 4 "))
    || (CommandLine.endsWith("/RunAs 8") || CommandLine.endsWith("/RunAs 4"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fa00b701-44c6-4679-994d-5a18afa8a707_sysmon_ot"'
  description: Suspicious AdvancedRun Runas Priv User
- id: eval
  filter: (EventID=="1" && (Image.endsWith("AtBroker.exe") && CommandLine.includes("start"))
    &&  ! ((CommandLine.includes("animations") || CommandLine.includes("audiodescription")
    || CommandLine.includes("caretbrowsing") || CommandLine.includes("caretwidth")
    || CommandLine.includes("colorfiltering") || CommandLine.includes("cursorscheme")
    || CommandLine.includes("filterkeys") || CommandLine.includes("focusborderheight")
    || CommandLine.includes("focusborderwidth") || CommandLine.includes("highcontrast")
    || CommandLine.includes("keyboardcues") || CommandLine.includes("keyboardpref")
    || CommandLine.includes("magnifierpane") || CommandLine.includes("messageduration")
    || CommandLine.includes("minimumhitradius") || CommandLine.includes("mousekeys")
    || CommandLine.includes("Narrator") || CommandLine.includes("osk") || CommandLine.includes("overlappedcontent")
    || CommandLine.includes("showsounds") || CommandLine.includes("soundsentry") ||
    CommandLine.includes("stickykeys") || CommandLine.includes("togglekeys") || CommandLine.includes("windowarranging")
    || CommandLine.includes("windowtracking") || CommandLine.includes("windowtrackingtimeout")
    || CommandLine.includes("windowtrackingzorder"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f24bcaea-0cd1-11eb-adc1-0242ac120002_sysmon_ot"'
  description: Suspicious Atbroker Execution
- id: eval
  filter: (EventID=="1" && Image.endsWith("\bcdedit.exe") && (CommandLine.includes("delete")
    || CommandLine.includes("deletevalue") || CommandLine.includes("import") || CommandLine.includes("safeboot")
    || CommandLine.includes("network")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c9fbe8e9-119d-40a6-9b59-dd58a5d84429_sysmon_ot"'
  description: Possible Ransomware or Unauthorized MBR Modifications
- id: eval
  filter: (EventID=="1" && Image.endsWith("\bginfo.exe") && CommandLine.includes("/popup")
    && CommandLine.includes("/nolicprompt"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aaf46cdc-934e-4284-b329-34aa701e3771_sysmon_ot"'
  description: Application Whitelisting Bypass via Bginfo
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\powershell.exe") || Image.endsWith("\powershell_ise.exe")
    || Image.endsWith("\pwsh.exe")) && (CommandLine.includes("Get-BitsTransfer") ||
    CommandLine.includes("Add-BitsFile")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd5c8085-4070-4e22-908d-a5b3342deb74_sysmon_ot"'
  description: Suspicious Bitstransfer via PowerShell
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("\calc.exe ") || (Image.endsWith("\calc.exe")
    &&  ! (Image.includes("\Windows\Sys")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"737e618a-a410-49b5-bec3-9e55ff7fbc15_sysmon_ot"'
  description: Suspicious Calculator Usage
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cdb.exe") && CommandLine.includes("-cf"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b5c7395f-e501-4a08-94d4-57fe7a9da9d2_sysmon_ot"'
  description: Possible App Whitelisting Bypass via WinDbg/CDB as a Shellcode Runner
- id: eval
  filter: (EventID=="1" && Image.endsWith("\certreq.exe") && CommandLine.includes("
    -Post ") && CommandLine.includes(" -config ") && CommandLine.includes(" http")
    && CommandLine.includes(" C:\windows\win.ini "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4480827a-9799-4232-b2c4-ccc6c4e9e12b_sysmon_ot"'
  description: Suspicious Certreq Command to Download
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes(" -decode ") || CommandLine.includes("
    -decodehex ") || CommandLine.includes(" -urlcache ") || CommandLine.includes("
    -verifyctl ") || CommandLine.includes(" -encode ") || CommandLine.includes(" /decode
    ") || CommandLine.includes(" /decodehex ") || CommandLine.includes(" /urlcache
    ") || CommandLine.includes(" /verifyctl ") || CommandLine.includes(" /encode "))
    || (Image.endsWith("\certutil.exe") && (CommandLine.includes("URL") || CommandLine.includes("ping")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e011a729-98a6-4139-b5c4-bf6f6dd8239a_sysmon_ot"'
  description: Suspicious Certutil Command
- id: eval
  filter: (EventID=="1" && Image.endsWith("\certutil.exe") && CommandLine.includes("-f")
    && CommandLine.includes("-encode"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e62a9f0c-ca1e-46b2-85d5-a6da77f86d1a_sysmon_ot"'
  description: Certutil Encode
- id: eval
  filter: (EventID=="1" && ((ParentUser=="NT AUTHORITY\NETWORK SERVICE" || ParentUser=="NT
    AUTHORITY\LOCAL SERVICE" || ParentUser=="AUTORITE NT\") && (User=="NT AUTHORITY\SYSTEM"
    || User=="AUTORITE NT\Sys") && IntegrityLevel=="System") &&  ! (Image.endsWith("\rundll32.exe")
    && CommandLine.includes("DavSetCookie")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"590a5f4c-6c8c-4f10-8307-89afe9453a9d_sysmon_ot"'
  description: Suspicious Child Process Created as System
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("h^t^t^p") || CommandLine.includes("h"t"t"p")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f0cdd048-82dc-4f7a-8a7a-b87a52b6d0fd_sysmon_ot"'
  description: Suspicious Commandline Escape
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cmd.exe") && CommandLine.includes("http")
    && CommandLine.includes("://") && CommandLine.includes("%AppData%"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1ac8666b-046f-4201-8aba-1951aaec03a3_sysmon_ot"'
  description: Command Line Execution with Suspicious URL and AppData Strings
- id: eval
  filter: (EventID=="1" && CommandLine.includes("copy \\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c73124a7-3e89-44a3-bdc1-25fe4df754b1_sysmon_ot"'
  description: Conti Volume Shadow Listing
- id: eval
  filter: (EventID=="1" && Image.endsWith("\chcp.com") && (CommandLine.endsWith("
    936") || CommandLine.endsWith(" 1258")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c7942406-33dd-4377-a564-0f62db0593a3_sysmon_ot"'
  description: Suspicious Code Page Switch
- id: eval
  filter: (EventID=="1" && ((OriginalFileName=="7z*.exe" || OriginalFileName.endsWith("rar.exe")
    || OriginalFileName.includes("Command*Line*RAR")) && (CommandLine.includes(" -p")
    || CommandLine.includes(" -ta") || CommandLine.includes(" -tb") || CommandLine.includes("
    -sdel") || CommandLine.includes(" -dw") || CommandLine.includes(" -hp"))) &&  !
    (ParentImage.startsWith("C:\Program")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"27a72a60-7e5e-47b1-9d17-909c9abafdcd_sysmon_ot"'
  description: Suspicious Compression Tool Parameters
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\rundll32.exe") || OriginalFileName=="RUNDLL32.EXE")
    && (CommandLine.includes("comsvcs") && CommandLine.includes("MiniDump") && CommandLine.includes("full")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"09e6d5c0-05b8-4ff8-9eeb-043046ec774c_sysmon_ot"'
  description: Process Dump via Comsvcs DLL
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\conhost.exe") &&  ! (Provider_Name=="SystemTraceProvider-Process"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7dc2dedd-7603-461a-bc13-15803d132355_sysmon_ot"'
  description: Conhost Parent Process Executions
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\control.exe") && (ParentImage.endsWith("\winword.exe")
    || ParentImage.endsWith("\powerpnt.exe") || ParentImage.endsWith("\excel.exe")))
    &&  ! (CommandLine.endsWith("\control.exe input.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"894397c6-da03-425c-a589-3d09e7d1f750_sysmon_ot"'
  description: CVE-2021-40444 Process Pattern
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\System32\control.exe") && Image.endsWith("\rundll32.exe
    ")) &&  ! (CommandLine.includes("Shell32.dll")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d7eb979b-c2b5-4a6f-a3a7-c87ce6763819_sysmon_ot"'
  description: Suspicious Control Panel DLL Load
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\robocopy.exe") || Image.endsWith("\xcopy.exe"))
    || (Image.endsWith("\cmd.exe") && CommandLine.includes("copy"))) || (Image.includes("\powershell")
    && (CommandLine.includes("copy-item") || CommandLine.includes("copy") || CommandLine.includes("cpi
    ") || CommandLine.includes(" cp ")))) && (CommandLine.includes("\\\\\") && CommandLine.includes("$")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"855bc8b5-2ae8-402e-a9ed-b889e6df1900_sysmon_ot"'
  description: Copy from Admin Share
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("xcopy*\System32\\") || CommandLine.includes("cmd.exe*/c*copy*\System32\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fff9d2b7-e11c-4a69-93d3-40ef66189767_sysmon_ot"'
  description: Suspicious Copy From or To System32
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("-Sta") && CommandLine.includes("-Nop")
    && CommandLine.includes("-Window") && CommandLine.includes("Hidden") && (CommandLine.includes("-Command")
    || CommandLine.includes("-EncodedCommand"))) || (CommandLine.includes("sv o (New-Object
    IO.MemorySteam);sv d ") || CommandLine.includes("mshta file.hta") || CommandLine.includes("GruntHTTP")
    || CommandLine.includes("-EncodedCommand cwB2ACAAbwAgA"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c260b6db-48ba-4b4a-a76f-2f67644e99d2_sysmon_ot"'
  description: Covenant Launcher Indicators
- id: eval
  filter: (EventID=="1" && (CommandLine.endsWith("cmd.exe /Q /c * 1> \\\\*\\*\\* 2>&1")
    || CommandLine.endsWith("cmd.exe /C * > \\\\*\\*\\* 2>&1") || CommandLine.endsWith("cmd.exe
    /C * > *\\Temp\\* 2>&1")) && (CommandLine.includes("powershell.exe -exec bypass
    -noni -nop -w 1 -C "") || CommandLine.includes("powershell.exe -noni -nop -w 1
    -enc ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"058f4380-962d-40a5-afce-50207d36d7e2_sysmon_ot"'
  description: CrackMapExec Command Execution
- id: eval
  filter: (EventID=="1" && CommandLine.includes("powershell.exe") && (CommandLine.includes("join*split")
    || CommandLine.includes("( $ShellId[1]+$ShellId[13]+'x')") || CommandLine.includes("(
    $PSHome[*]+$PSHOME[*]+") || CommandLine.includes("( $env:Public[13]+$env:Public[5]+'x')")
    || CommandLine.includes("( $env:ComSpec[4,*,25]-Join'')") || CommandLine.includes("[1,3]+'x'-Join'')")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6f8b3439-a203-45dc-a88b-abf57ea15ccf_sysmon_ot"'
  description: CrackMapExec PowerShell Obfuscation
- id: eval
  filter: (EventID=="1" && Image.endsWith("\csc.exe") && (ParentImage.endsWith("\wscript.exe")
    || ParentImage.endsWith("\cscript.exe") || ParentImage.endsWith("\mshta.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b730a276-6b63-41b8-bcf8-55930c8fc6ee_sysmon_ot"'
  description: Suspicious Parent of Csc.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\csc.exe") && (CommandLine.includes("\AppData\\")
    || CommandLine.includes("\Windows\Temp\\"))) &&  ! (ParentImage.startsWith("C:\Program
    Files") || (ParentImage.endsWith("\sdiagnhost.exe") || ParentImage.endsWith("\w3wp.exe")
    || ParentImage.endsWith("\choco.exe")) || (ParentCommandLine.includes("\ProgramData\Microsoft\Windows
    Defender Advanced Threat Protection"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dcaa3f04-70c3-427a-80b4-b870d73c94c4_sysmon_ot"'
  description: Suspicious Csc.exe Source File Folder
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\csi.exe") || Image.endsWith("\rcsi.exe")
    || OriginalFileName=="csi.exe" || OriginalFileName=="rcsi.exe") && Company=="Microsoft
    Corporation")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"40b95d31-1afc-469e-8d34-9a3a667d058e_sysmon_ot"'
  description: Suspicious Csi.exe Usage
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\curl.exe") || Product=="The curl executable")
    && CommandLine.includes(" -O "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e218595b-bbe7-4ee5-8a96-f32a24ad3468_sysmon_ot"'
  description: Suspicious Curl Usage on Windows
- id: eval
  filter: (EventID=="1" && Image.endsWith("\curl.exe") && (CommandLine.includes("
    -F ") || CommandLine.includes(" -T ") || CommandLine.includes(" --upload-file
    ") || CommandLine.includes(" -d ") || CommandLine.includes(" --data ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"00bca14a-df4e-4649-9054-3f2aa676bc04_sysmon_ot"'
  description: Suspicious Curl File Upload
- id: eval
  filter: (EventID=="1" && CommandLine.includes("curl") && CommandLine.includes("
    start "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"21dd6d38-2b18-4453-9404-a0fe4a0cc288_sysmon_ot"'
  description: Curl Start Combination
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\dctask64.exe")) &&  ! ((CommandLine.includes("DesktopCentral_Agent\agent"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6345b048-8441-43a7-9bed-541133633d7a_sysmon_ot"'
  description: ZOHO Dctask64 Process Injection
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes(" /lockscreenurl:") &&  ! ((CommandLine.includes(".jpg")
    || CommandLine.includes(".jpeg") || CommandLine.includes(".png")))) || (CommandLine.includes("reg
    delete") && CommandLine.includes("\PersonalizationCSP"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bb58aa4a-b80b-415a-a2c0-2f65a4c81009_sysmon_ot"'
  description: Suspicious Desktopimgdownldr Command
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" -t msi-install ") && CommandLine.includes("
    -i http"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"90d50722-0483-4065-8e35-57efaadd354d_sysmon_ot"'
  description: DevInit Lolbin Download
- id: eval
  filter: (EventID=="1" && Image.endsWith("\devtoolslauncher.exe") && CommandLine.includes("LaunchForDeploy"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6_sysmon_ot"'
  description: Devtoolslauncher.exe Executes Specified Binary
- id: eval
  filter: (EventID=="1" && Image.endsWith("\reg.exe") && CommandLine.includes("add")
    && (CommandLine.includes("\software\Microsoft\Windows\CurrentVersion\Run") ||
    CommandLine.includes("\software\Microsoft\Windows\CurrentVersion\RunOnce") ||
    CommandLine.includes("\software\Microsoft\Windows\CurrentVersion\RunOnceEx") ||
    CommandLine.includes("\software\Microsoft\Windows\CurrentVersion\RunServices")
    || CommandLine.includes("\software\Microsoft\Windows\CurrentVersion\RunServicesOnce")
    || CommandLine.includes("\software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit")
    || CommandLine.includes("\software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell")
    || CommandLine.includes("\software\Microsoft\Windows NT\CurrentVersion\Windows")
    || CommandLine.includes("\software\Microsoft\Windows\CurrentVersion\Explorer\User
    Shell Folders") || CommandLine.includes("\system\CurrentControlSet\Control\SafeBoot\AlternateShell")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"24357373-078f-44ed-9ac4-6d334a668a11_sysmon_ot"'
  description: Direct Autorun Keys Modification
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("logman ")) && (CommandLine.includes("stop
    ") || CommandLine.includes("delete ")) && (CommandLine.includes("EventLog-System")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd1f961e-0b96-436b-b7c6-38da4583ec00_sysmon_ot"'
  description: Disable or Delete Windows Eventlog
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes(" -name IEHarden ") && CommandLine.includes("
    -value 0 ")) || (CommandLine.includes(" -name DEPOff ") && CommandLine.includes("
    -value 1 ")) || (CommandLine.includes(" -name DisableFirstRunCustomize ") && CommandLine.includes("
    -value 2 "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fb50eb7a-5ab1-43ae-bcc9-091818cb8424_sysmon_ot"'
  description: Disabled IE Security Features
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("taskkill ") && CommandLine.includes("RaccineSettings.exe"))
    || (CommandLine.includes("reg.exe") && CommandLine.includes("delete") && CommandLine.includes("Raccine
    Tray")) || (CommandLine.includes("schtasks") && CommandLine.includes("/DELETE")
    && CommandLine.includes("Raccine Rules Updater"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a31eeaed-3fd5-478e-a8ba-e62c6b3f9ecc_sysmon_ot"'
  description: Raccine Uninstall
- id: eval
  filter: (EventID=="1" && Image.endsWith("\diskshadow.exe") && (CommandLine.includes("/s")
    || CommandLine.includes("-s")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0c2f8629-7129-4a8a-9897-7e0768f13ff2_sysmon_ot"'
  description: Execution via Diskshadow.exe
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\ditsnap.exe")) || (CommandLine.includes("ditsnap.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d3b70aad-097e-409c-9df2-450f80dc476b_sysmon_ot"'
  description: DIT Snapshot Viewer Use
- id: eval
  filter: (EventID=="1" && Image.endsWith("\dnx.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"81ebd28b-9607-4478-bf06-974ed9d53ed7_sysmon_ot"'
  description: Application Whitelisting Bypass via Dnx.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith(".doc.exe") || Image.endsWith(".docx.exe")
    || Image.endsWith(".xls.exe") || Image.endsWith(".xlsx.exe") || Image.endsWith(".ppt.exe")
    || Image.endsWith(".pptx.exe") || Image.endsWith(".rtf.exe") || Image.endsWith(".pdf.exe")
    || Image.endsWith(".txt.exe") || Image.endsWith("      .exe") || Image.endsWith("______.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1cdd9a09-06c9-4769-99ff-626e2b3991b8_sysmon_ot"'
  description: Suspicious Double Extension
- id: eval
  filter: (EventID=="1" && Image.endsWith("\dxcap.exe") && CommandLine.includes("-c")
    && CommandLine.includes(".exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"60f16a96-db70-42eb-8f76-16763e333590_sysmon_ot"'
  description: Application Whitelisting Bypass via Dxcap.exe
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\rundll32.exe")) && (CommandLine.endsWith(",RunDLL")
    || CommandLine.endsWith(",Control_RunDLL"))) &&  ! ((ParentImage.endsWith("\tracker.exe"))))
    &&  ! ((CommandLine.endsWith(".dll,Control_RunDLL") || CommandLine.endsWith(".dll",Control_RunDLL")
    || CommandLine.endsWith(".dll',Control_RunDLL"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"54e57ce3-0672-46eb-a402-2c0948d5e3e9_sysmon_ot"'
  description: Emotet RunDLL32 Process Creation
- id: eval
  filter: (EventID=="1" && (((Image.endsWith("\powershell.exe") && (CommandLine.includes("Clear-EventLog")
    || CommandLine.includes("Remove-EventLog") || CommandLine.includes("Limit-EventLog")))
    || (Image.endsWith("\wmic.exe") && CommandLine.includes(" ClearEventLog "))) ||
    (Image.endsWith("\wevtutil.exe") && (CommandLine.includes("clear-log") || CommandLine.includes("
    cl ") || CommandLine.includes("set-log") || CommandLine.includes(" sl ")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cc36992a-4671-4f21-a91d-6c2b72a2edf5_sysmon_ot"'
  description: Suspicious Eventlog Clear or Configuration Using Wevtutil
- id: eval
  filter: (EventID=="1" && ((Image.includes("\$Recycle.bin\\") || Image.includes("\config\systemprofile\\")
    || Image.includes("\Intel\Logs\\") || Image.includes("\RSA\MachineKeys\\") ||
    Image.includes("\Users\All Users\\") || Image.includes("\Users\Default\\") ||
    Image.includes("\Users\NetworkService\\") || Image.includes("\Users\Public\\")
    || Image.includes("\Windows\addins\\") || Image.includes("\Windows\debug\\") ||
    Image.includes("\Windows\Fonts\\") || Image.includes("\Windows\Help\\") || Image.includes("\Windows\IME\\")
    || Image.includes("\Windows\Media\\") || Image.includes("\Windows\repair\\") ||
    Image.includes("\Windows\security\\") || Image.includes("\Windows\System32\Tasks\\")
    || Image.includes("\Windows\Tasks\\")) || Image.startsWith("C:\Perflogs\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3dfd06d2-eaf4-4532-9555-68aca59f57c4_sysmon_ot"'
  description: Execution from Suspicious Folder
- id: eval
  filter: (EventID=="1" && (Image.includes("\wwwroot\\") || Image.includes("\wmpub\\")
    || Image.includes("\htdocs\\")) &&  ! ((Image.includes("bin\\") || Image.includes("\Tools\\")
    || Image.includes("\SMSComponent\\")) && (ParentImage.endsWith("\services.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"35efb964-e6a5-47ad-bbcd-19661854018d_sysmon_ot"'
  description: Execution in Webserver Root Folder
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\explorer.exe")) && (ParentImage.endsWith("\cmd.exe"))
    && (CommandLine.includes("explorer.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9eb271b9-24ae-4cd4-9465-19cfc1047f3e_sysmon_ot"'
  description: Proxy Execution Via Explorer.exe
- id: eval
  filter: (EventID=="1" && CommandLine.includes("explorer.exe") && CommandLine.includes("
    /root,"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"949f1ffb-6e85-4f00-ae1e-c3c5b190d605_sysmon_ot"'
  description: Explorer Root Flag Process Tree Break
- id: eval
  filter: (EventID=="1" && Description=="\?" && (FileVersion=="\?" || Product=="\?"
    || Company=="\?") && Image.includes("\Downloads\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9637e8a5-7131-4f7f-bdc7-2b05d8670c43_sysmon_ot"'
  description: Suspicious File Characteristics Due to Missing Fields
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\GfxDownloadWrapper.exe") &&  ! (CommandLine.includes("gameplayapi.intel.com")))
    &&  ! (ParentImage.endsWith("\GfxDownloadWrapper.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"eee00933-a761-4cd0-be70-c42fe91731e7_sysmon_ot"'
  description: GfxDownloadWrapper.exe Downloads File from Suspicious URL
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("findstr")) && ((CommandLine.includes("/V")
    && CommandLine.includes("/L")) || (CommandLine.includes("/S") && CommandLine.includes("/I"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bf6c39fc-e203-45b9-9538-05397c1b4f3f_sysmon_ot"'
  description: Abusing Findstr for Defense Evasion
- id: eval
  filter: (EventID=="1" && Image.endsWith("\findstr.exe") && CommandLine.endsWith(".lnk"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"33339be3-148b-4e16-af56-ad16ec6c7e7b_sysmon_ot"'
  description: Findstr Launching .lnk File
- id: eval
  filter: (EventID=="1" && Image.endsWith("\finger.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"af491bca-e752-4b44-9c86-df5680533dbc_sysmon_ot"'
  description: Finger.exe Suspicious Invocation
- id: eval
  filter: (EventID=="1" && CommandLine.includes("netsh") && CommandLine.includes("set")
    && ((CommandLine.includes("firewall") && CommandLine.includes("opmode") && CommandLine.includes("mode=disable"))
    || (CommandLine.includes("advfirewall") && CommandLine.includes("state") && CommandLine.includes("off"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"57c4bf16-227f-4394-8ec7-1b745ee061c3_sysmon_ot"'
  description: Firewall Disabled via Netsh
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\fsutil.exe") || OriginalFileName=="fsutil.exe")
    && (CommandLine.includes("deletejournal") || CommandLine.includes("createjournal")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"add64136-62e5-48ea-807e-88638d02df1e_sysmon_ot"'
  description: Fsutil Suspicious Invocation
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("-s:") && (Image.endsWith("ftp.exe")
    || OriginalFileName.includes("ftp.exe"))) || (OriginalFileName.includes("ftp.exe")
    &&  ! (Image.endsWith("ftp.exe"))) || ParentImage.endsWith("ftp.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"06b401f4-107c-4ff9-947f-9ec1e7649f1e_sysmon_ot"'
  description: Suspicious ftp.exe
- id: eval
  filter: (EventID=="1" && Image.endsWith("\GUP.exe") &&  ! ((Image.endsWith("\Users\\*\AppData\Local\Notepad++\updater\GUP.exe")
    || Image.endsWith("\Users\\*\AppData\Roaming\Notepad++\updater\GUP.exe") || Image.endsWith("\Program
    Files\Notepad++\updater\GUP.exe") || Image.endsWith("\Program Files (x86)\Notepad++\updater\GUP.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0a4f6091-223b-41f6-8743-f322ec84930b_sysmon_ot"'
  description: Suspicious GUP Usage
- id: eval
  filter: (EventID=="1" && Image.endsWith("\appcmd.exe") && CommandLine.includes("install")
    && CommandLine.includes("module") && CommandLine.includes("/name:"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9465ddf4-f9e4-4ebd-8d98-702df3a93239_sysmon_ot"'
  description: IIS Native-Code Module Command Line Installation
- id: eval
  filter: (EventID=="1" && Image.endsWith("\Windows\System32\lsass.exe") && ParentImage.endsWith("\Windows\System32\lsass.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c8da0dfd-4ed0-4b68-962d-13c9c884384e_sysmon_ot"'
  description: Suspicious LSASS Process Clone
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\net.exe") && Image.endsWith("\net1.exe")
    && CommandLine.includes("share") && CommandLine.includes("/delete"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cb7c4a03-2871-43c0-9bbb-18bbdb079896_sysmon_ot"'
  description: Mounted Share Deleted
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("MpCmdRun.exe") || Description=="Microsoft
    Malware Protection Command Line Utility") && (CommandLine.includes("DownloadFile")
    && CommandLine.includes("url")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"46123129-1024-423e-9fae-43af4a0fa9a5_sysmon_ot"'
  description: Windows Defender Download Activity
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\mpiexec.exe") || Imphash=="d8b52ef6aaa3a81501bdfff9dbb96217")
    && (CommandLine.includes(" /n 1 ") || CommandLine.includes(" -n 1 ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"729ce0ea-5d8f-4769-9762-e35de441586d_sysmon_ot"'
  description: MpiExec Lolbin
- id: eval
  filter: (EventID=="1" && Image.endsWith("\mshta.exe") && (CommandLine.includes("vbscript")
    || CommandLine.includes(".jpg") || CommandLine.includes(".png") || CommandLine.includes(".lnk")
    || CommandLine.includes(".xls") || CommandLine.includes(".doc") || CommandLine.includes(".zip")
    || CommandLine.includes(".dll") || CommandLine.includes(".exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cc7abbd0-762b-41e3-8a26-57ad50d2eea3_sysmon_ot"'
  description: MSHTA Suspicious Execution 01
- id: eval
  filter: (EventID=="1" && Image.endsWith("\mshta.exe") && ((((ParentImage.endsWith("\cmd.exe")
    || ParentImage.endsWith("\powershell.exe")) || (CommandLine.includes("\AppData\Local")
    || CommandLine.includes("C:\Windows\Temp") || CommandLine.includes("C:\Users\Public")))
    ||  ! ((Image.includes("C:\Windows\System32") || Image.includes("C:\Windows\SysWOW64"))))
    ||  ! ((CommandLine.includes(".htm") || CommandLine.includes(".hta")) && (CommandLine.endsWith("mshta.exe")
    || CommandLine.endsWith("mshta")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e32f92d1-523e-49c3-9374-bdb13b46a3ba_sysmon_ot"'
  description: Suspicious MSHTA Process Patterns
- id: eval
  filter: (EventID=="1" && Image.endsWith("\msiexec.exe") &&  ! ((Image.startsWith("C:\Windows\System32\\")
    || Image.startsWith("C:\Windows\SysWOW64\\") || Image.startsWith("C:\Windows\WinSxS\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144_sysmon_ot"'
  description: Suspicious MsiExec Directory
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" msiexec") && CommandLine.includes("://"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f7b5f842-a6af-4da5-9e95-e32478f3cd2f_sysmon_ot"'
  description: MsiExec Web Install
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\powerpnt.exe") || Image.endsWith("\winword.exe")
    || Image.endsWith("\excel.exe")) && CommandLine.includes("http"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0c79148b-118e-472b-bdb7-9b57b444cc19_sysmon_ot"'
  description: Malicious Payload Download via Office Binaries
- id: eval
  filter: (EventID=="1" && Image.endsWith("\netsh.exe") && CommandLine.includes("add")
    && CommandLine.includes("helper"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"56321594-9087-49d9-bf10-524fe8479452_sysmon_ot"'
  description: Suspicious Netsh DLL Persistence
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\net.exe") || Image.endsWith("\net1.exe"))
    && (CommandLine.includes(" group") || CommandLine.includes(" localgroup") || CommandLine.includes("
    user") || CommandLine.includes(" view") || CommandLine.includes(" share") || CommandLine.includes("
    accounts") || CommandLine.includes(" stop ") || CommandLine.includes(" start")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"183e7ea8-ac4b-4c23-9aec-b3dac4e401ac_sysmon_ot"'
  description: Net.exe Execution
- id: eval
  filter: (EventID=="1" && (Image=="C:\Windows\System32\net.exe" && CommandLine.includes("net")
    && CommandLine.includes(" use ") && CommandLine.includes(":*\\\") && CommandLine.includes("/USER:*
    ")) &&  ! ((CommandLine.endsWith(" "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d4498716-1d52-438f-8084-4a603157d131_sysmon_ot"'
  description: Password Provided In Command Line Of Net.exe
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes(" tcp 139") || CommandLine.includes("
    tcp 445") || CommandLine.includes(" tcp 3389") || CommandLine.includes(" tcp 5985")
    || CommandLine.includes(" tcp 5986")) || (CommandLine.includes(" start ") && CommandLine.includes("--all")
    && CommandLine.includes("--config") && CommandLine.includes(".yml")) || ((Image.endsWith("ngrok.exe"))
    && (CommandLine.includes(" tcp ") || CommandLine.includes(" http ") || CommandLine.includes("
    authtoken ")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ee37eb7c-a4e7-4cd5-8fa4-efa27f1c3f31_sysmon_ot"'
  description: Ngrok Usage
- id: eval
  filter: (EventID=="1" && Image.endsWith("\ntdsutil.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2afafd61-6aae-4df4-baed-139fa1f4c345_sysmon_ot"'
  description: Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("/logon:none") || CommandLine.includes("/system:none")
    || CommandLine.includes("/sam:none") || CommandLine.includes("/privilege:none")
    || CommandLine.includes("/object:none") || CommandLine.includes("/process:none")
    || CommandLine.includes("/policy:none")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c6c56ada-612b-42d1-9a29-adad3c5c2c1e_sysmon_ot"'
  description: Suspicious NT Resource Kit Auditpol Usage
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\odbcconf.exe") && (CommandLine.includes("-f")
    || CommandLine.includes("regsvr"))) || (ParentImage.endsWith("\odbcconf.exe")
    && Image.endsWith("\rundll32.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"65d2be45-8600-4042-b4c0-577a1ff8a60e_sysmon_ot"'
  description: Application Whitelisting Bypass via DLL Loaded by odbcconf.exe
- id: eval
  filter: (EventID=="1" && Image.endsWith("\OpenWith.exe") && CommandLine.includes("/c"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cec8e918-30f7-4e2d-9bfa-a59cc97ae60f_sysmon_ot"'
  description: OpenWith.exe Executes Specified Binary
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("EnableUnsafeClientMailRules") ||
    (ParentImage.endsWith("\outlook.exe") && CommandLine.includes("\\\\\") && CommandLine.includes("\\\")
    && CommandLine.includes(".exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e212d415-0e93-435f-9e1a-f29005bb4723_sysmon_ot"'
  description: Suspicious Execution from Outlook
- id: eval
  filter: (EventID=="1" && Image.includes("\Temporary Internet Files\Content.Outlook\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a018fdc3-46a3-44e5-9afb-2cd4af1d4b39_sysmon_ot"'
  description: Execution in Outlook Temp Folder
- id: eval
  filter: (EventID=="1" && Image.endsWith("\rundll32.exe") && CommandLine.includes("pcwutl")
    && CommandLine.includes("LaunchApplication"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9386d78a-7207-4048-9c9f-a93a7c2d1c05_sysmon_ot"'
  description: Code Execution via Pcwutl.dll
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\powershell.exe") && CommandLine.includes("Pester")
    && CommandLine.includes("Get-Help")) || (Image.endsWith("\cmd.exe") && CommandLine.includes("pester")
    && CommandLine.includes(";") && (CommandLine.includes("help") || CommandLine.includes("?")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"59e938ff-0d6d-4dc3-b13f-36cc28734d4e_sysmon_ot"'
  description: Execute Code with Pester.bat
- id: eval
  filter: (EventID=="1" && Image.endsWith("\ping.exe") && CommandLine.includes("0x"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1a0d4aba-7668-4365-9ce4-6d79ab088dfd_sysmon_ot"'
  description: Ping Hex IP
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" -NoP -sta -NonI -W Hidden -Enc
    ") || CommandLine.includes(" -noP -sta -w 1 -enc ") || CommandLine.includes("
    -NoP -NonI -W Hidden -enc ") || CommandLine.includes(" -noP -sta -w 1 -enc") ||
    CommandLine.includes(" -enc  SQB") || CommandLine.includes(" -nop -exec bypass
    -EncodedCommand ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"79f4ede3-402e-41c8-bc3e-ebbf5f162581_sysmon_ot"'
  description: Empire PowerShell Launch Parameters
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" -NoP -NonI -w Hidden -c $x=$((gp
    HKCU:Software\\Microsoft\\Windows Update).Update)") || CommandLine.includes("
    -NoP -NonI -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update);")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3268b746-88d8-4cd3-bffc-30077d02c787_sysmon_ot"'
  description: Empire PowerShell UAC Bypass
- id: eval
  filter: (EventID=="1" && CommandLine.includes("(WCHAR)0x"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e312efd0-35a1-407f-8439-b8d434b438a6_sysmon_ot"'
  description: PowerShell Encoded Character Syntax
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes(" -e") && CommandLine.includes("
    JAB") && CommandLine.includes(" -w") && CommandLine.includes(" hidden ")) || (CommandLine.includes("
    -e") && (CommandLine.includes(" BA^J") || CommandLine.includes(" SUVYI") || CommandLine.includes("
    SQBFAFgA") || CommandLine.includes(" aQBlAHgA") || CommandLine.includes(" aWV4I")
    || CommandLine.includes(" IAA") || CommandLine.includes(" IAB") || CommandLine.includes("
    UwB") || CommandLine.includes(" cwB"))) || (CommandLine.includes(".exe -ENCOD
    "))) &&  ! (CommandLine.includes(" -ExecutionPolicy") && CommandLine.includes("remotesigned
    ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ca2092a1-c273-4878-9b4b-0d60115bf5ea_sysmon_ot"'
  description: Suspicious Encoded PowerShell Command Line
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("Get-Process lsass")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b2815d0d-7481-4bf0-9b6c-a4c48a94b349_sysmon_ot"'
  description: PowerShell Get-Process LSASS
- id: eval
  filter: (EventID=="1" && Image.endsWith("\powershell.exe") && CommandLine.includes("
    hidden ") && (CommandLine.includes("AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA")
    || CommandLine.includes("aXRzYWRtaW4gL3RyYW5zZmVy") || CommandLine.includes("IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA")
    || CommandLine.includes("JpdHNhZG1pbiAvdHJhbnNmZX") || CommandLine.includes("YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg")
    || CommandLine.includes("Yml0c2FkbWluIC90cmFuc2Zlc") || CommandLine.includes("AGMAaAB1AG4AawBfAHMAaQB6AGUA")
    || CommandLine.includes("JABjAGgAdQBuAGsAXwBzAGkAegBlA") || CommandLine.includes("JGNodW5rX3Npem")
    || CommandLine.includes("QAYwBoAHUAbgBrAF8AcwBpAHoAZQ") || CommandLine.includes("RjaHVua19zaXpl")
    || CommandLine.includes("Y2h1bmtfc2l6Z") || CommandLine.includes("AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A")
    || CommandLine.includes("kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg") || CommandLine.includes("lPLkNvbXByZXNzaW9u")
    || CommandLine.includes("SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA") || CommandLine.includes("SU8uQ29tcHJlc3Npb2")
    || CommandLine.includes("Ty5Db21wcmVzc2lvb") || CommandLine.includes("AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ")
    || CommandLine.includes("kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA") || CommandLine.includes("lPLk1lbW9yeVN0cmVhb")
    || CommandLine.includes("SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A") || CommandLine.includes("SU8uTWVtb3J5U3RyZWFt")
    || CommandLine.includes("Ty5NZW1vcnlTdHJlYW") || CommandLine.includes("4ARwBlAHQAQwBoAHUAbgBrA")
    || CommandLine.includes("5HZXRDaHVua") || CommandLine.includes("AEcAZQB0AEMAaAB1AG4Aaw")
    || CommandLine.includes("LgBHAGUAdABDAGgAdQBuAGsA") || CommandLine.includes("LkdldENodW5r")
    || CommandLine.includes("R2V0Q2h1bm") || CommandLine.includes("AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A")
    || CommandLine.includes("QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA") || CommandLine.includes("RIUkVBRF9JTkZPNj")
    || CommandLine.includes("SFJFQURfSU5GTzY0") || CommandLine.includes("VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA")
    || CommandLine.includes("VEhSRUFEX0lORk82N") || CommandLine.includes("AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA")
    || CommandLine.includes("cmVhdGVSZW1vdGVUaHJlYW") || CommandLine.includes("MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA")
    || CommandLine.includes("NyZWF0ZVJlbW90ZVRocmVhZ") || CommandLine.includes("Q3JlYXRlUmVtb3RlVGhyZWFk")
    || CommandLine.includes("QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA") ||
    CommandLine.includes("0AZQBtAG0AbwB2AGUA") || CommandLine.includes("1lbW1vdm")
    || CommandLine.includes("AGUAbQBtAG8AdgBlA") || CommandLine.includes("bQBlAG0AbQBvAHYAZQ")
    || CommandLine.includes("bWVtbW92Z") || CommandLine.includes("ZW1tb3Zl")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f26c6093-6f14-4b12-800f-0fcb46f5ffd0_sysmon_ot"'
  description: Malicious Base64 Encoded PowerShell Keywords in Command Lines
- id: eval
  filter: (EventID=="1" && ((ParentImage.endsWith("\wscript.exe") || ParentImage.endsWith("\cscript.exe"))
    && Image.endsWith("\powershell.exe")) &&  ! (CurrentDirectory.includes("\Health
    Service State\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"95eadcb2-92e4-4ed1-9031-92547773a6db_sysmon_ot"'
  description: Suspicious PowerShell Invocation Based on Parent Process
- id: eval
  filter: (EventID=="1" && ((ParentImage.endsWith("\mshta.exe") || ParentImage.endsWith("\rundll32.exe")
    || ParentImage.endsWith("\regsvr32.exe") || ParentImage.endsWith("\services.exe")
    || ParentImage.endsWith("\winword.exe") || ParentImage.endsWith("\wmiprvse.exe")
    || ParentImage.endsWith("\powerpnt.exe") || ParentImage.endsWith("\excel.exe")
    || ParentImage.endsWith("\msaccess.exe") || ParentImage.endsWith("\mspub.exe")
    || ParentImage.endsWith("\visio.exe") || ParentImage.endsWith("\outlook.exe")
    || ParentImage.endsWith("\amigo.exe") || ParentImage.endsWith("\chrome.exe") ||
    ParentImage.endsWith("\firefox.exe") || ParentImage.endsWith("\iexplore.exe")
    || ParentImage.endsWith("\microsoftedgecp.exe") || ParentImage.endsWith("\microsoftedge.exe")
    || ParentImage.endsWith("\browser.exe") || ParentImage.endsWith("\vivaldi.exe")
    || ParentImage.endsWith("\safari.exe") || ParentImage.endsWith("\sqlagent.exe")
    || ParentImage.endsWith("\sqlserver.exe") || ParentImage.endsWith("\sqlservr.exe")
    || ParentImage.endsWith("\w3wp.exe") || ParentImage.endsWith("\httpd.exe") ||
    ParentImage.endsWith("\nginx.exe") || ParentImage.endsWith("\php-cgi.exe") ||
    ParentImage.endsWith("\jbosssvc.exe") || ParentImage.endsWith("MicrosoftEdgeSH.exe"))
    || ParentImage.includes("tomcat")) && ((CommandLine.includes("powershell") ||
    CommandLine.includes("pwsh")) || Description=="Windows PowerShell" || Product=="PowerShell
    Core 6"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"754ed792-634f-40ae-b3bc-e0448d33f695_sysmon_ot"'
  description: Suspicious PowerShell Parent Process
- id: eval
  filter: (EventID=="1" && CommandLine.includes("\HarddiskVolumeShadowCopy") && CommandLine.includes("ystem32\config\sam")
    && (CommandLine.includes("Copy-Item") || CommandLine.includes("cp $_.") || CommandLine.includes("cpi
    $_.") || CommandLine.includes("copy $_.") || CommandLine.includes(".File]::Copy(")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1af57a4b-460a-4738-9034-db68b880c665_sysmon_ot"'
  description: PowerShell SAM Copy
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("Microsoft.NodejsTools.PressAnyKey.exe
    normal ") || (CommandLine.includes(".exe normal ") && CommandLine.endsWith(".exe")))
    &&  ! ((Image.includes("\Microsoft\NodeJsTools\NodeJsTools"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a20391f8-76fb-437b-abc0-dba2df1952c6_sysmon_ot"'
  description: NodejsTools PressAnyKey Lolbin
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\print.exe")) && (CommandLine.startsWith("print"))
    && (CommandLine.includes("/D")) && (CommandLine.includes(".exe"))) &&  ! ((CommandLine.includes("print.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bafac3d6-7de9-4dd9-8874-4a1194b493ed_sysmon_ot"'
  description: Abusing Print Executable
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" -ma ") && CommandLine.includes("
    -accepteula "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"03795938-1387-481b-9f4c-3f6241e604fe_sysmon_ot"'
  description: Suspicious Use of Procdump
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" -ma ") && (CommandLine.includes("
    lsass") || CommandLine.includes(" ls")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5afee48e-67dd-4e03-a783-f74259dcf998_sysmon_ot"'
  description: Suspicious Use of Procdump on LSASS
- id: eval
  filter: (EventID=="1" && Image.endsWith("\psexec.exe") && CommandLine.includes("accepteula"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"730fc21b-eaff-474b-ad23-90fd265d4988_sysmon_ot"'
  description: Psexec Accepteula Condition
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("PsExec") || CommandLine.includes("PAExec")
    || CommandLine.includes("accepteula") || CommandLine.includes("cmd /c ")) && CommandLine.endsWith("
    -s cmd.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8834e2f7-6b4b-4f09-8906-d2276470ee23_sysmon_ot"'
  description: PsExec/PAExec Escalation to LOCAL SYSTEM
- id: eval
  filter: (EventID=="1" && ((CommandLine.endsWith(" -s cmd.exe") || CommandLine.endsWith("
    -s -i cmd.exe")) || (CommandLine.includes("accepteula") && CommandLine.includes("
    -u ") && CommandLine.includes(" -p ") && CommandLine.includes(" \\\"))) &&  !
    ((CommandLine.includes("paexec") || CommandLine.includes("PsExec"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"207b0396-3689-42d9-8399-4222658efc99_sysmon_ot"'
  description: PsExec/PAExec Flags
- id: eval
  filter: (EventID=="1" && ((OriginalFileName.includes("psloglist") || (Image.endsWith("\psloglist.exe")
    || Image.endsWith("\psloglist64.exe"))) || ((CommandLine.includes("-d") || CommandLine.includes("/d")
    || CommandLine.includes("-x") || CommandLine.includes("/x") || CommandLine.includes("-s")
    || CommandLine.includes("/s")) && CommandLine.includes("security") && CommandLine.includes("accepteula"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"aae1243f-d8af-40d8-ab20-33fc6d0c55bc_sysmon_ot"'
  description: Suspicious Use of PsLogList
- id: eval
  filter: (EventID=="1" && Image.endsWith("\Psr.exe") && CommandLine.includes("/start"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2158f96f-43c2-43cb-952a-ab4580f32382_sysmon_ot"'
  description: Psr.exe Capture Screenshots
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("powershell.exe") || CommandLine.includes("\powershell"))
    && CommandLine.includes("/c ") && CommandLine.includes("\AppData\\") && (CommandLine.includes("Local\\")
    || CommandLine.includes("Roaming\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ac175779-025a-4f12-98b0-acdaeb77ea85_sysmon_ot"'
  description: PowerShell Script Run in AppData
- id: eval
  filter: (EventID=="1" && CommandLine.includes("powershell") && CommandLine.includes(".DownloadFile")
    && CommandLine.includes("System.Net.WebClient"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8f70ac5f-1f6f-4f8e-b454-db19561216c5_sysmon_ot"'
  description: PowerShell DownloadFile
- id: eval
  filter: (EventID=="1" && (CommandLine.includes(" -hp")) && (CommandLine.includes("
    -m") || CommandLine.includes(" a ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"faa48cae-6b25-4f00-a094-08947fef582f_sysmon_ot"'
  description: Rar with Password or Compression Level
- id: eval
  filter: (EventID=="1" && (Image.endsWith("rasdial.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6bba49bf-7f8c-47d6-a1bb-6b4dece4640e_sysmon_ot"'
  description: Suspicious RASdial Activity
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\RazerInstaller.exe") && IntegrityLevel=="System")
    &&  ! (Image.startsWith("C:\Windows\Installer\Razer\Installer\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a4eaf250-7dc1-4842-862a-5e71cd59a167_sysmon_ot"'
  description: Suspicious RazerInstaller Explorer Subprocess
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("--config ") && CommandLine.includes("--no-check-certificate
    ") && CommandLine.includes(" copy ")) || ((CommandLine.includes("pass") || CommandLine.includes("user")
    || CommandLine.includes("copy") || CommandLine.includes("sync") || CommandLine.includes("config")
    || CommandLine.includes("lsd") || CommandLine.includes("remote") || CommandLine.includes("ls")
    || CommandLine.includes("mega") || CommandLine.includes("pcloud") || CommandLine.includes("ftp")
    || CommandLine.includes("ignore-existing") || CommandLine.includes("auto-confirm")
    || CommandLine.includes("transfers") || CommandLine.includes("multi-thread-streams")
    || CommandLine.includes("no-check-certificate ")) && (Description=="Rsync for
    cloud storage" || (Image.endsWith("\rclone.exe") && (ParentImage.endsWith("\PowerShell.exe")
    || ParentImage.endsWith("\cmd.exe")))))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e37db05d-d1f9-49c8-b464-cee1a4b11638_sysmon_ot"'
  description: Rclone Execution via Command Line or PowerShell
- id: eval
  filter: (EventID=="1" && (CommandLine=="net group "domain admins" /dom" || CommandLine=="net
    localgroup administrators" || CommandLine=="net group "enterprise admins" /dom"
    || CommandLine=="net accounts /dom"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d95de845-b83c-4a9a-8a6a-4fc802ebf6c0_sysmon_ot"'
  description: Suspicious Reconnaissance Activity
- id: eval
  filter: (EventID=="1" && Image.endsWith("\regedit.exe") && (ParentImage.endsWith("\TrustedInstaller.exe")
    || ParentImage.endsWith("\ProcessHacker.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"883835a7-df45-43e4-bf1d-4268768afda4_sysmon_ot"'
  description: Regedit as Trusted Installer
- id: eval
  filter: (EventID=="1" && Image.endsWith("\register-cimprovider.exe") && CommandLine.includes("-path")
    && CommandLine.includes("dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a2910908-e86f-4687-aeba-76a5f996e652_sysmon_ot"'
  description: DLL Execution Via Register-cimprovider.exe
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cscript.exe") && CommandLine.includes("-register")
    && (CommandLine.includes("\Windows Kits\10\bin\10.0.22000.0\x64") || CommandLine.includes("\Windows
    Kits\10\bin\10.0.19041.0\x64") || CommandLine.includes("\Windows Kits\10\bin\10.0.17763.0\x64")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"28c8f68b-098d-45af-8d43-8089f3e35403_sysmon_ot"'
  description: Suspicious Registration via cscript.exe
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\regsvr32.exe") && CommandLine.includes("\Temp\\"))
    || (Image.endsWith("\regsvr32.exe") && ParentImage.endsWith("\powershell.exe"))
    || (Image.endsWith("\regsvr32.exe") && ParentImage.endsWith("\cmd.exe")) || (Image.endsWith("\regsvr32.exe")
    && CommandLine.includes("/i:") && (CommandLine.includes("http") || CommandLine.includes("ftp"))
    && CommandLine.endsWith("scrobj.dll")) || (Image.endsWith("\wscript.exe") && ParentImage.endsWith("\regsvr32.exe"))
    || (Image.endsWith("\EXCEL.EXE") && CommandLine.includes("..\..\..\Windows\System32\regsvr32.exe
    ")) || (ParentImage.endsWith("\mshta.exe") && Image.endsWith("\regsvr32.exe"))
    || (Image.endsWith("\regsvr32.exe") && (CommandLine.includes("\AppData\Local")
    || CommandLine.includes("C:\Users\Public")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8e2b24c9-4add-46a0-b4bb-0057b4e6187d_sysmon_ot"'
  description: Regsvr32 Anomaly
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\regsvr32.exe") && CommandLine.includes("
    /i:")) &&  ! (CommandLine.includes(" /n ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b236190c-1c61-41e9-84b3-3fe03f6d76b0_sysmon_ot"'
  description: Regsvr32 Flags Anomaly
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" /s") && CommandLine.includes(" /u")
    && (CommandLine.includes(" /i:http://1") || CommandLine.includes(" /i:http://2")
    || CommandLine.includes(" /i:http://3") || CommandLine.includes(" /i:http://4")
    || CommandLine.includes(" /i:http://5") || CommandLine.includes(" /i:http://6")
    || CommandLine.includes(" /i:http://7") || CommandLine.includes(" /i:http://8")
    || CommandLine.includes(" /i:http://9")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2dd2c217-bf68-437a-b57c-fe9fd01d5de8_sysmon_ot"'
  description: Suspicious Regsvr32 HTTP IP Pattern
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\regsvr32.exe") &&  ! ((CommandLine.includes(".dll")
    || CommandLine.includes(".ocx") || CommandLine.includes(".cpl") || CommandLine.includes(".ax")
    || CommandLine.includes(".bav") || CommandLine.includes(".ppl")))) &&  ! (CommandLine
    ===null )) &&  ! (CommandLine==""))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"50919691-7302-437f-8e10-1fe088afa145_sysmon_ot"'
  description: Regsvr32 Command Line Without DLL
- id: eval
  filter: (EventID=="1" && CommandLine.includes("reg") && CommandLine.includes("add")
    && CommandLine.includes(" /d 4") && CommandLine.includes(" /v Start") && (CommandLine.includes("\Sense
    ") || CommandLine.includes("\WinDefend") || CommandLine.includes("\MsMpSvc") ||
    CommandLine.includes("\NisSrv") || CommandLine.includes("\WdBoot ") || CommandLine.includes("\WdNisDrv")
    || CommandLine.includes("\WdNisSvc") || CommandLine.includes("\wscsvc ") || CommandLine.includes("\SecurityHealthService")
    || CommandLine.includes("\wuauserv") || CommandLine.includes("\UsoSvc ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5e95028c-5229-4214-afae-d653d573d0ec_sysmon_ot"'
  description: Reg Disable Security Service
- id: eval
  filter: (EventID=="1" && Hashes.includes("6834B1B94E49701D77CCB3C0895E1AFD") &&  !
    (Image.endsWith("\dctask64.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"340a090b-c4e9-412e-bb36-b4b16fe96f9b_sysmon_ot"'
  description: Renamed ZOHO Dctask64
- id: eval
  filter: (EventID=="1" && (Product=="Sysinternals DebugView" || Product=="Sysinternals
    Debugview") &&  ! (OriginalFileName=="Dbgview.exe" && Image.endsWith("\Dbgview.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cd764533-2e07-40d6-a718-cfeec7f2da7f_sysmon_ot"'
  description: Renamed SysInternals Debug View
- id: eval
  filter: (EventID=="1" && (Description=="PAExec Application" || OriginalFileName=="PAExec.exe")
    &&  ! ((Image.endsWith("\PAexec.exe") || Image.endsWith("\paexec.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c4e49831-1496-40cf-8ce1-b53f942b02f9_sysmon_ot"'
  description: Renamed PAExec
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\rpcping.exe") && (CommandLine.includes("-s")
    || CommandLine.includes("/s"))) && ((CommandLine.includes("-u") && CommandLine.includes("NTLM"))
    || (CommandLine.includes("/u") && CommandLine.includes("NTLM")) || (CommandLine.includes("-t")
    && CommandLine.includes("ncacn_np")) || (CommandLine.includes("/t") && CommandLine.includes("ncacn_np"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"93671f99-04eb-4ab4-a161-70d446a84003_sysmon_ot"'
  description: Capture Credentials with Rpcping.exe
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("javascript:") && CommandLine.includes(".RegisterXLL"))
    || (CommandLine.includes("url.dll") && CommandLine.includes("OpenURL")) || (CommandLine.includes("url.dll")
    && CommandLine.includes("OpenURLA")) || (CommandLine.includes("url.dll") && CommandLine.includes("FileProtocolHandler"))
    || (CommandLine.includes("zipfldr.dll") && CommandLine.includes("RouteTheCall"))
    || (CommandLine.includes("shell32.dll") && CommandLine.includes("Control_RunDLL"))
    || (CommandLine.includes("shell32.dll") && CommandLine.includes("ShellExec_RunDLL"))
    || (CommandLine.includes("mshtml.dll") && CommandLine.includes("PrintHTML")) ||
    (CommandLine.includes("advpack.dll") && CommandLine.includes("LaunchINFSection"))
    || (CommandLine.includes("advpack.dll") && CommandLine.includes("RegisterOCX"))
    || (CommandLine.includes("ieadvpack.dll") && CommandLine.includes("LaunchINFSection"))
    || (CommandLine.includes("ieadvpack.dll") && CommandLine.includes("RegisterOCX"))
    || (CommandLine.includes("ieframe.dll") && CommandLine.includes("OpenURL")) ||
    (CommandLine.includes("shdocvw.dll") && CommandLine.includes("OpenURL")) || (CommandLine.includes("syssetup.dll")
    && CommandLine.includes("SetupInfObjectInstallAction")) || (CommandLine.includes("setupapi.dll")
    && CommandLine.includes("InstallHinfSection")) || (CommandLine.includes("pcwutl.dll")
    && CommandLine.includes("LaunchApplication")) || (CommandLine.includes("dfshim.dll")
    && CommandLine.includes("ShOpenVerbApplication"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e593cf51-88db-4ee1-b920-37e89012a3c9_sysmon_ot"'
  description: Suspicious Rundll32 Activity
- id: eval
  filter: '(EventID=="1" && (Image.endsWith("\rundll32.exe") && (CommandLine.includes(",#")
    || CommandLine.includes(", #") || CommandLine.includes(".dll #"))) &&  ! (CommandLine.includes("EDGEHTML.dll")
    && CommandLine.includes("#141")))'
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e79a9e79-eb72-4e78-a628-0e7e8f59e89c_sysmon_ot"'
  description: Suspicious Call by Ordinal
- id: eval
  filter: (EventID=="1" && CommandLine.includes("rundll32.exe") && CommandLine.includes("Execute")
    && CommandLine.includes("RegRead") && CommandLine.includes("window.close"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1cc50f3f-1fc8-4acf-b2e9-6f172e1fdebd_sysmon_ot"'
  description: Suspicious Rundll32 Invoking Inline VBScript
- id: eval
  filter: (EventID=="1" && (CommandLine.endsWith("\rundll32.exe") &&  ! (ParentImage.endsWith("\svchost.exe")))
    &&  ! ((ParentImage.includes("\AppData\Local\\") || ParentImage.includes("\Microsoft\Edge\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1775e15e-b61b-4d14-a1a3-80981298085a_sysmon_ot"'
  description: Suspicious Rundll32 Without Any CommandLine Params
- id: eval
  filter: (EventID=="1" && Image.endsWith("\runonce.exe") && ParentImage.endsWith("\rundll32.exe")
    && ParentCommandLine.includes("setupapi.dll") && ParentCommandLine.includes("InstallHinfSection"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"285b85b1-a555-4095-8652-a8a4106af63f_sysmon_ot"'
  description: Suspicious Rundll32 Setupapi.dll Activity
- id: eval
  filter: (EventID=="1" && CommandLine.includes("rundll32.exe") && (CommandLine.includes(".sys,")
    || CommandLine.includes(".sys ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"731231b9-0b5d-4219-94dd-abb6959aa7ea_sysmon_ot"'
  description: Suspicious Rundll32 Activity Invoking Sys File
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\runonce.exe")) || (Description=="Run
    Once Wrapper")) && (CommandLine.includes(" /AlternateShellStartup")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"198effb6-6c98-4d0c-9ea3-451fa143c45c_sysmon_ot"'
  description: Run Once Task Execution as Configured in Registry
- id: eval
  filter: (EventID=="1" && Image.endsWith("\Runscripthelper.exe") && CommandLine.includes("surfacecheck"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"eca49c87-8a75-4f13-9c73-a5a29e845f03_sysmon_ot"'
  description: Suspicious Runscripthelper.exe
- id: eval
  filter: (EventID=="1" && ((Image.includes(":\RECYCLER\\") || Image.includes(":\SystemVolumeInformation\\"))
    || (Image.startsWith("C:\Windows\Tasks\\") || Image.startsWith("C:\Windows\debug\\")
    || Image.startsWith("C:\Windows\fonts\\") || Image.startsWith("C:\Windows\help\\")
    || Image.startsWith("C:\Windows\drivers\\") || Image.startsWith("C:\Windows\addins\\")
    || Image.startsWith("C:\Windows\cursors\\") || Image.startsWith("C:\Windows\system32\tasks\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"15b75071-74cc-47e0-b4c6-b43744a62a2b_sysmon_ot"'
  description: Suspicious Process Start Locations
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\schtasks.exe") && CommandLine.includes("
    /create ")) &&  ! ((User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"92626ddd-662c-49e3-ac59-f6535f12d189_sysmon_ot"'
  description: Scheduled Task Creation
- id: eval
  filter: (EventID=="1" && Image.endsWith("\schtasks.exe") && CommandLine.includes("
    /create ") && CommandLine.includes(" /sc once ") && CommandLine.includes("\Temp\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"39019a4e-317f-4ce3-ae63-309a8c6b53c5_sysmon_ot"'
  description: Suspicious Scheduled Task Creation Involving Temp Folder
- id: eval
  filter: (EventID=="1" && CommandLine.includes("e=Access&") && CommandLine.includes("y=Guest&")
    && CommandLine.includes("&p=") && CommandLine.includes("&c=") && CommandLine.includes("&k="))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"75bfe6e6-cd8e-429e-91d3-03921e1d7962_sysmon_ot"'
  description: ScreenConnect Remote Access
- id: eval
  filter: (EventID=="1" && Image.endsWith("reg.exe") && (CommandLine.includes("HKEY_CURRENT_USER\Control
    Panel\Desktop") || CommandLine.includes("HKCU\Control Panel\Desktop")) && CommandLine.includes("/t
    REG_SZ") && CommandLine.includes("/f") && ((CommandLine.includes("/v ScreenSaveActive")
    && CommandLine.includes("/d 1")) || (CommandLine.includes("/v ScreenSaveTimeout")
    && CommandLine.includes("/d ")) || (CommandLine.includes("/v ScreenSaverIsSecure")
    && CommandLine.includes("/d 0")) || (CommandLine.includes("/v SCRNSAVE.EXE") &&
    CommandLine.includes("/d ") && CommandLine.includes(".scr"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0fc35fc3-efe6-4898-8a37-0b233339524f_sysmon_ot"'
  description: Suspicious ScreenSave Change by Reg.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe"))
    && (CommandLine.includes(".jse") || CommandLine.includes(".vbe") || CommandLine.includes(".js")
    || CommandLine.includes(".vba")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1e33157c-53b1-41ad-bbcc-780b80b58288_sysmon_ot"'
  description: WSF/JSE/JS/VBA/VBE File Execution
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\powershell.exe") || Image.endsWith("\mshta.exe")
    || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")) && (CommandLine.includes("\Windows\Temp")
    || CommandLine.includes("\Temporary Internet") || CommandLine.includes("\AppData\Local\Temp")
    || CommandLine.includes("\AppData\Roaming\Temp") || CommandLine.includes("%TEMP%")
    || CommandLine.includes("%TMP%") || CommandLine.includes("%LocalAppData%\Temp")))
    &&  ! ((CommandLine.includes(" >") || CommandLine.includes("Out-File") || CommandLine.includes("ConvertTo-Json")
    || CommandLine.includes("-WindowStyle hidden -Verb runAs"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a6a39bdb-935c-4f0a-ab77-35f4bbf44d33_sysmon_ot"'
  description: Suspicious Script Execution From Temp Folder
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\sc.exe")) && CommandLine.includes("sdset")
    && CommandLine.includes("D;;") && (CommandLine.includes(";;;IU") || CommandLine.includes(";;;SU")
    || CommandLine.includes(";;;BA") || CommandLine.includes(";;;SY") || CommandLine.includes(";;;WD")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"99cf1e02-00fb-4c0d-8375-563f978dfd37_sysmon_ot"'
  description: Suspicious Service DACL Modification
- id: eval
  filter: (EventID=="1" && (Image.includes("\Users\Public\\") || Image.includes("\$Recycle.bin")
    || Image.includes("\Users\All Users\\") || Image.includes("\Users\Default\\")
    || Image.includes("\Users\Contacts\\") || Image.includes("\Users\Searches\\")
    || Image.includes("C:\Perflogs\\") || Image.includes("\config\systemprofile\\")
    || Image.includes("\Windows\Fonts\\") || Image.includes("\Windows\IME\\") || Image.includes("\Windows\addins\\"))
    && (ParentImage.endsWith("\services.exe") || ParentImage.endsWith("\svchost.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"883faa95-175a-4e22-8181-e5761aeb373c_sysmon_ot"'
  description: Suspicious Service Binary Directory
- id: eval
  filter: (EventID=="1" && Image.endsWith("\sc.exe") && CommandLine.includes("config")
    && CommandLine.includes("binpath") && (CommandLine.includes("powershell") || CommandLine.includes("cmd")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"138d3531-8793-4f50-a2cd-f291b2863d78_sysmon_ot"'
  description: Suspicious Service Path Modification
- id: eval
  filter: (EventID=="1" && ((CommandLine.includes("whoami") && (CommandLine.includes("./Client/Common/")
    || CommandLine.includes(".\Client\Common\\"))) || CommandLine.includes("C:\Windows\Temp\Serv-U.bat")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"75578840-9526-4b2a-9462-af469a45e767_sysmon_ot"'
  description: Serv-U Exploitation CVE-2021-35211 by DEV-0322
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\Serv-U.exe") && (Image.endsWith("\cmd.exe")
    || Image.endsWith("\powershell.exe") || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe") || Image.endsWith("\schtasks.exe")
    || Image.endsWith("\regsvr32.exe") || Image.endsWith("\wmic.exe") || Image.endsWith("\mshta.exe")
    || Image.endsWith("\rundll32.exe") || Image.endsWith("\msiexec.exe") || Image.endsWith("\forfiles.exe")
    || Image.endsWith("\scriptrunner.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"58f4ea09-0fc2-4520-ba18-b85c540b0eaf_sysmon_ot"'
  description: Suspicious Serv-U Process Pattern
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\sqlservr.exe") && (Image.endsWith("\cmd.exe")
    || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe") || Image.endsWith("\powershell.exe")
    || Image.endsWith("\bitsadmin.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"869b9ca7-9ea2-4a5a-8325-e80e62f75445_sysmon_ot"'
  description: Suspicious Shells Spawn by SQL Server
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\wsmprovhost.exe") && (Image.endsWith("\cmd.exe")
    || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe") || Image.endsWith("\powershell.exe")
    || Image.endsWith("\schtasks.exe") || Image.endsWith("\certutil.exe") || Image.endsWith("\whoami.exe")
    || Image.endsWith("\bitsadmin.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5cc2cda8-f261-4d88-a2de-e9e193c86716_sysmon_ot"'
  description: Suspicious Shells Spawn by WinRM
- id: eval
  filter: (EventID=="1" && CommandLine.includes("rundll32") && ((CommandLine.includes("apphelp.dll")
    && (CommandLine.includes("ShimFlushCache") || CommandLine.includes("#250"))) ||
    (CommandLine.includes("kernel32.dll") && (CommandLine.includes("BaseFlushAppcompatCache")
    || CommandLine.includes("#46")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b0524451-19af-4efa-a46f-562a977f792e_sysmon_ot"'
  description: ShimCache Flush
- id: eval
  filter: (EventID=="1" && Image.endsWith("\splwow64.exe") && CommandLine.endsWith("splwow64.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1f1a8509-2cbb-44f5-8751-8e1571518ce2_sysmon_ot"'
  description: Suspicious Splwow64 Without Params
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\\spoolsv.exe") && IntegrityLevel=="System")
    && ((((((Image.endsWith("\gpupdate.exe") || Image.endsWith("\whoami.exe") || Image.endsWith("\nltest.exe")
    || Image.endsWith("\taskkill.exe") || Image.endsWith("\wmic.exe") || Image.endsWith("\taskmgr.exe")
    || Image.endsWith("\sc.exe") || Image.endsWith("\findstr.exe") || Image.endsWith("\curl.exe")
    || Image.endsWith("\wget.exe") || Image.endsWith("\certutil.exe") || Image.endsWith("\bitsadmin.exe")
    || Image.endsWith("\accesschk.exe") || Image.endsWith("\wevtutil.exe") || Image.endsWith("\bcdedit.exe")
    || Image.endsWith("\fsutil.exe") || Image.endsWith("\cipher.exe") || Image.endsWith("\schtasks.exe")
    || Image.endsWith("\write.exe") || Image.endsWith("\wuauclt.exe")) || (Image.endsWith("\net.exe")
    &&  ! (CommandLine.includes("start")))) || (Image.endsWith("\cmd.exe") &&  ! ((CommandLine.includes(".spl")
    || CommandLine.includes("route add") || CommandLine.includes("program files")))))
    || (Image.endsWith("\netsh.exe") &&  ! ((CommandLine.includes("add portopening")
    || CommandLine.includes("rule name"))))) || (Image.endsWith("\powershell.exe")
    &&  ! (CommandLine.includes(".spl")))) || (Image.endsWith("\rundll32.exe") &&
    CommandLine.endsWith("rundll32.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dcdbc940-0bff-46b2-95f3-2d73f848e33b_sysmon_ot"'
  description: Suspicious Spool Service Child Process
- id: eval
  filter: (EventID=="1" && Image.endsWith("\sqldumper.exe") && (CommandLine.includes("0x0110")
    || CommandLine.includes("0x01100:40")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"23ceaf5c-b6f1-4a32-8559-f2ff734be516_sysmon_ot"'
  description: Dumping Process via Sqldumper.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\update.exe") && (CommandLine.includes("--processStart")
    || CommandLine.includes("--processStartAndWait") || CommandLine.includes("--createShortcut"))
    && CommandLine.includes(".exe")) &&  ! ((CommandLine.includes("C:\Users\\") &&
    CommandLine.includes("\AppData\Local\Discord\Update.exe") && CommandLine.includes("
    --processStart Discord.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fa4b21c9-0057-4493-b289-2556416ae4d7_sysmon_ot"'
  description: Squirrel Lolbin
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\svchost.exe") &&  ! ((ParentImage.endsWith("\services.exe")
    || ParentImage.endsWith("\MsMpEng.exe") || ParentImage.endsWith("\Mrt.exe") ||
    ParentImage.endsWith("\rpcnet.exe") || ParentImage.endsWith("\svchost.exe") ||
    ParentImage.endsWith("\ngen.exe") || ParentImage.endsWith("\TiWorker.exe"))))
    &&  ! (ParentImage ===null ))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"01d2e2a1-5f09-44f7-9fc1-24faa7479b6d_sysmon_ot"'
  description: Suspicious Svchost Process
- id: eval
  filter: (EventID=="1" && (CommandLine.endsWith("svchost.exe") && Image.endsWith("\svchost.exe"))
    &&  ! ((ParentImage.endsWith("\rpcnet.exe") || ParentImage.endsWith("\rpcnetp.exe"))
    || CommandLine ===null ))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"16c37b52-b141-42a5-a3ea-bbe098444397_sysmon_ot"'
  description: Suspect Svchost Activity
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\sysprep.exe")) && (CommandLine.includes("\AppData\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e_sysmon_ot"'
  description: Sysprep on AppData Folder
- id: eval
  filter: (EventID=="1" && (IntegrityLevel=="System" && User.includes("AUT") && User.includes("SYSTEM"))
    && ((Image.endsWith("\calc.exe") || Image.endsWith("\wscript.exe") || Image.endsWith("\cscript.exe")
    || Image.endsWith("\hh.exe") || Image.endsWith("\mshta.exe") || Image.endsWith("\forfiles.exe")
    || Image.endsWith("\ping.exe")) || (CommandLine.includes("sc stop ") || CommandLine.includes("
    -NoP ") || CommandLine.includes(" -W Hidden ") || CommandLine.includes(" -decode
    ") || CommandLine.includes(" /decode ") || CommandLine.includes(" /urlcache ")
    || CommandLine.includes(" -urlcache ") || CommandLine.includes(" -e* JAB") ||
    CommandLine.includes(" -e* SUVYI") || CommandLine.includes(" -e* SQBFAFgA") ||
    CommandLine.includes(" -e* aWV4I") || CommandLine.includes(" -e* IAB") || CommandLine.includes("
    -e* PAA") || CommandLine.includes(" -e* aQBlAHgA") || CommandLine.includes("vssadmin
    delete shadows") || CommandLine.includes("reg SAVE HKLM") || CommandLine.includes("
    -ma ") || CommandLine.includes("Microsoft\Windows\CurrentVersion\Run") || CommandLine.includes(".downloadstring(")
    || CommandLine.includes(".downloadfile(") || CommandLine.includes(" /ticket:")
    || CommandLine.includes("dpapi::") || CommandLine.includes("event::clear") ||
    CommandLine.includes("event::drop") || CommandLine.includes("id::modify") || CommandLine.includes("kerberos::")
    || CommandLine.includes("lsadump::") || CommandLine.includes("misc::") || CommandLine.includes("privilege::")
    || CommandLine.includes("rpc::") || CommandLine.includes("sekurlsa::") || CommandLine.includes("sid::")
    || CommandLine.includes("token::") || CommandLine.includes("vault::cred") || CommandLine.includes("vault::list")
    || CommandLine.includes(" p::d ") || CommandLine.includes(";iex(") || CommandLine.includes("MiniDump")
    || CommandLine.includes("net user "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2617e7ed-adb7-40ba-b0f3-8f9945fe6c09_sysmon_ot"'
  description: Suspicious SYSTEM User Process Creation
- id: eval
  filter: (EventID=="1" && CommandLine.includes("\SYSVOL\\") && CommandLine.includes("\policies\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"05f3c945-dcc8-4393-9f3d-af65077a8f86_sysmon_ot"'
  description: Suspicious SYSVOL Domain Group Policy Access
- id: eval
  filter: (EventID=="1" && Image.endsWith("\rundll32.exe") && CommandLine.includes("shell32.dll")
    && CommandLine.includes("Control_RunDLL") && (CommandLine.includes("%AppData%")
    || CommandLine.includes("%LocalAppData%") || CommandLine.includes("%Temp%") ||
    CommandLine.includes("\AppData\\") || CommandLine.includes("\Temp\\") || CommandLine.includes("\Users\Public\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"32b96012-7892-429e-b26c-ac2bf46066ff_sysmon_ot"'
  description: Shell32 DLL Execution in Suspicious Directory
- id: eval
  filter: (EventID=="1" && (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys")) && Image.endsWith("\taskmgr.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9fff585c-c33e-4a86-b3cd-39312079a65f_sysmon_ot"'
  description: Taskmgr as LOCAL_SYSTEM
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\taskmgr.exe") &&  ! ((Image.endsWith("\resmon.exe")
    || Image.endsWith("\mmc.exe") || Image.endsWith("\taskmgr.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3d7679bd-0c00-440c-97b0-3f204273e6c7_sysmon_ot"'
  description: Taskmgr as Parent
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\tracker.exe")) || (Description=="Tracker"))
    && (CommandLine.includes(" /d ")) && (CommandLine.includes(" /c ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"148431ce-4b70-403d-8525-fcc2993f29ea_sysmon_ot"'
  description: DLL Injection with Tracker.exe
- id: eval
  filter: (EventID=="1" && (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys")) && Image.endsWith("\tscon.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9847f263-4a81-424f-970c-875dab15b79b_sysmon_ot"'
  description: Suspicious TSCON Start as SYSTEM
- id: eval
  filter: (EventID=="1" && CommandLine.includes(" /dest:rdp-tcp:"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb_sysmon_ot"'
  description: Suspicious RDP Redirect Using TSCON
- id: eval
  filter: (EventID=="1" && Image.includes("C:\Windows \System32\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4ac47ed3-44c2-4b1f-9d51-bf46e8914126_sysmon_ot"'
  description: TrustedPath UAC Bypass Pattern
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\userinit.exe") &&  ! (CommandLine.includes("\netlogon\\")))
    &&  ! (Image.endsWith("\explorer.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b655a06a-31c0-477a-95c2-3726b83d649d_sysmon_ot"'
  description: Suspicious Userinit Child Process
- id: eval
  filter: (EventID=="1" && Image.endsWith("\csi.exe") && ParentImage.endsWith("\powershell.exe")
    && OriginalFileName=="csi.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a9e416a8-e613-4f8b-88b8-a7d1d1af2f61_sysmon_ot"'
  description: Suspicious Use of CSharp Interactive Console
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\sqlps.exe") || ParentImage.endsWith("\sqlps.exe"))
    || (OriginalFileName=="\sqlps.exe" &&  ! (ParentImage.endsWith("\sqlagent.exe")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0152550d-3a26-4efd-9f0e-54a0b28ae2f3_sysmon_ot"'
  description: Detection of PowerShell Execution via Sqlps.exe
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\sqltoolsps.exe") || ParentImage.endsWith("\sqltoolsps.exe"))
    || (OriginalFileName=="\sqltoolsps.exe" &&  ! (ParentImage.endsWith("\smss.exe")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a746c9b8-a2fb-4ee5-a428-92bee9e99060_sysmon_ot"'
  description: SQL Client Tools PowerShell Session Detection
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\te.exe") || ParentImage.endsWith("\te.exe")
    || OriginalFileName=="\te.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"634b00d5-ccc3-4a06-ae3b-0ec8444dd51b_sysmon_ot"'
  description: Malicious Windows Script Components File Execution by TAEF Detection
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\vsjitdebugger.exe") &&  ! ((Image.endsWith("\vsimmersiveactivatehelper*.exe")
    || Image.endsWith("\devenv.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"15c7904e-6ad1-4a45-9b46-5fb25df37fd2_sysmon_ot"'
  description: Malicious PE Execution by Microsoft Visual Studio Debugger
- id: eval
  filter: (EventID=="1" && Image.endsWith("\VBoxDrvInst.exe") && CommandLine.includes("driver")
    && CommandLine.includes("executeinf"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b7b19cb6-9b32-4fc4-a108-73f19acfe262_sysmon_ot"'
  description: Suspicious VBoxDrvInst.exe Parameters
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("Execute") && CommandLine.includes("CreateObject")
    && CommandLine.includes("RegRead") && CommandLine.includes("window.close") &&
    CommandLine.includes("\Microsoft\Windows\CurrentVersion")) &&  ! ((CommandLine.includes("\Software\Microsoft\Windows\CurrentVersion\Run"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"20c3f09d-c53d-4e85-8b74-6aa50e2f1b61_sysmon_ot"'
  description: Suspicious VBScript UN2452 Pattern
- id: eval
  filter: (EventID=="1" && CommandLine.includes("reg") && CommandLine.includes(" add
    ") && CommandLine.includes("\Services\VSS\Diag") && CommandLine.includes("/d Disabled"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dee4af55-1f22-4e1d-a9d2-4bdc7ecb472a_sysmon_ot"'
  description: Disabled Volume Snapshots
- id: eval
  filter: (EventID=="1" && Image.endsWith("\whoami.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e28a5a99-da44-436d-b7a0-2afc20a5f413_sysmon_ot"'
  description: Whoami Execution
- id: eval
  filter: (EventID=="1" && ((((Image.endsWith("\whoami.exe") &&  ! ((ParentImage.endsWith("\cmd.exe")
    || ParentImage.endsWith("\powershell.exe")))) &&  ! ((ParentImage=="C:\Program
    Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe" || ParentImage=="")))
    &&  ! (ParentImage ===null )) || (CommandLine.includes("whoami -all") || CommandLine.includes("whoami
    /all") || CommandLine.includes("whoami.exe -all") || CommandLine.includes("whoami.exe
    /all"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8de1cbe8-d6f5-496d-8237-5f44a721c7a0_sysmon_ot"'
  description: Whoami Execution Anomaly
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\rar.exe") || Image.endsWith("\winrar.exe"))
    || Description=="Command line RAR") && CommandLine==".dmp")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1ac14d38-3dfc-4635-92c7-e3fd1c5f5bfc_sysmon_ot"'
  description: Winrar Compressing Dump Files
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\rar.exe") || Image.endsWith("\winrar.exe"))
    || Description=="Command line RAR") &&  ! ((Image.includes("\WinRAR") || Image.includes("C:\Windows\Temp")
    || Image.includes("\UnRAR.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4ede543c-e098-43d9-a28f-dd784a13132f_sysmon_ot"'
  description: Winrar Execution in Non-Standard Folder
- id: eval
  filter: (EventID=="1" && CommandLine.includes("winrm") && (CommandLine.includes("format:pretty")
    || CommandLine.includes("format:"pretty"") || CommandLine.includes("format:"text"")
    || CommandLine.includes("format:text")) &&  ! ((Image.startsWith("C:\Windows\System32\\")
    || Image.startsWith("C:\Windows\SysWOW64\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"074e0ded-6ced-4ebd-8b4d-53f55908119d_sysmon_ot"'
  description: AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cscript.exe") && CommandLine.includes("winrm")
    && CommandLine.includes("invoke Create wmicimv2/Win32_") && CommandLine.includes("-r:http"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9df0dd3a-1a5c-47e3-a2bc-30ed177646a0_sysmon_ot"'
  description: Remote Code Execute via Winrm.vbs
- id: eval
  filter: (EventID=="1" && CommandLine.includes("ActiveScriptEventConsumer") && CommandLine.includes("
    CREATE "))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ebef4391-1a81-4761-a40a-1db446c0e625_sysmon_ot"'
  description: Suspicious WMIC ActiveScriptEventConsumer Creation
- id: eval
  filter: (EventID=="1" && CommandLine.includes("process call create") && CommandLine.includes("rundll32"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3c89a1e8-0fba-449e-8f1b-8409d6267ec8_sysmon_ot"'
  description: Suspicious WMI Execution Using Rundll32
- id: eval
  filter: (EventID=="1" && CommandLine.includes("wmic") && CommandLine.includes("product
    where name=") && CommandLine.includes("call uninstall") && CommandLine.includes("/nointeractive")
    && (CommandLine.includes("Antivirus") || CommandLine.includes("AVG ") || CommandLine.includes("Crowdstrike
    Sensor") || CommandLine.includes("DLP Endpoint") || CommandLine.includes("Endpoint
    Detection") || CommandLine.includes("Endpoint Protection") || CommandLine.includes("Endpoint
    Security") || CommandLine.includes("Endpoint Sensor") || CommandLine.includes("ESET
    File Security") || CommandLine.includes("Malwarebytes") || CommandLine.includes("McAfee
    Agent") || CommandLine.includes("Microsoft Security Client") || CommandLine.includes("Threat
    Protection") || CommandLine.includes("VirusScan") || CommandLine.includes("Webroot
    SecureAnywhere") || CommandLine.includes("Windows Defender")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"847d5ff3-8a31-4737-a970-aeae8fe21765_sysmon_ot"'
  description: Wmic Uninstall Security Product
- id: eval
  filter: (EventID=="1" && Image.endsWith("\wmic.exe") && ((CommandLine.includes("process")
    && CommandLine.includes("call") && CommandLine.includes("create ")) || (CommandLine.includes("
    path ") && (CommandLine.includes("AntiVirus") || CommandLine.includes("Firewall"))
    && CommandLine.includes("Product") && CommandLine.includes(" get "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"526be59f-a573-4eea-b5f7-f0973207634d_sysmon_ot"'
  description: Suspicious WMI Execution
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\control.exe") && ParentImage.endsWith("\WorkFolders.exe"))
    &&  ! (Image=="C:\Windows\System32\control.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0bbc6369-43e3-453d-9944-cae58821c173_sysmon_ot"'
  description: Execution via WorkFolders.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\wsl.exe")) && (CommandLine.includes("
    -e ") || CommandLine.includes(" --exec ")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dec44ca7-61ad-493c-bfd7-8819c5faa09b_sysmon_ot"'
  description: WSL Execution
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("/UpdateDeploymentProvider") && CommandLine.includes("/RunHandlerComServer")
    && CommandLine.includes(".dll") && (Image.endsWith("\wuauclt.exe"))) &&  ! ((CommandLine.includes("
    /ClassId ") || CommandLine.includes(" wuaueng.dll "))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d7825193-b70a-48a4-b992-8b5b3015cc11_sysmon_ot"'
  description: Windows Update Client LOLBIN
- id: eval
  filter: (EventID=="1" && Image.endsWith("\auditpol.exe") && (CommandLine.includes("disable")
    || CommandLine.includes("clear") || CommandLine.includes("remove") || CommandLine.includes("restore")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0a13e132-651d-11eb-ae93-0242ac130002_sysmon_ot"'
  description: Suspicious Auditpol Usage
- id: eval
  filter: (EventID=="1" && Image.endsWith("\fltmc.exe") && CommandLine.includes("unload")
    && CommandLine.includes("sys"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4d7cda18-1b12-4e52-b45c-d28653210df8_sysmon_ot"'
  description: Sysmon Driver Unload
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\svchost.exe") || Image.endsWith("\rundll32.exe")
    || Image.endsWith("\services.exe") || Image.endsWith("\powershell.exe") || Image.endsWith("\regsvr32.exe")
    || Image.endsWith("\spoolsv.exe") || Image.endsWith("\lsass.exe") || Image.endsWith("\smss.exe")
    || Image.endsWith("\csrss.exe") || Image.endsWith("\conhost.exe") || Image.endsWith("\wininit.exe")
    || Image.endsWith("\lsm.exe") || Image.endsWith("\winlogon.exe") || Image.endsWith("\explorer.exe")
    || Image.endsWith("\taskhost.exe") || Image.endsWith("\Taskmgr.exe") || Image.endsWith("\sihost.exe")
    || Image.endsWith("\RuntimeBroker.exe") || Image.endsWith("\smartscreen.exe")
    || Image.endsWith("\dllhost.exe") || Image.endsWith("\audiodg.exe") || Image.endsWith("\wlanext.exe"))
    &&  ! ((Image.startsWith("C:\Windows\System32\\") || Image.startsWith("C:\Windows\system32\\")
    || Image.startsWith("C:\Windows\SysWow64\\") || Image.startsWith("C:\Windows\SysWOW64\\")
    || Image.startsWith("C:\Windows\winsxs\\") || Image.startsWith("C:\Windows\WinSxS\\")
    || Image.startsWith("C:\avast! sandbox")) || Image.includes("\SystemRoot\System32\\")
    || Image=="C:\Windows\explorer.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e4a6b256-3e47-40fc-89d2-7a477edd6915_sysmon_ot"'
  description: System File Execution Location Anomaly
- id: eval
  filter: (EventID=="1" && Image.endsWith("\tapinstall.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"99793437-3e16-439b-be0f-078782cf953d_sysmon_ot"'
  description: Tap Installer Execution
- id: eval
  filter: (EventID=="1" && (CommandLine.includes("echo ") || CommandLine.includes("copy
    ") || CommandLine.includes("type ") || CommandLine.includes("file createnew"))
    && (CommandLine.includes(" C:\Windows\System32\Tasks\\") || CommandLine.includes("
    C:\Windows\SysWow64\Tasks\\")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cc4e02ba-9c06-48e2-b09e-2500cace9ae0_sysmon_ot"'
  description: Tasks Folder Evasion
- id: eval
  filter: (EventID=="1" && (ParentCommandLine.includes("\svchost.exe") && ParentCommandLine.includes("termsvcs"))
    &&  ! (Image.endsWith("\rdpclip.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1012f107-b8f1-4271-af30-5aed2de89b39_sysmon_ot"'
  description: Terminal Service Process Spawn
- id: eval
  filter: (EventID=="1" && ((Image.includes("PetitPotam") || Image.includes("RottenPotato")
    || Image.includes("HotPotato") || Image.includes("JuicyPotato") || Image.includes("\just_dce_")
    || Image.includes("Juicy Potato") || Image.includes("\temp\rot.exe") || Image.includes("\Potato.exe")
    || Image.includes("\SpoolSample.exe") || Image.includes("\Responder.exe") || Image.includes("\smbrelayx")
    || Image.includes("\ntlmrelayx")) || (CommandLine.includes("Invoke-Tater") ||
    CommandLine.includes(" smbrelay") || CommandLine.includes(" ntlmrelay") || CommandLine.includes("cme
    smb ") || CommandLine.includes(" /ntlm:NTLMhash ") || CommandLine.includes("Invoke-PetitPotam"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5589ab4f-a767-433c-961d-c91f3f704db1_sysmon_ot"'
  description: SMB Relay Attack Tools
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\nltest.exe") && (CommandLine.includes("domain_trusts")
    || CommandLine.includes("all_trusts") || CommandLine.includes("/trusted_domains")
    || CommandLine.includes("/dclist"))) || (Image.endsWith("\dsquery.exe") && CommandLine.includes("trustedDomain"))
    || (Image.endsWith("\dsquery.exe") && CommandLine.includes("-filter") && CommandLine.includes("trustedDomain"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3bad990e-4848-4a78-9530-b427d854aac0_sysmon_ot"'
  description: Domain Trust Discovery
- id: eval
  filter: (EventID=="1" && Image.endsWith("\changepk.exe") && ParentImage.endsWith("\slui.exe")
    && (IntegrityLevel=="High" || IntegrityLevel=="System"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"503d581c-7df0-4bbe-b9be-5840c0ecc1fc_sysmon_ot"'
  description: UAC Bypass Using ChangePK and SLUI
- id: eval
  filter: (EventID=="1" && CommandLine.endsWith(""\system32\cleanmgr.exe /autoclean
    /d C:") && ParentCommandLine=="C:\Windows\system32\svchost.exe -k netsvcs -p -s
    Schedule" && (IntegrityLevel=="High" || IntegrityLevel=="System"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b697e69c-746f-4a86-9f59-7bfff8eab881_sysmon_ot"'
  description: UAC Bypass Using Disk Cleanup
- id: eval
  filter: (EventID=="1" && ((IntegrityLevel=="High" || IntegrityLevel=="System") &&
    Image=="C:\Windows\System32\ComputerDefaults.exe") &&  ! ((ParentImage.includes(":\Windows\System32")
    || ParentImage.includes(":\Program Files"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3c05e90d-7eba-4324-9972-5d7f711a60a8_sysmon_ot"'
  description: UAC Bypass Using ComputerDefaults
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\consent.exe") && Image.endsWith("\werfault.exe")
    && (IntegrityLevel=="High" || IntegrityLevel=="System"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1ca6bd18-0ba0-44ca-851c-92ed89a61085_sysmon_ot"'
  description: UAC Bypass Using Consent and Comctl32 - Process
- id: eval
  filter: (EventID=="1" && ParentImage.includes("C:\Users\\") && ParentImage.includes("\AppData\Local\Temp\\")
    && ParentImage.includes("\DismHost.exe") && (IntegrityLevel=="High" || IntegrityLevel=="System"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"853e74f9-9392-4935-ad3b-2e8c040dae86_sysmon_ot"'
  description: UAC Bypass Using DismHost
- id: eval
  filter: (EventID=="1" && (IntegrityLevel=="High" || IntegrityLevel=="System") &&
    ParentImage.endsWith("\ieinstal.exe") && Image.includes("\AppData\Local\Temp\\")
    && Image.endsWith("consent.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"80fc36aa-945e-4181-89f2-2f907ab6775d_sysmon_ot"'
  description: UAC Bypass Using IEInstal - Process
- id: eval
  filter: (EventID=="1" && (IntegrityLevel=="High" || IntegrityLevel=="System") &&
    ParentImage.endsWith("\AppData\Local\Temp\pkgmgr.exe") && CommandLine==""C:\Windows\system32\msconfig.exe"
    -5")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ad92e3f9-7eb6-460e-96b1-582b0ccbb980_sysmon_ot"'
  description: UAC Bypass Using MSConfig Token Modification - Process
- id: eval
  filter: (EventID=="1" && (IntegrityLevel=="High" || IntegrityLevel=="System") &&
    ((CommandLine.startsWith(""C:\Windows\system32\wusa.exe"  /quiet C:\Users\\")
    && CommandLine.endsWith("\AppData\Local\Temp\update.msu")) || (ParentCommandLine==""C:\Windows\system32\dism.exe"
    /online /quiet /norestart /add-package /packagepath:"C:\Windows\system32\pe386"
    /ignorecheck" && CommandLine.includes("C:\Users\\") && CommandLine.includes("\AppData\Local\Temp\\")
    && CommandLine.includes("\dismhost.exe {") && Image.endsWith("\DismHost.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"39ed3c80-e6a1-431b-9df3-911ac53d08a7_sysmon_ot"'
  description: UAC Bypass Using NTFS Reparse Point - Process
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\pkgmgr.exe") && Image.endsWith("\dism.exe")
    && (IntegrityLevel=="High" || IntegrityLevel=="System"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a743ceba-c771-4d75-97eb-8a90f7f4844c_sysmon_ot"'
  description: UAC Bypass Using PkgMgr and DISM
- id: eval
  filter: (EventID=="1" && (IntegrityLevel=="High" || IntegrityLevel=="System") &&
    ParentImage.endsWith("\AppData\Local\Temp\system32\winsat.exe") && ParentCommandLine.includes("C:\Windows
    \system32\winsat.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7a01183d-71a2-46ad-ad5c-acd989ac1793_sysmon_ot"'
  description: UAC Bypass Abusing Winsat Path Parsing - Process
- id: eval
  filter: (EventID=="1" && (IntegrityLevel=="High" || IntegrityLevel=="System") &&
    (Image=="C:\Program Files\Windows Media Player\osk.exe" || (Image=="C:\Windows\System32\cmd.exe"
    && ParentCommandLine==""C:\Windows\system32\mmc.exe" "C:\Windows\system32\eventvwr.msc"
    /s")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0058b9e5-bcd7-40d4-9205-95ca5a16d7b2_sysmon_ot"'
  description: UAC Bypass Using Windows Media Player - Process
- id: eval
  filter: (EventID=="1" && Image.endsWith("\wsreset.exe") && (IntegrityLevel=="High"
    || IntegrityLevel=="System"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"89a9a0e0-f61a-42e5-8957-b1479565a658_sysmon_ot"'
  description: UAC Bypass WSReset
- id: eval
  filter: (EventID=="1" && Image.endsWith("\cmstp.exe") && (CommandLine.includes("/s")
    || CommandLine.includes("/au")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e66779cc-383e-4224-a3a4-267eeb585c40_sysmon_ot"'
  description: Bypass UAC via CMSTP
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\fodhelper.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7f741dcf-fc22-4759-87b4-9ae8376676a2_sysmon_ot"'
  description: Bypass UAC via Fodhelper.exe
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\wsreset.exe") &&  ! (Image.endsWith("\conhost.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d797268e-28a9-49a7-b9a8-2f5039011c5c_sysmon_ot"'
  description: Bypass UAC via WSReset.exe
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\sc.exe") && IntegrityLevel=="Medium")
    && ((CommandLine.includes("config") && CommandLine.includes("binPath")) || (CommandLine.includes("failure")
    && CommandLine.includes("command"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d937b75f-a665-4480-88a5-2f20e9f9b22a_sysmon_ot"'
  description: Possible Privilege Escalation via Weak Service Permissions
- id: eval
  filter: (EventID=="1" && Image.endsWith("\sc.exe") && CommandLine.includes("sdset")
    && CommandLine.includes("DCLCWPDTSD"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a537cfc3-4297-4789-92b5-345bfd845ad0_sysmon_ot"'
  description: Abuse of Service Permissions to Hide Services in Tools
- id: eval
  filter: (EventID=="1" &&  ! ((Image.startsWith("C:\Windows\System32\\") || Image.startsWith("C:\Windows\SysWOW64\\")))
    && (ParentCommandLine.includes("cmd.exe /c") && ParentCommandLine.includes("RoamDiag.cmd")
    && ParentCommandLine.includes("-outputpath")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b2ddd389-f676-4ac4-845a-e00781a48e5f_sysmon_ot"'
  description: Using SettingSyncHost.exe as LOLBin
- id: eval
  filter: (EventID=="1" && Image.endsWith("\verclsid.exe") && CommandLine.includes("/C")
    && CommandLine.includes("/S"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d06be4b9-8045-428b-a567-740a26d9db25_sysmon_ot"'
  description: Verclsid.exe Runs COM Object
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\vbc.exe") && Image.endsWith("\cvtres.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7b10f171-7f04-47c7-9fa2-5be43c76e535_sysmon_ot"'
  description: Visual Basic Command Line Compiler Usage
- id: eval
  filter: (EventID=="1" && CommandLine.includes("transport=dt_socket,address=") &&  !
    (CommandLine.includes("address=127.0.0.1") || CommandLine.includes("address=localhost")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8f88e3f6-2a49-48f5-a5c4-2f7eedf78710_sysmon_ot"'
  description: Java Running with Remote Debugging
- id: eval
  filter: (EventID=="1" && ((ParentImage.endsWith("\w3wp.exe") || ParentImage.endsWith("\php-cgi.exe")
    || ParentImage.endsWith("\nginx.exe") || ParentImage.endsWith("\httpd.exe")) ||
    (ParentImage.includes("\apache") || ParentImage.includes("\tomcat"))) && ((((Image.endsWith("\net.exe")
    || Image.endsWith("\net1.exe")) && (CommandLine.includes(" user ") || CommandLine.includes("
    use ") || CommandLine.includes(" group "))) || (Image.endsWith("\ping.exe") &&
    CommandLine.includes(" -n ")) || (CommandLine.includes("&cd&echo") || CommandLine.includes("cd
    /d "))) || (Image.endsWith("\wmic.exe") && CommandLine.includes(" /node:")) ||
    (Image.endsWith("\whoami.exe") || Image.endsWith("\systeminfo.exe") || Image.endsWith("\quser.exe")
    || Image.endsWith("\ipconfig.exe") || Image.endsWith("\pathping.exe") || Image.endsWith("\tracert.exe")
    || Image.endsWith("\netstat.exe") || Image.endsWith("\schtasks.exe") || Image.endsWith("\vssadmin.exe")
    || Image.endsWith("\wevtutil.exe") || Image.endsWith("\tasklist.exe")) || (CommandLine.includes("
    Test-NetConnection ") || CommandLine.includes("dir \\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bed2a484-9348-4143-8a8a-b801c979301c_sysmon_ot"'
  description: Webshell Detection With Command Line Keywords
- id: eval
  filter: (EventID=="1" && ((ParentImage.includes("\apache") || ParentImage.includes("\tomcat"))
    || (ParentImage.endsWith("\w3wp.exe") || ParentImage.endsWith("\php-cgi.exe")
    || ParentImage.endsWith("\nginx.exe") || ParentImage.endsWith("\httpd.exe")))
    && ((Image.endsWith("\cmd.exe")) && (CommandLine.includes("perl --help") || CommandLine.includes("python
    --help") || CommandLine.includes("wget --help") || CommandLine.includes("perl
    -h"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f64e5c19-879c-4bae-b471-6d84c8339677_sysmon_ot"'
  description: Webshell Recon Detection Via CommandLine & Processes
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\w3wp.exe") || ParentImage.endsWith("\httpd.exe")
    || ParentImage.endsWith("\nginx.exe") || ParentImage.endsWith("\php-cgi.exe")
    || ParentImage.endsWith("\tomcat.exe") || ParentImage.endsWith("\UMWorkerProcess.exe")
    || ParentImage.endsWith("\ws_TomcatService.exe")) && (Image.endsWith("\cmd.exe")
    || Image.endsWith("\sh.exe") || Image.endsWith("\bash.exe") || Image.endsWith("\powershell.exe")
    || Image.endsWith("\bitsadmin.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8202070f-edeb-4d31-a010-a26c72ac5600_sysmon_ot"'
  description: Shells Spawned by Web Servers
- id: eval
  filter: (EventID=="1" && (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys")) && Image.endsWith("\whoami.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"80167ada-7a12-41ed-b8e9-aa47195c66a1_sysmon_ot"'
  description: Run Whoami as SYSTEM
- id: eval
  filter: (EventID=="1" && Image.endsWith("\whoami.exe") && CommandLine.includes("/priv"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"97a80ec7-0e2f-4d05-9ef4-65760e634f6b_sysmon_ot"'
  description: Run Whoami Showing Privileges
- id: eval
  filter: (EventID=="1" && Image.endsWith("\schtasks.exe") && CommandLine.includes("/change")
    && CommandLine.includes("/TN") && CommandLine.includes("/RU") && CommandLine.includes("/RP"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"931b6802-d6a6-4267-9ffa-526f57f22aaf_sysmon_ot"'
  description: Windows 10 Scheduled Task SandboxEscaper 0-day
- id: eval
  filter: (EventID=="1" && Image.endsWith("\winword.exe") && CommandLine.includes("/l"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2621b3a6-3840-4810-ac14-a02426086171_sysmon_ot"'
  description: Winword.exe Loads Suspicious DLL
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\WmiPrvSe.exe") &&  ! ((LogonId=="0x3e7"
    || LogonId=="null") || (User.startsWith("NT AUTHORITY\SYSTEM") || User.startsWith("AUTORITE
    NT\Sys")) || (Image.endsWith("\WmiPrvSE.exe") || Image.endsWith("\WerFault.exe"))))
    &&  ! (LogonId ===null ))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d21374ff-f574-44a7-9998-4a8c8bf33d7d_sysmon_ot"'
  description: Wmiprvse Spawning Process
- id: eval
  filter: (EventID=="1" && ParentImage.endsWith("\EdgeTransport.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"797011dc-44f4-4e6f-9f10-a8ceefbe566b_sysmon_ot"'
  description: WMI Backdoor Exchange Transport Agent
- id: eval
  filter: (EventID=="1" && Image=="C:\WINDOWS\system32\wbem\scrcons.exe" && ParentImage=="C:\Windows\System32\svchost.exe")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ec1d5e28-8f3b-4188-a6f8-6e8df81dc28e_sysmon_ot"'
  description: WMI Persistence - Script Event Consumer
- id: eval
  filter: (EventID=="1" && (((ParentImage.endsWith("\wmiprvse.exe")) && (Image.endsWith("\powershell.exe")))
    &&  ! (CommandLine=="null")) &&  ! (CommandLine ===null ))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"692f0bec-83ba-4d04-af7e-e884a96059b6_sysmon_ot"'
  description: WMI Spawning Windows PowerShell
- id: eval
  filter: (EventID=="1" && (Image.endsWith("\Microsoft.Workflow.Compiler.exe") ||
    (OriginalFileName=="Microsoft.Workflow.Compiler.exe" && CommandLine.includes(".xml"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"419dbf2b-8a9b-4bea-bf99-7544b050ec8d_sysmon_ot"'
  description: Microsoft Workflow Compiler
- id: eval
  filter: (EventID=="1" && (ParentImage.endsWith("\WSreset.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bdc8918e-a1d5-49d1-9db7-ea0fd91aa2ae_sysmon_ot"'
  description: Wsreset UAC Bypass
- id: eval
  filter: (EventID=="1" && ((Image.endsWith("\wmic.exe") && CommandLine.includes("/format"))
    || Image.endsWith("\msxsl.exe")) &&  ! ((CommandLine.includes("/Format:List")
    || CommandLine.includes("/Format:htable") || CommandLine.includes("/Format:hform")
    || CommandLine.includes("/Format:table") || CommandLine.includes("/Format:mof")
    || CommandLine.includes("/Format:value") || CommandLine.includes("/Format:rawxml")
    || CommandLine.includes("/Format:xml") || CommandLine.includes("/Format:csv"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"05c36dd6-79d6-4a9a-97da-3db20298ab2d_sysmon_ot"'
  description: XSL Script Processing
- id: eval
  filter: (EventID=="9" &&  ! ((Device.includes("floppy")) || ((Image.startsWith("C:\Windows\System32\\")
    || Image.startsWith("C:\Windows\SystemApps\\")) && (Image.endsWith("\wmiprvse.exe")
    || Image.endsWith("\sdiagnhost.exe") || Image.endsWith("\searchindexer.exe") ||
    Image.endsWith("\csrss.exe") || Image.endsWith("\defrag.exe") || Image.endsWith("\smss.exe")
    || Image.endsWith("\vssvc.exe") || Image.endsWith("\compattelrunner.exe") || Image.endsWith("\wininit.exe")
    || Image.endsWith("\autochk.exe") || Image.endsWith("\taskhost.exe") || Image.endsWith("\dfsrs.exe")
    || Image.endsWith("\vds.exe") || Image.endsWith("\lsass.exe") || Image.endsWith("\svchost.exe")
    || Image.endsWith("\MsMpEng.exe") || Image.endsWith("\SearchApp.exe"))) || (ProcessId=="4")
    || ((Image=="C:\Program Files\Bitdefender Antivirus Free\updatesrv.exe" || Image=="C:\Program
    Files\Bitdefender Antivirus Free\downloader.exe" || Image=="C:\Program Files\Bitdefender
    Antivirus Free\vsserv.exe" || Image=="C:\Windows\System32\backgroundTaskHost.exe"
    || Image=="C:\Windows\System32\RuntimeBroker.exe" || Image=="C:\Windows\System32\MoUsoCoreWorker.exe"
    || Image=="C:\Windows\System32\taskhostw.exe" || Image=="C:\Windows\System32\SrTasks.exe"
    || Image=="C:\Windows\System32\dllhost.exe" || Image=="C:\Windows\System32\DeviceCensus.exe"))
    || (Image.endsWith("\Keybase\upd.exe")) || (Image.startsWith("C:\ProgramData\Microsoft\Windows
    Defender\Platform\\") && Image.endsWith("\MsMpEng.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"db809f10-56ce-4420-8c86-d6a7d793c79c_sysmon_ot"'
  description: Raw Disk Access Using Illegitimate Tools
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\TelemetryController\\")
    && (Details.endsWith(".sh") || Details.endsWith(".exe") || Details.endsWith(".dll")
    || Details.endsWith(".bin") || Details.endsWith(".bat") || Details.endsWith(".cmd")
    || Details.endsWith(".js") || Details.endsWith(".ps") || Details.endsWith(".vb")
    || Details.endsWith(".jar") || Details.endsWith(".hta") || Details.endsWith(".msi")
    || Details.endsWith(".vbs")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4e8d5fd3-c959-441f-a941-f73d0cdcdca5_sysmon_ot"'
  description: Abusing Windows Telemetry For Persistence
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("SOFTWARE\Microsoft\Windows\CurrentVersion\UMe")
    || TargetObject.endsWith("SOFTWARE\Microsoft\Windows\CurrentVersion\UT")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7bdf2a7c-3acc-4091-9581-0a77dad1c5b5_sysmon_ot"'
  description: Chafer Activity
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\SYSTEM\CurrentControlSet\services\null\Instance"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"47e0852a-cf81-4494-a8e6-31864f8c86ed_sysmon_ot"'
  description: Pandemic Registry Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("SYSTEM\CurrentControlSet\Control\CrashControl")
    && Details=="DWORD (0x00000000)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"2ff692c2-4594-41ec-8fcb-46587de769e0_sysmon_ot"'
  description: CrashControl CrashDump Disabled
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("\Software\Classes\CLSID\{CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA}\InprocServer32")
    || TargetObject.includes("\SOFTWARE\Classes\CLSID\{7C857801-7381-11CF-884D-00AA004B2E24}\InProcServer32"))
    && "IMJPUEXP.DLL")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"32b5db62-cb5f-4266-9639-0fa48376ac00_sysmon_ot"'
  description: CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && Details=="DWORD (0x00000001)" && ((TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender\DisableAntiSpyware" || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender\DisableAntiVirus") || (TargetObject=="HKLM\SYSTEM\CurrentControlSet\Services\WinDefend"
    || TargetObject=="HKLM\SOFTWARE\Microsoft\Windows Defender" || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a64e4198-c1c8-46a5-bc9c-324c86455fd4_sysmon_ot"'
  description: Windows Defender Threat Detection Disabled
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("\Microsoft\Windows Defender\Exclusions"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a982fc9c-6333-4ffb-a51d-addb04e8b529_sysmon_ot"'
  description: Windows Defender Exclusions Added
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && (((TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time
    Protection\DisableBehaviorMonitoring" || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender\Real-Time Protection\DisableIOAVProtection" || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender\Real-Time Protection\DisableOnAccessProtection" || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender\Real-Time Protection\DisableRealtimeMonitoring" || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender\Real-Time Protection\DisableScanOnRealtimeEnable" || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows
    Defender\SpyNet\DisableBlockAtFirstSeen") && Details=="DWORD (0x00000001)") ||
    ((TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\SpyNet\SpynetReporting"
    || TargetObject=="HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\SpyNet\SubmitSamplesConsent")
    && Details=="DWORD (0x00000000)")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fd115e64-97c7-491f-951c-fc8da7e042fa_sysmon_ot"'
  description: Windows Defender Real-Time Protection Disabled
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("\services\DNS\Parameters\ServerLevelPluginDll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e61e8a88-59a9-451c-874e-70fcc9740d67_sysmon_ot"'
  description: DNS ServerLevelPluginDll Install
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.startsWith("HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run")
    && Details.startsWith("%AppData%\Roaming\Oracle\bin\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"42f0e038-767e-4b85-9d96-2c6335bad0b5_sysmon_ot"'
  description: Adwind RAT / JRAT
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventID=="12" ||
    EventID=="13") && TargetObject.includes("SYSTEM\\") && TargetObject.endsWith("\services\localNETService"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7_sysmon_ot"'
  description: Registry Entries For Azorult Malware
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("\CurrentControlSet\Services\wercplsupport\Parameters\ServiceDll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"92b0b372-a939-44ed-a11b-5136cf680e27_sysmon_ot"'
  description: Blue Mockingbird
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((TargetObject=="HKLM\HARDWARE\{804423C2-F490-4ac3-BFA5-13DEDE63A71A}"
    || TargetObject=="HKLM\HARDWARE\{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}" || TargetObject=="HKLM\HARDWARE\{2DB80286-1784-48b5-A751-B6ED1F490303}")
    || (TargetObject.startsWith("HKLM\SYSTEM\Setup\PrintResponsor\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5118765f-6657-4ddb-a487-d7bd673abbf1_sysmon_ot"'
  description: FlowCloud Malware
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\software\NetWire"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1d218616-71b0-4c40-855b-9dbe75510f7f_sysmon_ot"'
  description: NetWire RAT Registry Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\Software\AppDataLow\Software\Microsoft\\")
    &&  ! ((TargetObject.includes("\SOFTWARE\AppDataLow\Software\Microsoft\Internet
    Explorer\\") || TargetObject.includes("\SOFTWARE\AppDataLow\Software\Microsoft\RepService\\")
    || TargetObject.includes("\SOFTWARE\AppDataLow\Software\Microsoft\IME\\") || TargetObject.includes("\SOFTWARE\AppDataLow\Software\Microsoft\Edge\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"21f17060-b282-4249-ade0-589ea3591558_sysmon_ot"'
  description: Ursnif
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((EventType=="DeleteValue"
    && TargetObject.includes("\Microsoft\Terminal Server Client\Default\MRU")) ||
    (EventType=="DeleteKey" && TargetObject.includes("\Microsoft\Terminal Server Client\Servers\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"07bdd2f5-9c58-4f38-aec8-e101bb79ef8d_sysmon_ot"'
  description: Terminal Server Client Connection History Cleared
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("SYSTEM\\")
    && TargetObject.includes("ControlSet") && TargetObject.includes("\Control\Lsa")
    && (TargetObject.endsWith("\lmcompatibilitylevel") || TargetObject.endsWith("\NtlmMinClientSec")
    || TargetObject.endsWith("\RestrictSendingNTLMTraffic")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d67572a0-e2ec-45d6-b8db-c100d14b8ef2_sysmon_ot"'
  description: NetNTLM Downgrade Attack
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Image File Execution Options\sethc.exe\Debugger") || TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Image File Execution Options\utilman.exe\Debugger") || TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Image File Execution Options\osk.exe\Debugger") || TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Image File Execution Options\Magnify.exe\Debugger") || TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Image File Execution Options\Narrator.exe\Debugger") || TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Image File Execution Options\DisplaySwitch.exe\Debugger")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"baca5663-583c-45f9-b5dc-ea96a22ce542_sysmon_ot"'
  description: Sticky Key Like Backdoor Usage
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("\EulaAccepted"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"25ffa65d-76d8-4da5-a832-3f2b0136e133_sysmon_ot"'
  description: Usage of Sysinternals Tools
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.startsWith("HKCU\\")
    && TargetObject.endsWith("\mscfile\shell\open\command"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7c81fec3-1c1d-43b0-996a-46753041b1b6_sysmon_ot"'
  description: UAC Bypass via Event Viewer
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("\Root\InventoryApplicationFile\winsat.exe|") && TargetObject.endsWith("\LowerCaseLongPath")
    && Details.startsWith("c:\users\\") && Details.endsWith("\appdata\local\temp\system32\winsat.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6597be7b-ac61-4ac8-bef4-d3ec88174853_sysmon_ot"'
  description: UAC Bypass Abusing Winsat Path Parsing - Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.endsWith("\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility
    Assistant\Store\C:\Program Files\Windows Media Player\osk.exe") && Details=="Binary
    Data")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5f9db380-ea57-4d1e-beab-8a2d33397e93_sysmon_ot"'
  description: UAC Bypass Using Windows Media Player - Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject=="HKCU\Software\Microsoft\Windows\CurrentVersion\Run\ntkd")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"70d43542-cd2d-483c-8f30-f16b436fd7db_sysmon_ot"'
  description: Leviathan Registry Key Activity
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((TargetObject=="HKCU\SOFTWARE\Classes\CLSID\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\Model"
    || ((TargetObject.startsWith("HKCU\SOFTWARE\App\\") || TargetObject.startsWith("HKLM\SOFTWARE\App\\"))
    && (TargetObject.includes("AppXbf13d4ea2945444d8b13e2121cb6b663\\") || TargetObject.includes("AppX70162486c7554f7f80f481985d67586d\\")
    || TargetObject.includes("AppX37cc7fdccd644b4f85f4b22d5a3f105a\\")) && (TargetObject.endsWith("Application")
    || TargetObject.endsWith("DefaultIcon")))) || ((TargetObject.startsWith("HKCU\\"))
    && (TargetObject.includes("Classes\AppXc52346ec40fb4061ad96be0e6cb7d16a\\") ||
    TargetObject.includes("Classes\AppX3bbba44c6cae4d9695755183472171e2\\") || TargetObject.includes("Classes\CLSID\{E3517E26-8E93-458D-A6DF-8030BC80528B}\\")
    || TargetObject.includes("Classes\CLSID\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\Model")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4ac5fc44-a601-4c06-955b-309df8c4e9d4_sysmon_ot"'
  description: OceanLotus Registry Activity
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\Software\Classes") && (TargetObject.includes("\Folder\ShellEx\ExtShellFolderViews")
    || TargetObject.includes("\Folder\ShellEx\DragDropHandlers") || TargetObject.includes("\Folder\Shellex\ColumnHandlers")
    || TargetObject.includes("\Filter") || TargetObject.includes("\Exefile\Shell\Open\Command\(Default)")
    || TargetObject.includes("\Directory\Shellex\DragDropHandlers") || TargetObject.includes("\Directory\Shellex\CopyHookHandlers")
    || TargetObject.includes("\CLSID\{AC757296-3522-4E11-9862-C17BE5A1767E}\Instance")
    || TargetObject.includes("\CLSID\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\Instance")
    || TargetObject.includes("\CLSID\{7ED96837-96F0-4812-B211-F13C24117ED3}\Instance")
    || TargetObject.includes("\CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\Instance")
    || TargetObject.includes("\Classes\AllFileSystemObjects\ShellEx\DragDropHandlers")
    || TargetObject.includes("\.exe") || TargetObject.includes("\.cmd") || TargetObject.includes("\ShellEx\PropertySheetHandlers")
    || TargetObject.includes("\ShellEx\ContextMenuHandlers"))) &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9df5f547-c86a-433e-b533-f2794357e242_sysmon_ot"'
  description: Classes Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && (TargetObject.includes("\SOFTWARE\Wow6432Node\Microsoft\Windows CE Services\AutoStart")
    || TargetObject.includes("\Software\Wow6432Node\Microsoft\Command Processor\Autorun")
    || TargetObject.includes("\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed
    Components") || TargetObject.includes("\SOFTWARE\Microsoft\Windows CE Services\AutoStartOnDisconnect")
    || TargetObject.includes("\SOFTWARE\Microsoft\Windows CE Services\AutoStartOnConnect")
    || TargetObject.includes("\SYSTEM\Setup\CmdLine") || TargetObject.includes("\Software\Microsoft\Ctf\LangBarAddin")
    || TargetObject.includes("\Software\Microsoft\Command Processor\Autorun") || TargetObject.includes("\SOFTWARE\Microsoft\Active
    Setup\Installed Components") || TargetObject.includes("\SOFTWARE\Classes\Protocols\Handler")
    || TargetObject.includes("\SOFTWARE\Classes\Protocols\Filter") || TargetObject.includes("\SOFTWARE\Classes\Htmlfile\Shell\Open\Command\(Default)")
    || TargetObject.includes("\Environment\UserInitMprLogonScript") || TargetObject.includes("\SOFTWARE\Policies\Microsoft\Windows\Control
    Panel\Desktop\Scrnsave.exe") || TargetObject.includes("\Software\Microsoft\Internet
    Explorer\UrlSearchHooks") || TargetObject.includes("\SOFTWARE\Microsoft\Internet
    Explorer\Desktop\Components") || TargetObject.includes("\Software\Classes\Clsid\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\Inprocserver32")
    || TargetObject.includes("\Control Panel\Desktop\Scrnsave.exe"))) &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f59c3faf-50f3-464b-9f4c-1b67ab512d99_sysmon_ot"'
  description: Commun Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\SYSTEM\CurrentControlSet\Control") && (TargetObject.includes("\Terminal
    Server\WinStations\RDP-Tcp\InitialProgram") || TargetObject.includes("\Terminal
    Server\Wds\rdpwd\StartupPrograms") || TargetObject.includes("\SecurityProviders\SecurityProviders")
    || TargetObject.includes("\SafeBoot\AlternateShell") || TargetObject.includes("\Print\Providers")
    || TargetObject.includes("\Print\Monitors") || TargetObject.includes("\NetworkProvider\Order")
    || TargetObject.includes("\Lsa\Notification Packages") || TargetObject.includes("\Lsa\Authentication
    Packages") || TargetObject.includes("\BootVerificationProgram\ImagePath"))) &&  !
    (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f674e36a-4b91-431e-8aef-f8a96c2aca35_sysmon_ot"'
  description: CurrentControlSet Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\SOFTWARE\Microsoft\Windows\CurrentVersion") && (TargetObject.includes("\ShellServiceObjectDelayLoad")
    || TargetObject.includes("\Run") || TargetObject.includes("\Policies\System\Shell")
    || TargetObject.includes("\Policies\Explorer\Run") || TargetObject.includes("\Group
    Policy\Scripts\Startup") || TargetObject.includes("\Group Policy\Scripts\Shutdown")
    || TargetObject.includes("\Group Policy\Scripts\Logon") || TargetObject.includes("\Group
    Policy\Scripts\Logoff") || TargetObject.includes("\Explorer\ShellServiceObjects")
    || TargetObject.includes("\Explorer\ShellIconOverlayIdentifiers") || TargetObject.includes("\Explorer\ShellExecuteHooks")
    || TargetObject.includes("\Explorer\SharedTaskScheduler") || TargetObject.includes("\Explorer\Browser
    Helper Objects") || TargetObject.includes("\Authentication\PLAP Providers") ||
    TargetObject.includes("\Authentication\Credential Providers") || TargetObject.includes("\Authentication\Credential
    Provider Filters"))) &&  ! ((Details=="(Empty)" || TargetObject.endsWith("\NgcFirst\ConsecutiveSwitchCount")
    || Image.endsWith("\AppData\Local\Microsoft\OneDrive\Update\OneDriveSetup.exe")
    || (Image=="C:\WINDOWS\system32\devicecensus.exe" || Image=="C:\Program Files\Microsoft
    OneDrive\StandaloneUpdater\OneDriveSetup.exe")) || ((Image.startsWith("C:\Program
    Files (x86)\Microsoft\EdgeUpdate\Install\\") || Image.startsWith("C:\Program Files
    (x86)\Microsoft\EdgeWebView\\")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"20f0ee37-5942-4e45-b7d5-c5b5db9df5cd_sysmon_ot"'
  description: CurrentVersion Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\SOFTWARE\Microsoft\Windows NT\CurrentVersion") && (TargetObject.includes("\Winlogon\VmApplet")
    || TargetObject.includes("\Winlogon\Userinit") || TargetObject.includes("\Winlogon\Taskman")
    || TargetObject.includes("\Winlogon\Shell") || TargetObject.includes("\Winlogon\GpExtensions")
    || TargetObject.includes("\Winlogon\AppSetup") || TargetObject.includes("\Winlogon\AlternateShells\AvailableShells")
    || TargetObject.includes("\Windows\IconServiceLib") || TargetObject.includes("\Windows\Appinit_Dlls")
    || TargetObject.includes("\Image File Execution Options") || TargetObject.includes("\Font
    Drivers") || TargetObject.includes("\Drivers32") || TargetObject.includes("\Windows\Run")
    || TargetObject.includes("\Windows\Load"))) &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"cbf93e5d-ca6c-4722-8bea-e9119007c248_sysmon_ot"'
  description: CurrentVersion NT Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && (TargetObject.includes("\Software\Wow6432Node\Microsoft\Internet Explorer")
    || TargetObject.includes("\Software\Microsoft\Internet Explorer")) && (TargetObject.includes("\Toolbar")
    || TargetObject.includes("\Extensions") || TargetObject.includes("\Explorer Bars")))
    &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a80f662f-022f-4429-9b8c-b1a41aaa6688_sysmon_ot"'
  description: Internet Explorer Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && (TargetObject.includes("\Software\Wow6432Node\Microsoft\Office") || TargetObject.includes("\Software\Microsoft\Office"))
    && (TargetObject.includes("\Word\Addins") || TargetObject.includes("\PowerPoint\Addins")
    || TargetObject.includes("\Outlook\Addins") || TargetObject.includes("\Onenote\Addins")
    || TargetObject.includes("\Excel\Addins") || TargetObject.includes("\Access\Addins")
    || TargetObject.includes("test\Special\Perf"))) &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"baecf8fb-edbf-429f-9ade-31fc3f22b970_sysmon_ot"'
  description: Office Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\System\CurrentControlSet\Control\Session Manager")
    && (TargetObject.includes("\SetupExecute") || TargetObject.includes("\S0InitialCommand")
    || TargetObject.includes("\KnownDlls") || TargetObject.includes("\Execute") ||
    TargetObject.includes("\BootExecute") || TargetObject.includes("\AppCertDlls")))
    &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"046218bd-e0d8-4113-a3c3-895a12b2b298_sysmon_ot"'
  description: Session Manager Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\Software\Policies\Microsoft\Windows\System\Scripts")
    && (TargetObject.includes("\Startup") || TargetObject.includes("\Shutdown") ||
    TargetObject.includes("\Logon") || TargetObject.includes("\Logoff"))) &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e7a2fd40-3ae1-4a85-bf80-15cf624fb1b1_sysmon_ot"'
  description: System Scripts Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\System\CurrentControlSet\Services\WinSock2\Parameters")
    && (TargetObject.includes("\Protocol_Catalog9\Catalog_Entries") || TargetObject.includes("\NameSpace_Catalog5\Catalog_Entries")))
    &&  ! (Details=="(Empty)" || Image=="C:\Windows\System32\MsiExec.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d6c2ce7e-afb5-4337-9ca4-4b5254ed0565_sysmon_ot"'
  description: WinSock2 Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion")
    && (TargetObject.includes("\ShellServiceObjectDelayLoad") || TargetObject.includes("\Run")
    || TargetObject.includes("\Explorer\ShellServiceObjects") || TargetObject.includes("\Explorer\ShellIconOverlayIdentifiers")
    || TargetObject.includes("\Explorer\ShellExecuteHooks") || TargetObject.includes("\Explorer\SharedTaskScheduler")
    || TargetObject.includes("\Explorer\Browser Helper Objects"))) &&  ! ((Details=="(Empty)")
    || (Image.includes("C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\{") &&
    Image.includes("\setup.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b29aed60-ebd1-442b-9cb5-16a1d0324adb_sysmon_ot"'
  description: Wow6432Node CurrentVersion Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\Software\Wow6432Node\Classes") && (TargetObject.includes("\Folder\ShellEx\ExtShellFolderViews")
    || TargetObject.includes("\Folder\ShellEx\DragDropHandlers") || TargetObject.includes("\Folder\ShellEx\ColumnHandlers")
    || TargetObject.includes("\Directory\Shellex\DragDropHandlers") || TargetObject.includes("\Directory\Shellex\CopyHookHandlers")
    || TargetObject.includes("\CLSID\{AC757296-3522-4E11-9862-C17BE5A1767E}\Instance")
    || TargetObject.includes("\CLSID\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\Instance")
    || TargetObject.includes("\CLSID\{7ED96837-96F0-4812-B211-F13C24117ED3}\Instance")
    || TargetObject.includes("\CLSID\{083863F1-70DE-11d0-BD40-00A0C911CE86}\Instance")
    || TargetObject.includes("\AllFileSystemObjects\ShellEx\DragDropHandlers") ||
    TargetObject.includes("\ShellEx\PropertySheetHandlers") || TargetObject.includes("\ShellEx\ContextMenuHandlers")))
    &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"18f2065c-d36c-464a-a748-bcf909acb2e3_sysmon_ot"'
  description: Wow6432Node Classes Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion")
    && (TargetObject.includes("\Windows\Appinit_Dlls") || TargetObject.includes("\Image
    File Execution Options") || TargetObject.includes("\Drivers32"))) &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"480421f9-417f-4d3b-9552-fd2728443ec8_sysmon_ot"'
  description: Wow6432Node CurrentVersion Autorun Keys Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6ea3bf32-9680-422d-9f50-e90716b12a66_sysmon_ot"'
  description: UAC Bypass Via Wsreset
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\cmmgr32.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b6d235fc-1d38-4b12-adbe-325f06728f37_sysmon_ot"'
  description: CMSTP Execution Registry Event
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("HKLM\System\CurrentControlSet\Services")) && ((Details.includes("ADMIN$")
    && Details.includes(".exe")) || (Details.includes("%COMSPEC%") && Details.includes("start")
    && Details.includes("powershell"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"61a7697c-cb79-42a8-a2ff-5f0cdfae0130_sysmon_ot"'
  description: CobaltStrike Service Installations in Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject=="HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"07743f65-7ec9-404a-a519-913db7118a8d_sysmon_ot"'
  description: COM Hijack via Sdclt
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.startsWith("HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports")
    && (Details.includes(".dll") || Details.includes(".exe") || Details.includes(".bat")
    || Details.includes(".com") || Details.includes("C:")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7ec912f2-5175-4868-b811-ec13ad0f8567_sysmon_ot"'
  description: Suspicious New Printer Ports in Registry (CVE-2020-1048)
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("\Services\DHCPServer\Parameters\CalloutDlls")
    || TargetObject.endsWith("\Services\DHCPServer\Parameters\CalloutEnabled")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9d3436ef-9476-4c43-acca-90ce06bdf33a_sysmon_ot"'
  description: DHCP Callout DLL Installation
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security
    Center\App and Browser protection\DisallowExploitProtectionOverride") && Details=="DWORD
    (00000001)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bf9e1387-b040-4393-9851-1598f8ecfae9_sysmon_ot"'
  description: Disable Exploit Guard Network Protection on Windows Defender
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\PUAProtection")
    && Details=="DWORD (0x00000000)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"8ffc5407-52e3-478f-9596-0a7371eafe13_sysmon_ot"'
  description: Disable PUA Protection on Windows Defender
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("HKLM\SOFTWARE\Microsoft\Windows Defender\Features\TamperProtection")
    && Details=="DWORD (0)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"93d298a1-d28f-47f1-a468-d971e7796679_sysmon_ot"'
  description: Disable Tamper Protection on Windows Defender
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("\SOFTWARE\Microsoft\Office\\") && (TargetObject.endsWith("VBAWarnings")
    || TargetObject.endsWith("DisableInternetFilesInPV") || TargetObject.endsWith("DisableUnsafeLocationsInPV")
    || TargetObject.endsWith("DisableAttachementsInPV")) && Details=="DWORD (0x00000001)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"7c637634-c95d-4bbf-b26c-a82510874b34_sysmon_ot"'
  description: Disable Microsoft Office Security Features
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((TargetObject=="HKLM\SYSTEM\CurrentControlSet\Control\MiniNt"
    && EventType=="CreateKey") || NewName=="HKLM\SYSTEM\CurrentControlSet\Control\MiniNt"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"919f2ef0-be2d-4a7a-b635-eb2b41fde044_sysmon_ot"'
  description: Disable Security Events Logging Adding Reg Key MiniNt
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("\IsCredGuardEnabled"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1a2d6c47-75b0-45bd-b133-2c0be75349fd_sysmon_ot"'
  description: Wdigest CredGuard Registry Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && ((TargetObject.endsWith("\SOFTWARE\Policies\Microsoft\Edge\BuiltInDnsClientEnabled")
    && Details=="DWORD (1)") || (TargetObject.endsWith("\SOFTWARE\Google\Chrome\DnsOverHttpsMode")
    && Details=="DWORD (secure)") || (TargetObject.endsWith("\SOFTWARE\Policies\Mozilla\Firefox\DNSOverHTTPS\Enabled")
    && Details=="DWORD (1)")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"04b45a8a-d11d-49e4-9acc-4a1b524407a5_sysmon_ot"'
  description: DNS-over-HTTPS Enabled by Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("\COR_ENABLE_PROFILING")
    || TargetObject.endsWith("\COR_PROFILER")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ad89044a-8f49-4673-9a55-cbd88a1b374f_sysmon_ot"'
  description: Enabling COR Profiler Environment Variables
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("System\CurrentControlSet\Services\VSS")
    && Image.endsWith("esentutl.exe")) &&  ! (TargetObject.includes("System\CurrentControlSet\Services\VSS\Start")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5aad0995-46ab-41bd-a9ff-724f41114971_sysmon_ot"'
  description: Esentutl Volume Shadow Copy Service Keys
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.endsWith("SOFTWARE\Microsoft\.NETFramework\ETWEnabled") && Details=="DWORD
    (0x00000000)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bf4fc428-dcc3-4bbd-99fe-2422aeee2544_sysmon_ot"'
  description: COMPlus_ETWEnabled Registry Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("Services\WCESERVICE\Start"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a6b33c02-8305-488f-8585-03cb2a7763f2_sysmon_ot"'
  description: Windows Credential Editor Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("\Services\HybridConnectionManager")
    || (EventType=="SetValue" && Details.includes("Microsoft.HybridConnectionManager.Listener.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ac8866c7-ce44-46fd-8c17-b24acff96ca8_sysmon_ot"'
  description: HybridConnectionManager Service Installation
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("UserInitMprLogonScript"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9ace0707-b560-49b8-b6ca-5148b42f39fb_sysmon_ot"'
  description: Logon Scripts (UserInitMprLogonScript) Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("\Control
    Panel\Desktop\SCRNSAVE.EXE") &&  ! ((Image.endsWith("\rundll32.exe") || Image.endsWith("\explorer.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"67a6c006-3fbe-46a7-9074-2ba3b82c3000_sysmon_ot"'
  description: Path To Screensaver Binary Modified
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((EventType=="DeleteValue"
    && TargetObject.endsWith("\AppXypsaf9f1qserqevf0sws76dx4k9a5206\Shell\open\command\DelegateExecute"))
    || TargetObject.endsWith("\AppXypsaf9f1qserqevf0sws76dx4k9a5206\Shell\open\command\(Default)")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f663a6d9-9d1b-49b8-b2b1-0637914d199a_sysmon_ot"'
  description: Narrator's Feedback-Hub Persistence
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\AppCompatFlags\Compatibility
    Assistant\Store\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"60936b49-fca0-4f32-993d-7415edcf9a5d_sysmon_ot"'
  description: New Application in AppCompat
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject=="HKLM\SYSTEM\CurrentControlSet\Control\Session
    Manager\AppCertDlls" || NewName=="HKLM\SYSTEM\CurentControlSet\Control\Session
    Manager\AppCertDlls"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"6aa1d992-5925-4e9f-a49b-845e51d1de01_sysmon_ot"'
  description: New DLL Added to AppCertDlls Registry Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Windows\AppInit_Dlls") || TargetObject.endsWith("\SOFTWARE\Wow6432Node\Microsoft\Windows
    NT\CurrentVersion\Windows\AppInit_Dlls")) || (NewName.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Windows\AppInit_Dlls") || NewName.endsWith("\SOFTWARE\Wow6432Node\Microsoft\Windows
    NT\CurrentVersion\Windows\AppInit_Dlls"))) &&  ! (Details=="(Empty)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4f84b697-c9ed-4420-8ab5-e09af5b2345d_sysmon_ot"'
  description: New DLL Added to AppInit_DLLs Registry Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject=="HKCU\Software\Microsoft\Office
    test\Special\Perf" || TargetObject=="HKLM\Software\Microsoft\Office test\Special\Perf"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"3d27f6dd-1c74-4687-b4fa-ca849d128d1c_sysmon_ot"'
  description: Office Application Startup - Office Test
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && (TargetObject.includes("\Software\Microsoft\Office\Outlook\Addins\\") || TargetObject.includes("\Software\Microsoft\Office\Word\Addins\\")
    || TargetObject.includes("\Software\Microsoft\Office\Excel\Addins\\") || TargetObject.includes("\Software\Microsoft\Office\Powerpoint\Addins\\")
    || TargetObject.includes("\Software\Microsoft\VSTO\Security\Inclusion\\"))) &&  !
    (Image.endsWith("\msiexec.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9d15044a-7cfe-4d23-8085-6ebc11df7685_sysmon_ot"'
  description: Stealthy VSTO Persistence
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("\Services\\") && TargetObject.endsWith("\ImagePath")
    && (Details.includes("powershell") || Details.includes("pwsh")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4a5f5a5e-ac01-474b-9b4e-d61298c9df1d_sysmon_ot"'
  description: PowerShell as a Service in Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && (TargetObject.endsWith("\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\UserAuthentication")
    || TargetObject.endsWith("\CurrentControlSet\Control\Terminal Server\fDenyTSConnections"))
    && Details=="DWORD (0x00000000)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"41904ebe-d56c-4904-b9ad-7a77bdf154b3_sysmon_ot"'
  description: RDP Registry Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("\services\TermService\Parameters\ServiceDll")
    || TargetObject.includes("\Control\Terminal Server\fSingleSessionPerUser") ||
    TargetObject.includes("\Control\Terminal Server\fDenyTSConnections") || TargetObject.includes("\Policies\Microsoft\Windows
    NT\Terminal Services\Shadow") || TargetObject.includes("\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"171b67e1-74b4-460e-8d55-b331f3e32d67_sysmon_ot"'
  description: RDP Sensitive Settings Changed
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("HKLM\SOFTWARE\Microsoft\HTMLHelp\data"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5b175490-b652-4b02-b1de-5b5b4083c5f8_sysmon_ot"'
  description: RedMimicry Winnti Playbook Registry Manipulation
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.startsWith("HKLM\SAM\SAM\Domains\Account\Users\Names\\")
    && TargetObject.endsWith("$") && Image.endsWith("lsass.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"460479f3-80b7-42da-9c43-2cc1d54dbccd_sysmon_ot"'
  description: Creation of a Local Hidden User Account by Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="CreateKey"
    && TargetObject.includes("HKU\\") && TargetObject.includes("Classes\CLSID\\")
    && TargetObject.includes("\TreatAs"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9b0f8a61-91b2-464f-aceb-0527e0a45020_sysmon_ot"'
  description: Windows Registry Persistence COM Key Linking
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && (TargetObject.startsWith("HKCR\CLSID\\") || TargetObject.startsWith("HKCU\Software\Classes\CLSID\\"))
    && TargetObject.endsWith("\InprocServer32\(Default)")) &&  ! (((Details.includes("%%systemroot%%\system32\\")
    || Details.includes("%%systemroot%%\SysWow64\\"))) || ((Details.includes("\AppData\Local\Microsoft\OneDrive\\")
    || Details.includes("\FileCoAuthLib64.dll") || Details.includes("\FileSyncShell64.dll")
    || Details.includes("\FileSyncApi64.dll"))) || (Details.includes("\AppData\Local\Microsoft\TeamsMeetingAddin\\")
    && Details.includes("\Microsoft.Teams.AddinLoader.dll")) || (Details.includes("\AppData\Roaming\Dropbox\\")
    && Details.includes("\DropboxExt64.*.dll")) || (Details.endsWith("TmopIEPlg.dll"))
    || ((Image=="C:\WINDOWS\system32\wuauclt.exe" || Image=="C:\WINDOWS\system32\svchost.exe"))
    || (Image.includes("C:\ProgramData\Microsoft\Windows Defender\Platform\\") &&
    Image.includes("\MsMpEng.exe")) || ((Details.includes("\FileRepository\nvmdi.inf")))
    || (Image.includes("C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\{") &&
    Image.includes("\setup.exe") || Image.endsWith("\MicrosoftEdgeUpdateComRegisterShell64.exe"))
    || (Image=="C:\WINDOWS\SYSTEM32\dxdiag.exe")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a0ff33d8-79e4-4cef-b4f3-9dc4133ccd12_sysmon_ot"'
  description: Windows Registry Persistence COM Search Order Hijacking
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("\Control\Print\Environments\Windows x64\Drivers") &&
    TargetObject.includes("\Manufacturer") && Details=="(Empty)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e0813366-0407-449a-9869-a2db1119dc41_sysmon_ot"'
  description: Suspicious Printer Driver Empty Manufacturer
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("TrustRecords"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"295a59c1-7b79-4b47-a930-df12c15fc9c2_sysmon_ot"'
  description: Windows Registry Trust Record Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("\Security\Trusted
    Documents\TrustRecords") || TargetObject.endsWith("\Security\AccessVBOM") || TargetObject.endsWith("\Security\VBAWarnings")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd_sysmon_ot"'
  description: Office Security Settings Changed
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("Microsoft\Windows NT\CurrentVersion\SilentProcessExit")
    && Details.includes("MonitorProcess"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c81fe886-cac0-4913-a511-2822d72ff505_sysmon_ot"'
  description: SilentProcessExit Monitor Registrytion
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("Microsoft\Windows
    NT\CurrentVersion\SilentProcessExit\lsass.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"55e29995-75e7-451a-bef0-6225e2f13597_sysmon_ot"'
  description: SilentProcessExit Monitor Registrytion for LSASS
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("Software\Microsoft\Windows\CurrentVersion") && (Details.includes("vbscript")
    || Details.includes("jscript") || Details.includes("mshtml") || Details.includes("mshtml,")
    || Details.includes("mshtml ") || Details.includes("RunHTMLApplication") || Details.includes("Execute(")
    || Details.includes("CreateObject") || Details.includes("RegRead") || Details.includes("window.close")))
    &&  ! (TargetObject.includes("Software\Microsoft\Windows\CurrentVersion\Run")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"46490193-1b22-4c29-bdd6-5bf63907216f_sysmon_ot"'
  description: VBScript Payload Stored in Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="DeleteKey"
    && (TargetObject.endsWith("{2781761E-28E0-4109-99FE-B9D127C57AFE}") || TargetObject.endsWith("{A7C452EF-8E9F-42EB-9F2B-245613CA0DC9}")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"41d1058a-aea7-4952-9293-29eaaf516465_sysmon_ot"'
  description: Removal Amsi Provider Reg Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="DeleteKey"
    && TargetObject.endsWith("\shell\open\command"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"96f697b0-b499-4e5d-9908-a67bec11cdb6_sysmon_ot"'
  description: Removal of Potential COM Hijacking Registry Keys
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("Software\Microsoft\Windows\CurrentVersion\Run\Backup
    Mgr")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b98968aa-dbc0-4a9c-ac35-108363cbf8d5_sysmon_ot"'
  description: WINEKEY Registry Modification
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.startsWith("HKLM\SOFTWARE\Microsoft\Active
    Setup\Installed Components") && TargetObject.endsWith("\StubPath"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c74d7efc-8826-45d9-b8bb-f04fac9e4eff_sysmon_ot"'
  description: Run Once Task Configuration in Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject=="HKLM\System\CurrentControlSet\Control\Lsa\Security
    Packages" || TargetObject=="HKLM\System\CurrentControlSet\Control\Lsa\OSConfig\Security
    Packages") &&  ! (Image=="C:\Windows\system32\msiexec.exe" || Image=="C:\Windows\syswow64\MsiExec.exe"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"eeb30123-9fbd-4ee8-aaa0-2e545bbed6dc_sysmon_ot"'
  description: Security Support Provider (SSP) Added to LSA Configuration
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && (TargetObject.includes("\Keyboard Layout\Preload\\") || TargetObject.includes("\Keyboard
    Layout\Substitutes\\")) && (Details.includes("00000429") || Details.includes("00050429")
    || Details.includes("0000042a")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"34aa0252-6039-40ff-951f-939fd6ce47d8_sysmon_ot"'
  description: Suspicious Keyboard Layout Load
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("Software\Microsoft\Windows
    NT\CurrentVersion\Accessibility\ATs") || TargetObject.includes("Software\Microsoft\Windows
    NT\CurrentVersion\Accessibility\Configuration")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9577edbb-851f-4243-8c91-1d5b50c1a39b_sysmon_ot"'
  description: Atbroker Registry Change
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (Image.includes("\Downloads\\")
    || Image.includes("\Temporary Internet Files\Content.Outlook\\") || Image.includes("\Local
    Settings\Temporary Internet Files\\")) && TargetObject.includes("\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9c5037d1-c568-49b3-88c7-9846a5bdc2be_sysmon_ot"'
  description: Suspicious Run Key from Download
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("\CurrentControlSet\Services\NTDS\DirectoryServiceExtPt")
    || TargetObject.includes("\CurrentControlSet\Services\NTDS\LsaDbExtPt")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b3503044-60ce-4bf4-bbcb-e3db98788823_sysmon_ot"'
  description: DLL Load via LSASS
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\\")
    && TargetObject.includes("\NonPackaged") && (TargetObject.includes("microphone")
    || TargetObject.includes("webcam")) && (TargetObject.includes(":#Windows#Temp#")
    || TargetObject.includes(":#$Recycle.bin#") || TargetObject.includes(":#Temp#")
    || TargetObject.includes(":#Users#Public#") || TargetObject.includes(":#Users#Default#")
    || TargetObject.includes(":#Users#Desktop#")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"62120148-6b7a-42be-8b91-271c04e281a3_sysmon_ot"'
  description: Suspicious Camera and Microphone Access
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.endsWith("\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"))
    && ((Details.startsWith("C:\Windows\Temp\\") || Details.startsWith("C:\ProgramData\\")
    || Details.startsWith("C:\$Recycle.bin\\") || Details.startsWith("C:\Temp\\")
    || Details.startsWith("C:\Users\Public\\") || Details.startsWith("C:\Users\Default\\"))
    || (Details.includes("\AppData\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b7916c2a-fa2f-4795-9477-32b731f70f11_sysmon_ot"'
  description: Registry Persistence via Explorer Run Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && (TargetObject.includes("\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\\")
    || TargetObject.includes("\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce\\")))
    && ((Details.includes("C:\Windows\Temp\\") || Details.includes("C:\$Recycle.bin\\")
    || Details.includes("C:\Temp\\") || Details.includes("C:\Users\Public\\") || Details.includes("C:\Users\Default\\")
    || Details.includes("C:\Users\Desktop\\") || Details.includes("\AppData\Local\Temp\\"))
    || (Details.startsWith("%Public%\\") || Details.startsWith("wscript") || Details.startsWith("cscript"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"02ee49e2-e294-4d0f-9278-f5b3212fc588_sysmon_ot"'
  description: New RUN Key Pointing to Suspicious Folder
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((EventType=="SetValue"
    && (TargetObject=="HKLM\System\CurrentControlSet\Services\NalDrv\ImagePath" ||
    TargetObject=="HKLM\System\CurrentControlSet\Services\PROCEXP152\ImagePath"))
    &&  ! ((Image.endsWith("\procexp64.exe") || Image.endsWith("\procexp.exe") ||
    Image.endsWith("\procmon64.exe") || Image.endsWith("\procmon.exe")))) &&  ! ((Details.includes("\WINDOWS\system32\Drivers\PROCEXP152.SYS"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"f2485272-a156-4773-82d7-1d178bc4905b_sysmon_ot"'
  description: Suspicious Service Installed
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\Software\Sysinternals\SDelete"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"9841b233-8df8-4ad7-9133-b0b4402a9014_sysmon_ot"'
  description: Sysinternals SDelete Registry Keys
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\\"))
    &&  ! (((TargetObject.includes("Microsoft\Windows\UpdateOrchestrator") || TargetObject.includes("Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask\Index")
    || TargetObject.includes("Microsoft\Windows\Flighting\OneSettings\RefreshCache\Index")))
    || (Image=="C:\WINDOWS\system32\svchost.exe" && (TargetObject.includes("Microsoft\Windows\WindowsUpdate\Scheduled
    Start\Index") || TargetObject.includes("Microsoft\Windows\PushToInstall\Registration\Index")
    || TargetObject.includes("Microsoft\Windows\GroupPolicy\{*}\Index")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"4720b7df-40c3-48fd-bbdf-fd4b3c464f0d_sysmon_ot"'
  description: New TaskCache Entry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.endsWith("Software\Classes\exefile\shell\runas\command\isolatedCommand")
    || (EventType=="SetValue" && TargetObject.endsWith("Software\Classes\Folder\shell\open\command\SymbolicLinkValue")
    && Details.includes("-1???\Software\Classes\\"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5b872a46-3b90-45c1-8419-f675db8053aa_sysmon_ot"'
  description: UAC Bypass via Sdclt
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.endsWith("\Software\Microsoft\WAB\DLLPath")) &&  ! (Details=="%CommonProgramFiles%\System\wab32.dll"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fc014922-5def-4da9-a0fc-28c973f41bfb_sysmon_ot"'
  description: Execution DLL of Choice Using WAB.EXE
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("WDigest\UseLogonCredential"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"d6a9b252-c666-4de6-8806-5561bbbd3bdc_sysmon_ot"'
  description: Wdigest Enable UseLogonCredential
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion")) && ((TargetObject.includes("\Image File Execution Options\\")
    && TargetObject.includes("\GlobalFlag")) || (TargetObject.includes("SilentProcessExit\\")
    && TargetObject.includes("\ReportingMode")) || (TargetObject.includes("SilentProcessExit\\")
    && TargetObject.includes("\MonitorProcess"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"36803969-5421-41ec-b92f-8500f79c23b0_sysmon_ot"'
  description: Registry Persistence Mechanisms
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((EventType=="RenameKey"
    && NewName=="HKCR\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open") ||
    (EventType=="SetValue" && TargetObject=="HKCR\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}\shell\open\command\(Default)")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"277efb8f-60be-4f10-b4d3-037802f37167_sysmon_ot"'
  description: Registry Persistence Mechanisms in Recycle Bin
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.includes("\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\TelemetryController\\")
    && TargetObject.includes("\Command") && Details.includes(".exe")) &&  ! ((Details.includes("\system32\CompatTelRunner.exe")
    || Details.includes("\system32\DeviceCensus.exe"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"73a883d0-0348-4be4-a8d8-51031c2564f8_sysmon_ot"'
  description: Registry Persistence Mechanism via Windows Telemetry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject=="HKCU\Software\Microsoft\Office\16.0\Outlook\Security\Level"
    && Details.includes("0x00000001"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"e3b50fa5-3c3f-444e-937b-0a99d33731cd_sysmon_ot"'
  description: Outlook C2 Registry Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("Software\Microsoft\Office\\")
    || TargetObject.includes("\Outlook\Today\\")) && ((EventType=="SetValue" && TargetObject.endsWith("Stamp")
    && Details=="DWORD (0x00000001)") || TargetObject.endsWith("UserDefinedUrl")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"487bb375-12ef-41f6-baae-c6a1572b4dd1_sysmon_ot"'
  description: Persistent Outlook Landing Pages
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (TargetObject.includes("Software\Microsoft\Office\\")
    || TargetObject.includes("Outlook\WebView\\")) && TargetObject.endsWith("URL")
    && (TargetObject.includes("Calendar") || TargetObject.includes("Inbox")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ddd171b5-2cc6-4975-9e78-f0eccd08cc76_sysmon_ot"'
  description: Persistent Outlook Landing Pages
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject=="HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4\tcp")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"a54f842a-3713-4b45-8c84-5f136fdebd3c_sysmon_ot"'
  description: PortProxy Registry Key
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("Classes\.")
    && Details=="exefile" && EventType=="SetValue")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"44a22d59-b175-4f13-8c16-cbaef5b581ff_sysmon_ot"'
  description: New File Association Using Exefile
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (((TargetObject.includes("\Control\Print\Environments\Windows
    x64\Drivers\Version-3\QMS 810\\") || TargetObject.includes("\Control\Print\Environments\Windows
    x64\Drivers\Version-3\mimikatz")) || (TargetObject.includes("legitprinter") &&
    TargetObject.includes("\Control\Print\Environments\Windows"))) || ((TargetObject.includes("\Control\Print\Environments")
    || TargetObject.includes("\CurrentVersion\Print\Printers")) && (TargetObject.includes("Gentil
    Kiwi") || TargetObject.includes("mimikatz printer") || TargetObject.includes("Kiwi
    Legit Printer")))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"ba6b9e43-1d45-4d3c-a504-1043a64c8469_sysmon_ot"'
  description: PrinterNightmare Mimimkatz Driver Name
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (((EventType=="SetValue"
    && TargetObject.endsWith("Classes\ms-settings\shell\open\command\SymbolicLinkValue")
    && Details.includes("\Software\Classes\{")) || TargetObject.endsWith("Classes\ms-settings\shell\open\command\DelegateExecute"))
    || ((EventType=="SetValue" && (TargetObject.endsWith("Classes\ms-settings\shell\open\command\(Default)")
    || TargetObject.endsWith("Classes\exefile\shell\open\command\(Default)"))) &&  !
    (Details=="(Empty)"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"152f3630-77c1-4284-bcc0-4cc68ab2f6e7_sysmon_ot"'
  description: Shell Open Registry Keys Manipulation
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.startsWith("HKLM\System\CurrentControlSet\Control\Print\Monitors\\")
    && Details.endsWith(".dll") && EventType=="SetValue")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"944e8941-f6f6-4ee8-ac05-1c224e923c0e_sysmon_ot"'
  description: Add Port Monitor Persistence in Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.endsWith("\open\command\DelegateExecute") && Details=="(Empty)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"46dd5308-4572-4d12-aa43-8938f0184d4f_sysmon_ot"'
  description: Bypass UAC Using DelegateExecute
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject.endsWith("_Classes\mscfile\shell\open\command\(Default)")) &&  !
    (Details.startsWith("%SystemRoot%\system32\mmc.exe "%1" %")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"674202d0-b22a-4af4-ae5f-2eda1f3da1af_sysmon_ot"'
  description: Bypass UAC Using Event Viewer
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("\Environment\windir")
    && Details.includes("&REM") && EventType=="SetValue")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"724ea201-6514-4f38-9739-e5973c34f49a_sysmon_ot"'
  description: Bypass UAC Using SilentCleanup Task
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && (EventType=="SetValue"
    && TargetObject=="HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\PortNumber")
    &&  ! (Details=="DWORD (0x00000d3d)"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"509e84b9-a71a-40e0-834f-05470369bd1e_sysmon_ot"'
  description: Changing RDP Port to Non Standard Number
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.includes("\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet
    Settings\ZoneMap\Domains\\"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"45e112d0-7759-4c2a-aa36-9f8fb79d3393_sysmon_ot"'
  description: IE Change Domain Zone
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("Software\Wow6432Node\Google\Chrome\Extensions")
    && TargetObject.endsWith("update_url") && EventType=="SetValue" && (TargetObject.includes("fdcgdnkidjaadafnichfpabhfomcebme")
    || TargetObject.includes("fcfhplploccackoneaefokcmbjfbkenj") || TargetObject.includes("bihmplhobchoageeokmgbdihknkjbknd")
    || TargetObject.includes("gkojfkhlekighikafcpjkiklfbnlmeio") || TargetObject.includes("jajilbjjinjmgcibalaakngmkilboobh")
    || TargetObject.includes("gjknjjomckknofjidppipffbpoekiipm") || TargetObject.includes("nabbmpekekjknlbkgpodfndbodhijjem")
    || TargetObject.includes("kpiecbcckbofpmkkkdibbllpinceiihk") || TargetObject.includes("nlbejmccbhkncgokjcmghpfloaajcffj")
    || TargetObject.includes("omghfjlpggmjjaagoclmmobgdodcjboh") || TargetObject.includes("bibjcjfmgapbfoljiojpipaooddpkpai")
    || TargetObject.includes("mpcaainmfjjigeicjnlkdfajbioopjko") || TargetObject.includes("jljopmgdobloagejpohpldgkiellmfnc")
    || TargetObject.includes("lochiccbgeohimldjooaakjllnafhaid") || TargetObject.includes("nhnfcgpcbfclhfafjlooihdfghaeinfc")
    || TargetObject.includes("ookhnhpkphagefgdiemllfajmkdkcaim") || TargetObject.includes("namfblliamklmeodpcelkokjbffgmeoo")
    || TargetObject.includes("nbcojefnccbanplpoffopkoepjmhgdgh") || TargetObject.includes("majdfhpaihoncoakbjgbdhglocklcgno")
    || TargetObject.includes("lnfdmdhmfbimhhpaeocncdlhiodoblbd") || TargetObject.includes("eppiocemhmnlbhjplcgkofciiegomcon")
    || TargetObject.includes("cocfojppfigjeefejbpfmedgjbpchcng") || TargetObject.includes("foiopecknacmiihiocgdjgbjokkpkohc")
    || TargetObject.includes("hhdobjgopfphlmjbmnpglhfcgppchgje") || TargetObject.includes("jgbaghohigdbgbolncodkdlpenhcmcge")
    || TargetObject.includes("inligpkjkhbpifecbdjhmdpcfhnlelja") || TargetObject.includes("higioemojdadgdbhbbbkfbebbdlfjbip")
    || TargetObject.includes("hipncndjamdcmphkgngojegjblibadbe") || TargetObject.includes("iolonopooapdagdemdoaihahlfkncfgg")
    || TargetObject.includes("nhfjkakglbnnpkpldhjmpmmfefifedcj") || TargetObject.includes("jpgljfpmoofbmlieejglhonfofmahini")
    || TargetObject.includes("fgddmllnllkalaagkghckoinaemmogpe") || TargetObject.includes("ejkaocphofnobjdedneohbbiilggdlbi")
    || TargetObject.includes("keodbianoliadkoelloecbhllnpiocoi") || TargetObject.includes("hoapmlpnmpaehilehggglehfdlnoegck")
    || TargetObject.includes("poeojclicodamonabcabmapamjkkmnnk") || TargetObject.includes("dfkdflfgjdajbhocmfjolpjbebdkcjog")
    || TargetObject.includes("kcdahmgmaagjhocpipbodaokikjkampi") || TargetObject.includes("klnkiajpmpkkkgpgbogmcgfjhdoljacg")
    || TargetObject.includes("lneaocagcijjdpkcabeanfpdbmapcjjg") || TargetObject.includes("pgfpignfckbloagkfnamnolkeaecfgfh")
    || TargetObject.includes("jplnlifepflhkbkgonidnobkakhmpnmh") || TargetObject.includes("jliodmnojccaloajphkingdnpljdhdok")
    || TargetObject.includes("hnmpcagpplmpfojmgmnngilcnanddlhb") || TargetObject.includes("ffbkglfijbcbgblgflchnbphjdllaogb")
    || TargetObject.includes("kcndmbbelllkmioekdagahekgimemejo") || TargetObject.includes("jdgilggpfmjpbodmhndmhojklgfdlhob")
    || TargetObject.includes("bihhflimonbpcfagfadcnbbdngpopnjb") || TargetObject.includes("ppajinakbfocjfnijggfndbdmjggcmde")
    || TargetObject.includes("oofgbpoabipfcfjapgnbbjjaenockbdp") || TargetObject.includes("bhnhkdgoefpmekcgnccpnhjfdgicfebm")
    || TargetObject.includes("knmmpciebaoojcpjjoeonlcjacjopcpf") || TargetObject.includes("dhadilbmmjiooceioladdphemaliiobo")
    || TargetObject.includes("jedieiamjmoflcknjdjhpieklepfglin") || TargetObject.includes("mhngpdlhojliikfknhfaglpnddniijfh")
    || TargetObject.includes("omdakjcmkglenbhjadbccaookpfjihpa") || TargetObject.includes("npgimkapccfidfkfoklhpkgmhgfejhbj")
    || TargetObject.includes("akeehkgglkmpapdnanoochpfmeghfdln") || TargetObject.includes("gbmdmipapolaohpinhblmcnpmmlgfgje")
    || TargetObject.includes("aigmfoeogfnljhnofglledbhhfegannp") || TargetObject.includes("cgojmfochfikphincbhokimmmjenhhgk")
    || TargetObject.includes("ficajfeojakddincjafebjmfiefcmanc") || TargetObject.includes("ifnaibldjfdmaipaddffmgcmekjhiloa")
    || TargetObject.includes("jbnmpdkcfkochpanomnkhnafobppmccn") || TargetObject.includes("apcfdffemoinopelidncddjbhkiblecc")
    || TargetObject.includes("mjolnodfokkkaichkcjipfgblbfgojpa") || TargetObject.includes("oifjbnnafapeiknapihcmpeodaeblbkn")
    || TargetObject.includes("plpmggfglncceinmilojdkiijhmajkjh") || TargetObject.includes("mjnbclmflcpookeapghfhapeffmpodij")
    || TargetObject.includes("bblcccknbdbplgmdjnnikffefhdlobhp") || TargetObject.includes("aojlhgbkmkahabcmcpifbolnoichfeep")
    || TargetObject.includes("lcmammnjlbmlbcaniggmlejfjpjagiia") || TargetObject.includes("knajdeaocbpmfghhmijicidfcmdgbdpm")
    || TargetObject.includes("bdlcnpceagnkjnjlbbbcepohejbheilk") || TargetObject.includes("edknjdjielmpdlnllkdmaghlbpnmjmgb")
    || TargetObject.includes("eidnihaadmmancegllknfbliaijfmkgo") || TargetObject.includes("ckiahbcmlmkpfiijecbpflfahoimklke")
    || TargetObject.includes("macdlemfnignjhclfcfichcdhiomgjjb") || TargetObject.includes("chioafkonnhbpajpengbalkececleldf")
    || TargetObject.includes("amnoibeflfphhplmckdbiajkjaoomgnj") || TargetObject.includes("llbhddikeonkpbhpncnhialfbpnilcnc")
    || TargetObject.includes("pcienlhnoficegnepejpfiklggkioccm") || TargetObject.includes("iocnglnmfkgfedpcemdflhkchokkfeii")
    || TargetObject.includes("igahhbkcppaollcjeaaoapkijbnphfhb") || TargetObject.includes("njpmifchgidinihmijhcfpbdmglecdlb")
    || TargetObject.includes("ggackgngljinccllcmbgnpgpllcjepgc") || TargetObject.includes("kchocjcihdgkoplngjemhpplmmloanja")
    || TargetObject.includes("bnijmipndnicefcdbhgcjoognndbgkep") || TargetObject.includes("lklekjodgannjcccdlbicoamibgbdnmi")
    || TargetObject.includes("dbdbnchagbkhknegmhgikkleoogjcfge") || TargetObject.includes("egblhcjfjmbjajhjhpmnlekffgaemgfh")
    || TargetObject.includes("ehbhfpfdkmhcpaehaooegfdflljcnfec") || TargetObject.includes("bkkgdjpomdnfemhhkalfkogckjdkcjkg")
    || TargetObject.includes("almalgbpmcfpdaopimbdchdliminoign") || TargetObject.includes("akkbkhnikoeojlhiiomohpdnkhbkhieh")
    || TargetObject.includes("gbfgfbopcfokdpkdigfmoeaajfmpkbnh") || TargetObject.includes("bniikohfmajhdcffljgfeiklcbgffppl")
    || TargetObject.includes("lejgfmmlngaigdmmikblappdafcmkndb") || TargetObject.includes("ffhhkmlgedgcliajaedapkdfigdobcif")
    || TargetObject.includes("gcknhkkoolaabfmlnjonogaaifnjlfnp") || TargetObject.includes("pooljnboifbodgifngpppfklhifechoe")
    || TargetObject.includes("fjoaledfpmneenckfbpdfhkmimnjocfa") || TargetObject.includes("aakchaleigkohafkfjfjbblobjifikek")
    || TargetObject.includes("dpplabbmogkhghncfbfdeeokoefdjegm") || TargetObject.includes("padekgcemlokbadohgkifijomclgjgif")
    || TargetObject.includes("bfidboloedlamgdmenmlbipfnccokknp")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"b64a026b-8deb-4c1d-92fd-98893209dff1_sysmon_ot"'
  description: Running Chrome VPN Extensions via the Registry 2 VPN Extension
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.startsWith("HKLM\System\CurrentControlSet\Services\LanmanServer\Parameters\\")
    && (TargetObject.endsWith("AutoShareWks") || TargetObject.endsWith("AutoShareServer"))
    && Details=="DWORD (0x00000000)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c7dcacd0-cc59-4004-b0a4-1d6cdebe6f3e_sysmon_ot"'
  description: Disable Administrative Share Creation at Startup
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject.startsWith("HKLM\System\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\\")
    && TargetObject.endsWith("\EnableFirewall") && Details=="DWORD (0x00000000)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"974515da-6cc5-4c95-ae65-f97f9150ec7f_sysmon_ot"'
  description: Disable Microsoft Defender Firewall via Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && TargetObject=="HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA"
    && Details=="DWORD (0x00000000)")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"48437c39-9e5f-47fb-af95-3d663c3f2919_sysmon_ot"'
  description: Disable UAC Using Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && EventType=="SetValue"
    && ((TargetObject.endsWith("\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt")
    && Details=="DWORD (0x00000001)") || (TargetObject.endsWith("\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Hidden")
    && Details=="DWORD (0x00000002)")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"5df86130-4e95-4a54-90f7-26541b40aec2_sysmon_ot"'
  description: Registry Modification to Hidden File Extension
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.includes("\SOFTWARE\Microsoft\Office\\")
    && TargetObject.includes("\Outlook\Security\\") && EventType=="SetValue")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"c3cefdf4-6703-4e1c-bad8-bf422fc5015a_sysmon_ot"'
  description: Change Outlook Security Setting in Registry
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && ((TargetObject.startsWith("HKLM\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\AppCompatFlags\InstalledSDB\\") || TargetObject.startsWith("HKLM\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\AppCompatFlags\Custom\\")) && EventType=="SetValue") &&  ! (Details==""))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"dfb5b4e8-91d0-4291-b40a-e3b0d3942c45_sysmon_ot"'
  description: Registry Key Creation or Modification for Shim DataBase
- id: eval
  filter: ((EventID=="12" || EventID=="13" || EventID=="14") && TargetObject.endsWith("\SOFTWARE\Microsoft\Windows
    NT\CurrentVersion\Winlogon\Notify\logon") && Details.endsWith(".dll") && EventType=="SetValue")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"bbf59793-6efb-4fa1-95ca-a7d288e52c88_sysmon_ot"'
  description: Winlogon Notify Key Logon Persistence
- id: eval
  filter: '(EventID=="255" && (Description.includes("Failed to open service configuration
    with error") || Description.includes("Failed to connect to the driver to update
    configuration")) &&  ! (Description=="Failed to open service configuration with
    error 19 - Last error: The media is write protected."))'
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"815cd91b-7dbc-4247-841a-d7dd1392b0a8_sysmon_ot"'
  description: Sysmon Configuration Error
- id: eval
  filter: ((EventID=="4" || EventID=="16") && (State=="Stopped" || "Sysmon config
    state changed"))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"1f2b5353-573f-4880-8e33-7d04dcf97744_sysmon_ot"'
  description: Sysmon Configuration Modification
- id: eval
  filter: (EventID=="19" || EventID=="20" || EventID=="21")
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"0f06a3a5-6a09-413f-8743-e6cf35561297_sysmon_ot"'
  description: WMI Event Subscription
- id: eval
  filter: ((EventID=="19" || EventID=="20" || EventID=="21") && (Destination.includes("V3JpdGVQcm9jZXNzTWVtb3J5")
    || Destination.includes("dyaXRlUHJvY2Vzc01lbW9ye") || Destination.includes("Xcml0ZVByb2Nlc3NNZW1vcn")
    || Destination.includes("VGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZG")
    || Destination.includes("RoaXMgcHJvZ3JhbSBjYW5ub3QgYmUgcnVuIGluIERPUyBtb2Rl")
    || Destination.includes("UaGlzIHByb2dyYW0gY2Fubm90IGJlIHJ1biBpbiBET1MgbW9kZ")
    || Destination.includes("VGhpcyBwcm9ncmFtIG11c3QgYmUgcnVuIHVuZGVyIFdpbjMy") ||
    Destination.includes("RoaXMgcHJvZ3JhbSBtdXN0IGJlIHJ1biB1bmRlciBXaW4zM") || Destination.includes("UaGlzIHByb2dyYW0gbXVzdCBiZSBydW4gdW5kZXIgV2luMz")))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"83844185-1c5b-45bc-bcf3-b5bf3084ca5b_sysmon_ot"'
  description: Suspicious Encoded Scripts in a WMI Consumer
- id: eval
  filter: ((EventID=="19" || EventID=="20" || EventID=="21") && ((Destination.includes("new-object")
    && Destination.includes("net.webclient") && Destination.includes(".downloadstring"))
    || (Destination.includes("new-object") && Destination.includes("net.webclient")
    && Destination.includes(".downloadfile")) || (Destination.includes(" iex(") ||
    Destination.includes("WScript.shell") || Destination.includes(" -nop ") || Destination.includes("
    -noprofile ") || Destination.includes(" -decode ") || Destination.includes(" -enc
    ")) || (Destination.includes("WScript.Shell") || Destination.includes("System.Security.Cryptography.FromBase64Transform"))))
  disabled: false
  conf:
    add:
    - name: sigma_matches
      value: '"fe21810c-2a8c-478f-8dd3-5a287fb2a0e0_sysmon_ot"'
  description: Suspicious Scripting in a WMI Consumer
